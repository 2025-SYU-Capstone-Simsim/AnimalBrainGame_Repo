window.__require=function e(t,o,r){function n(c,s){if(!o[c]){if(!t[c]){var a=c.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var u=o[c]={exports:{}};t[c][0].call(u.exports,function(e){return n(t[c][1][e]||e)},u,u.exports,e,t,o,r)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)n(r[c]);return n}({"3MExplain":[function(e,t,o){"use strict";cc._RF.push(t,"47031C8yUdJybh/T2EMl8MH","3MExplain");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameStartButton=null,t.BackToSingleGameListButton=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.gameStartButton.node.on("click",this.onClickStartGame,this),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_ENTER,function(){cc.game.canvas.style.cursor="pointer",e.gameStartButton.node.runAction(cc.scaleTo(.1,1.1))}),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){cc.game.canvas.style.cursor="default",e.gameStartButton.node.runAction(cc.scaleTo(.1,1))})},t.prototype.onClickStartGame=function(){cc.log("\uac8c\uc784 \uc2dc\uc791 \ubc84\ud2bc \ud074\ub9ad\ub428"),cc.director.loadScene("3M_GameScene")},t.prototype.onClickBackSingleGameList=function(){cc.log("\uc2f1\uae00\uac8c\uc784\ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([a(cc.Button)],t.prototype,"gameStartButton",void 0),i([a(cc.Button)],t.prototype,"BackToSingleGameListButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],"3MatchBoard":[function(e,t,o){"use strict";cc._RF.push(t,"04540WzUCdIWobTbZf++EPF","3MatchBoard");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=e("./3MatchManager"),u=e("./Tile"),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tilePrefab=null,t.gameManager=null,t.boardSize=7,t.tileSize=100,t.gap=10,t.board=[],t.isSwapping=!1,t}return n(t,e),t.prototype.start=function(){var e=this;this.node.color=cc.Color.GRAY,this.createBoard(),this.scheduleOnce(function(){e.checkAndExplodeMatches()},.1)},t.prototype.createBoard=function(){this.board=[];for(var e=this.tileSize+this.gap,t=-(this.boardSize-1)*e/2,o=(this.boardSize-1)*e/2,r=0;r<this.boardSize;r++){this.board[r]=[];for(var n=0;n<this.boardSize;n++){var i=cc.instantiate(this.tilePrefab);i.parent=this.node;var c=t+n*e,s=o-r*e;i.setPosition(c,s);var a=i.getComponent(u.default);a.row=r,a.col=n;var l=[];if(n>=2){var p=this.board[r][n-1],h=this.board[r][n-2];p&&h&&p.fruitIndex===h.fruitIndex&&l.push(p.fruitIndex)}if(r>=2){var d=this.board[r-1][n],f=this.board[r-2][n];d&&f&&d.fruitIndex===f.fruitIndex&&l.push(d.fruitIndex)}a.setRandomFruitExcluding(l),a.addOutline(),this.board[r][n]=a}}},t.prototype.colorsAreEqual=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},t.prototype.checkAndExplodeMatches=function(){for(var e=this,t=[],o=0;o<this.boardSize;o++)for(var r=0;r<this.boardSize;r++)if(a=this.board[o][r]){if(r<=this.boardSize-3){var n=this.board[o][r+1],i=this.board[o][r+2];n&&i&&a.fruitIndex===n.fruitIndex&&a.fruitIndex===i.fruitIndex&&t.push(a,n,i)}o<=this.boardSize-3&&(n=this.board[o+1][r],i=this.board[o+2][r],n&&i&&a.fruitIndex===n.fruitIndex&&a.fruitIndex===i.fruitIndex&&t.push(a,n,i))}if((t=Array.from(new Set(t))).length>0){this.gameManager&&this.gameManager.addMatchScore(t.length);for(var c=0,s=t;c<s.length;c++){var a;(a=s[c]).explode(),this.board[a.row][a.col]=null}this.scheduleOnce(function(){e.fillEmptySpaces(),e.scheduleOnce(function(){e.spawnNewTiles(),e.scheduleOnce(function(){e.checkAndExplodeMatches()},.3)},.3)},.3)}else this.isSwapping=!1},t.prototype.swapTiles=function(e,t){var o=this;if(!this.isSwapping){var r=Math.abs(e.row-t.row),n=Math.abs(e.col-t.col);if(1===r&&0===n||0===r&&1===n){this.isSwapping=!0;var i=e.row,c=e.col;this.board[e.row][e.col]=t,this.board[t.row][t.col]=e,e.row=t.row,e.col=t.col,t.row=i,t.col=c;var s=this.getTilePosition(e.row,e.col),a=this.getTilePosition(t.row,t.col);cc.tween(e.node).to(.2,{position:s}).start(),cc.tween(t.node).to(.2,{position:a}).call(function(){if(function(){for(var e=0;e<o.boardSize;e++)for(var t=0;t<o.boardSize;t++){var r=o.board[e][t];if(r){if(t<=o.boardSize-3){var n=o.board[e][t+1],i=o.board[e][t+2];if(n&&i&&r.fruitIndex===n.fruitIndex&&r.fruitIndex===i.fruitIndex)return!0}if(e<=o.boardSize-3&&(n=o.board[e+1][t],i=o.board[e+2][t],n&&i&&r.fruitIndex===n.fruitIndex&&r.fruitIndex===i.fruitIndex))return!0}}return!1}())o.checkAndExplodeMatches();else{o.board[e.row][e.col]=t,o.board[t.row][t.col]=e;var r=e.row,n=e.col;e.row=t.row,e.col=t.col,t.row=r,t.col=n;var i=o.getTilePosition(e.row,e.col),c=o.getTilePosition(t.row,t.col);cc.tween(e.node).to(.2,{position:i}).start(),cc.tween(t.node).to(.2,{position:c}).call(function(){o.isSwapping=!1}).start()}}).start()}else console.log("\uc778\uc811\ud55c \ud0c0\uc77c\uc774 \uc544\ub2d9\ub2c8\ub2e4! \uad50\ud658 \ubd88\uac00")}},t.prototype.fillEmptySpaces=function(){for(var e=0;e<this.boardSize;e++)for(var t=this.boardSize-1;t>=0;t--)if(!this.board[t][e])for(var o=t-1;o>=0;o--)if(this.board[o][e]){var r=this.board[o][e];this.board[t][e]=r,this.board[o][e]=null,r.row=t,r.col=e;var n=this.getTilePosition(t,e);cc.tween(r.node).to(.2,{position:n}).start();break}},t.prototype.spawnNewTiles=function(){for(var e=0;e<this.boardSize;e++)for(var t=0;t<this.boardSize;t++)if(!this.board[e][t]){var o=cc.instantiate(this.tilePrefab);o.parent=this.node;var r=this.getTilePosition(e,t);o.setPosition(r);var n=o.getComponent(u.default);n.row=e,n.col=t,n.setRandomFruit(),n.addOutline(),this.board[e][t]=n}},t.prototype.getTilePosition=function(e,t){var o=this.tileSize+this.gap,r=-(this.boardSize-1)*o/2+t*o,n=(this.boardSize-1)*o/2-e*o;return new cc.Vec3(r,n,0)},i([a(cc.Prefab)],t.prototype,"tilePrefab",void 0),i([a(l.default)],t.prototype,"gameManager",void 0),i([s],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./3MatchManager":"3MatchManager","./Tile":"Tile"}],"3MatchManager":[function(e,t,o){"use strict";cc._RF.push(t,"b50cdZeRIBML5xf5ovOKREW","3MatchManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=e("../../Controller/CommonUI/GameState"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timerDisplayPrefab=null,t.scoreDisplayPrefab=null,t.boardNode=null,t.comboGauge=null,t.feverSprite=null,t.exitButton=null,t.gameOverUIPrefab=null,t.gameStartOverlayPrefab=null,t.totalTime=60,t.currentTime=60,t.score=0,t.timerNode=null,t.scoreNode=null,t.timerLabel=null,t.scoreLabel=null,t.comboValue=0,t.comboMax=300,t.isFeverTime=!1,t}return n(t,e),t.prototype.start=function(){var e=this;if(l.default.lastGameScene=cc.director.getScene().name,this.feverSprite&&this.feverSprite.isValid&&(this.feverSprite.active=!1),this.gameStartOverlayPrefab){var t=cc.instantiate(this.gameStartOverlayPrefab);this.node.addChild(t),t.setPosition(0,0),this.scheduleOnce(function(){e.startGameLogic()},2)}else this.startGameLogic()},t.prototype.startGameLogic=function(){this.timerNode=cc.instantiate(this.timerDisplayPrefab),this.node.addChild(this.timerNode),this.timerLabel=this.timerNode.getChildByName("TimerLabel").getComponent(cc.Label),this.updateTimer(),this.scoreNode=cc.instantiate(this.scoreDisplayPrefab),this.node.addChild(this.scoreNode),this.scoreLabel=this.scoreNode.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScore(0),this.comboValue=0,this.comboMax=300,this.comboGauge.progress=0,this.isFeverTime=!1,this.feverSprite&&(this.feverSprite.active=!1),this.schedule(this.updateTimer,1)},t.prototype.updateTimer=function(){this.currentTime--,this.currentTime<=0&&(this.currentTime=0,this.unschedule(this.updateTimer),this.onGameOver()),this.timerLabel.string=""+this.currentTime},t.prototype.updateScore=function(e){this.score+=e,this.scoreLabel.string=""+this.score,this.increaseComboGauge(e)},t.prototype.increaseComboGauge=function(e){this.isFeverTime||(this.comboValue+=e,this.comboValue>=this.comboMax&&(this.comboValue=this.comboMax,this.startFeverTime()),this.comboGauge.progress=this.comboValue/this.comboMax)},t.prototype.startFeverTime=function(){var e=this;this.isFeverTime=!0,this.feverSprite.active=!0,this.scheduleOnce(function(){e.endFeverTime()},10)},t.prototype.endFeverTime=function(){this.isFeverTime=!1,this.comboValue=0,this.comboGauge.progress=0,this.feverSprite.active=!1},t.prototype.addMatchScore=function(e){var t=10*e,o=this.isFeverTime?2*t:t;this.updateScore(o)},t.prototype.onGameOver=function(){cc.log("\uac8c\uc784 \uc885\ub8cc!"),l.default.lastGameScene=cc.director.getScene().name,l.default.score=this.score,l.default.gameId="FruitPuzzle";var e=cc.instantiate(this.gameOverUIPrefab);this.node.addChild(e),e.setPosition(0,0)},t.prototype.loadList=function(){console.log("\uc2f1\uae00 \uac8c\uc784 \ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([a(cc.Prefab)],t.prototype,"timerDisplayPrefab",void 0),i([a(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([a(cc.Node)],t.prototype,"boardNode",void 0),i([a(cc.ProgressBar)],t.prototype,"comboGauge",void 0),i([a(cc.Node)],t.prototype,"feverSprite",void 0),i([a(cc.Button)],t.prototype,"exitButton",void 0),i([a(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([a(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState"}],BlockCountExplain:[function(e,t,o){"use strict";cc._RF.push(t,"724c9YMkp9Iyoq0AH2CBOGT","BlockCountExplain");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameStartButton=null,t.BackToSingleGameListButton=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;cc.debug.setDisplayStats(!1),this.gameStartButton.node.on("click",this.onClickStartGame,this),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_ENTER,function(){cc.game.canvas.style.cursor="pointer",e.gameStartButton.node.runAction(cc.scaleTo(.1,1.1))}),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){cc.game.canvas.style.cursor="default",e.gameStartButton.node.runAction(cc.scaleTo(.1,1))})},t.prototype.onClickStartGame=function(){cc.log("\uac8c\uc784 \uc2dc\uc791 \ubc84\ud2bc \ud074\ub9ad\ub428"),cc.director.loadScene("BlockCountGameScene")},t.prototype.onClickBackSingleGameList=function(){cc.log("\uc2f1\uae00\uac8c\uc784\ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([a(cc.Button)],t.prototype,"gameStartButton",void 0),i([a(cc.Button)],t.prototype,"BackToSingleGameListButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],BlockCountGameManager:[function(e,t,o){"use strict";cc._RF.push(t,"6261fun9LFBEqfVgT7AVufD","BlockCountGameManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../../Controller/CommonUI/GameState"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.optionButtons=[],t.resultLabel=null,t.blockParent=null,t.blockPrefab=null,t.nextButton=null,t.gameStartOverlayPrefab=null,t.gameOverUIPrefab=null,t.exitButton=null,t.scoreUIPrefab=null,t.timeUIPrefab=null,t.scoreLabel=null,t.timeLabel=null,t.correctCount=0,t.score=0,t.answered=!1,t.timeLeft=60,t.blockTextures=["Images/Sim/navyBlock","Images/Sim/darkBlueBlock","Images/Sim/blueBlock","Images/Sim/whiteblueBlock"],t}return n(t,e),t.prototype.onLoad=function(){var e=this;if(c.default.lastGameScene=cc.director.getScene().name,cc.debug.setDisplayStats(!1),this.scoreUIPrefab){var t=cc.instantiate(this.scoreUIPrefab);this.node.addChild(t);var o=t.getChildByName("ScoreLabel");o&&(this.scoreLabel=o.getComponent(cc.Label)),this.scoreLabel||console.warn("\u26a0\ufe0f ScoreLabel \uc5f0\uacb0 \uc2e4\ud328! \ud504\ub9ac\ud339 \uad6c\uc870 \ub610\ub294 \ub178\ub4dc \uc774\ub984\uc744 \ud655\uc778\ud558\uc138\uc694.")}if(this.timeUIPrefab){var r=cc.instantiate(this.timeUIPrefab);this.node.addChild(r);var n=r.getComponentInChildren(cc.Label);n&&(this.timeLabel=n),this.timeLabel||console.warn("\u26a0\ufe0f TimeLabel \uc5f0\uacb0 \uc2e4\ud328! \ud504\ub9ac\ud339 \uad6c\uc870 \ub610\ub294 \ucef4\ud3ec\ub10c\ud2b8 \ud655\uc778\ud558\uc138\uc694.")}if(this.nextButton&&this.nextButton.node.on("click",this.nextQuestion,this),this.score=0,this.scoreLabel&&(this.scoreLabel.string=""+this.score),this.timeLeft=60,this.timeLabel&&(this.timeLabel.string=""+this.timeLeft),this.gameStartOverlayPrefab){var i=cc.instantiate(this.gameStartOverlayPrefab);this.node.addChild(i),i.setPosition(0,0),this.scheduleOnce(function(){return e.startGame()},2)}else this.startGame()},t.prototype.startGame=function(){this.startTimer(),this.generateQuestion()},t.prototype.startTimer=function(){this.unschedule(this.updateTimer),this.timeLeft=60,this.timeLabel&&(this.timeLabel.string=""+this.timeLeft),this.schedule(this.updateTimer,1)},t.prototype.updateTimer=function(){this.timeLeft--,this.timeLabel&&(this.timeLabel.string=""+this.timeLeft),this.timeLeft<=0&&(this.unschedule(this.updateTimer),this.onTimeout())},t.prototype.onTimeout=function(){this.optionButtons.forEach(function(e){return e.interactable=!1}),this.nextButton&&(this.nextButton.interactable=!1),c.default.lastGameScene=cc.director.getScene().name,c.default.score=this.score,c.default.gameId="block-count-game";var e=cc.instantiate(this.gameOverUIPrefab);this.node.addChild(e),e.setPosition(0,0)},t.prototype.generateQuestion=function(){var e=this;this.answered=!1,this.nextButton&&(this.nextButton.node.getComponentInChildren(cc.Label).string="\uac74\ub108\ub6f0\uae30",this.nextButton.interactable=!0),this.resultLabel.string="",this.correctCount=Math.floor(20*Math.random())+1,this.spawnBlocks(this.correctCount);for(var t=new Set([this.correctCount]);t.size<this.optionButtons.length;)t.add(Math.floor(30*Math.random())+1);var o=Array.from(t);this.shuffleArray(o),this.optionButtons.forEach(function(t,r){t.interactable=!0,t.node.getComponentInChildren(cc.Label).string=o[r].toString(),t.node.off("click"),t.node.on("click",function(){return e.checkAnswer(o[r])})})},t.prototype.checkAnswer=function(e){this.answered||(e===this.correctCount?(this.answered=!0,this.resultLabel.string="\ud83c\udf89 \uc815\ub2f5\uc785\ub2c8\ub2e4!",this.score+=20,this.scoreLabel&&(this.scoreLabel.string=""+this.score),this.nextButton&&(this.nextButton.node.getComponentInChildren(cc.Label).string="\ub2e4\uc74c\uc73c\ub85c")):(this.resultLabel.string="\u274c \ud2c0\ub838\uc2b5\ub2c8\ub2e4!",this.score-=10,this.scoreLabel&&(this.scoreLabel.string=""+this.score),this.nextButton&&(this.nextButton.node.getComponentInChildren(cc.Label).string="\uac74\ub108\ub6f0\uae30")))},t.prototype.nextQuestion=function(){this.timeLeft>0&&this.generateQuestion()},t.prototype.spawnBlocks=function(e){var t=this;if(this.blockParent){this.blockParent.removeAllChildren();for(var o=[],r=0;r<4;r++)for(var n=0;n<4;n++)o.push({x:r,z:n});this.shuffleArray(o);var i=[],c=0;e:for(var s=0,a=o;s<a.length;s++){for(var l=a[s],u=(r=l.x,n=l.z,0);u<4&&c<e;u++)i.push({x:r,z:n,y:u}),c++;if(c>=e)break e}var p=[],h=0;i.forEach(function(e){h=Math.max(h,e.y),p[e.y]||(p[e.y]=[]),p[e.y].push(e)});var d=function(e){(p[e]||[]).forEach(function(o,r){var n,i=cc.instantiate(t.blockPrefab);i.parent=t.blockParent,i.zIndex=o.x+o.z+10*o.y;var c=50*(o.x-o.z),s=25*-(o.x+o.z)-275+50*o.y;i.setPosition(c,s+500,0);var a=i.getComponent(cc.Sprite),l=null!==(n=t.blockTextures[o.y])&&void 0!==n?n:t.blockTextures[0];cc.resources.load(l,cc.SpriteFrame,function(e,t){!e&&t?a.spriteFrame=t:console.warn("\ube14\ub85d \ud14d\uc2a4\ucc98 \ub85c\ub4dc \uc2e4\ud328: "+l,e)});var u=e*(.15+.08)+.05*r;cc.tween(i).delay(u).to(.15,{position:cc.v3(c,s,0)},{easing:"bounceOut"}).start()})};for(u=0;u<=h;u++)d(u)}else console.error("[GameManager] blockParent\uac00 \uc5f0\uacb0\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4!")},t.prototype.shuffleArray=function(e){for(var t,o=e.length-1;o>0;o--){var r=Math.floor(Math.random()*(o+1));t=[e[r],e[o]],e[o]=t[0],e[r]=t[1]}},t.prototype.loadList=function(){console.log("\uc2f1\uae00 \uac8c\uc784 \ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([l([cc.Button])],t.prototype,"optionButtons",void 0),i([l(cc.Label)],t.prototype,"resultLabel",void 0),i([l(cc.Node)],t.prototype,"blockParent",void 0),i([l(cc.Prefab)],t.prototype,"blockPrefab",void 0),i([l(cc.Button)],t.prototype,"nextButton",void 0),i([l(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([l(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([l(cc.Button)],t.prototype,"exitButton",void 0),i([l(cc.Prefab)],t.prototype,"scoreUIPrefab",void 0),i([l(cc.Prefab)],t.prototype,"timeUIPrefab",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState"}],1:[function(e,t){var o,r,n=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function s(e){if(o===setTimeout)return setTimeout(e,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}function a(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(e){r=c}})();var l,u=[],p=!1,h=-1;function d(){p&&l&&(p=!1,l.length?u=l.concat(u):h=-1,u.length&&f())}function f(){if(!p){var e=s(d);p=!0;for(var t=u.length;t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,p=!1,a(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];u.push(new m(e,t)),1!==u.length||p||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=y,n.addListener=y,n.once=y,n.off=y,n.removeListener=y,n.removeAllListeners=y,n.emit=y,n.prependListener=y,n.prependOnceListener=y,n.listeners=function(){return[]},n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(e,t,o){function r(e){if(e)return n(e)}function n(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}o.Emitter=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function o(){this.off(e,o),t.apply(this,arguments)}return o.fn=t,this.on(e,o),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var o,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n=0;n<r.length;n++)if((o=r[n])===t||o.fn===t){r.splice(n,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),o=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(o){r=0;for(var n=(o=o.slice(0)).length;r<n;++r)o[r].apply(this,t)}return this},r.prototype.emitReserved=r.prototype.emit,r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],3:[function(e,t,o){(function(r){o.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;e.splice(1,0,o,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),e.splice(n,0,o)},o.save=function(e){try{e?o.storage.setItem("debug",e):o.storage.removeItem("debug")}catch(t){}},o.load=function(){let e;try{e=o.storage.getItem("debug")}catch(t){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},o.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},o.storage=function(){try{return localStorage}catch(e){}}(),o.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.log=console.debug||console.log||(()=>{}),t.exports=e("./common")(o);const{formatters:n}=t.exports;n.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,e("_process"))},{"./common":4,_process:1}],4:[function(e,t){t.exports=function(t){function o(e){let t,n,i,c=null;function s(...e){if(!s.enabled)return;const r=s,n=Number(new Date),i=n-(t||n);r.diff=i,r.prev=t,r.curr=n,t=n,e[0]=o.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let c=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,n)=>{if("%%"===t)return"%";c++;const i=o.formatters[n];if("function"==typeof i){const o=e[c];t=i.call(r,o),e.splice(c,1),c--}return t}),o.formatArgs.call(r,e),(r.log||o.log).apply(r,e)}return s.namespace=e,s.useColors=o.useColors(),s.color=o.selectColor(e),s.extend=r,s.destroy=o.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==c?c:(n!==o.namespaces&&(n=o.namespaces,i=o.enabled(e)),i),set:e=>{c=e}}),"function"==typeof o.init&&o.init(s),s}function r(e,t){const r=o(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return o.debug=o,o.default=o,o.coerce=function(e){return e instanceof Error?e.stack||e.message:e},o.disable=function(){const e=[...o.names.map(n),...o.skips.map(n).map(e=>"-"+e)].join(",");return o.enable(""),e},o.enable=function(e){let t;o.save(e),o.namespaces=e,o.names=[],o.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.slice(1)+"$")):o.names.push(new RegExp("^"+e+"$")))},o.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=o.skips.length;t<r;t++)if(o.skips[t].test(e))return!1;for(t=0,r=o.names.length;t<r;t++)if(o.names[t].test(e))return!0;return!1},o.humanize=e("ms"),o.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{o[e]=t[e]}),o.names=[],o.skips=[],o.formatters={},o.selectColor=function(e){let t=0;for(let o=0;o<e.length;o++)t=(t<<5)-t+e.charCodeAt(o),t|=0;return o.colors[Math.abs(t)%o.colors.length]},o.enable(o.load()),o}},{ms:24}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.hasCORS=void 0;let r=!1;try{r="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){}o.hasCORS=r},{}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.encode=function(e){let t="";for(let o in e)e.hasOwnProperty(o)&&(t.length&&(t+="&"),t+=encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t},o.decode=function(e){let t={},o=e.split("&");for(let r=0,n=o.length;r<n;r++){let e=o[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}},{}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.parse=function(e){if(e.length>8e3)throw"URI too long";const t=e,o=e.indexOf("["),s=e.indexOf("]");-1!=o&&-1!=s&&(e=e.substring(0,o)+e.substring(o,s).replace(/:/g,";")+e.substring(s,e.length));let a=r.exec(e||""),l={},u=14;for(;u--;)l[n[u]]=a[u]||"";return-1!=o&&-1!=s&&(l.source=t,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=i(0,l.path),l.queryKey=c(0,l.query),l};const r=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function i(e,t){const o=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||o.splice(0,1),"/"==t.slice(-1)&&o.splice(o.length-1,1),o}function c(e,t){const o={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(o[t]=r)}),o}},{}],8:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.defaultBinaryType=o.globalThisShim=o.nextTick=void 0,o.createCookieJar=function(){},o.nextTick="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),o.globalThisShim=(()=>"undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("","return this")())(),o.defaultBinaryType="arraybuffer"},{}],9:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WebTransport=o.WebSocket=o.NodeWebSocket=o.XHR=o.NodeXHR=o.Fetch=o.nextTick=o.parse=o.installTimerFunctions=o.transports=o.TransportError=o.Transport=o.protocol=o.SocketWithUpgrade=o.SocketWithoutUpgrade=o.Socket=void 0;const r=e("./socket.js");Object.defineProperty(o,"Socket",{enumerable:!0,get:function(){return r.Socket}});var n=e("./socket.js");Object.defineProperty(o,"SocketWithoutUpgrade",{enumerable:!0,get:function(){return n.SocketWithoutUpgrade}}),Object.defineProperty(o,"SocketWithUpgrade",{enumerable:!0,get:function(){return n.SocketWithUpgrade}}),o.protocol=r.Socket.protocol;var i=e("./transport.js");Object.defineProperty(o,"Transport",{enumerable:!0,get:function(){return i.Transport}}),Object.defineProperty(o,"TransportError",{enumerable:!0,get:function(){return i.TransportError}});var c=e("./transports/index.js");Object.defineProperty(o,"transports",{enumerable:!0,get:function(){return c.transports}});var s=e("./util.js");Object.defineProperty(o,"installTimerFunctions",{enumerable:!0,get:function(){return s.installTimerFunctions}});var a=e("./contrib/parseuri.js");Object.defineProperty(o,"parse",{enumerable:!0,get:function(){return a.parse}});var l=e("./globals.node.js");Object.defineProperty(o,"nextTick",{enumerable:!0,get:function(){return l.nextTick}});var u=e("./transports/polling-fetch.js");Object.defineProperty(o,"Fetch",{enumerable:!0,get:function(){return u.Fetch}});var p=e("./transports/polling-xhr.node.js");Object.defineProperty(o,"NodeXHR",{enumerable:!0,get:function(){return p.XHR}});var h=e("./transports/polling-xhr.js");Object.defineProperty(o,"XHR",{enumerable:!0,get:function(){return h.XHR}});var d=e("./transports/websocket.node.js");Object.defineProperty(o,"NodeWebSocket",{enumerable:!0,get:function(){return d.WS}});var f=e("./transports/websocket.js");Object.defineProperty(o,"WebSocket",{enumerable:!0,get:function(){return f.WS}});var m=e("./transports/webtransport.js");Object.defineProperty(o,"WebTransport",{enumerable:!0,get:function(){return m.WT}})},{"./contrib/parseuri.js":7,"./globals.node.js":8,"./socket.js":10,"./transport.js":11,"./transports/index.js":12,"./transports/polling-fetch.js":13,"./transports/polling-xhr.js":14,"./transports/polling-xhr.node.js":14,"./transports/websocket.js":16,"./transports/websocket.node.js":16,"./transports/webtransport.js":17,"./util.js":18}],10:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.Socket=o.SocketWithUpgrade=o.SocketWithoutUpgrade=void 0;const n=e("./transports/index.js"),i=e("./util.js"),c=e("./contrib/parseqs.js"),s=e("./contrib/parseuri.js"),a=e("@socket.io/component-emitter"),l=e("engine.io-parser"),u=e("./globals.node.js"),p=(0,r(e("debug")).default)("engine.io-client:socket"),h="function"==typeof addEventListener&&"function"==typeof removeEventListener,d=[];h&&addEventListener("offline",()=>{p("closing %d connection(s) because the network was lost",d.length),d.forEach(e=>e())},!1);class f extends a.Emitter{constructor(e,t){if(super(),this.binaryType=u.defaultBinaryType,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const o=(0,s.parse)(e);t.hostname=o.host,t.secure="https"===o.protocol||"wss"===o.protocol,t.port=o.port,o.query&&(t.query=o.query)}else t.host&&(t.hostname=(0,s.parse)(t.host).host);(0,i.installTimerFunctions)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=(0,c.decode)(this.opts.query)),h&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(p("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},d.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=(0,u.createCookieJar)()),this._open()}createTransport(e){p('creating transport "%s"',e);const t=Object.assign({},this.opts.query);t.EIO=l.protocol,t.transport=e,this.id&&(t.sid=this.id);const o=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return p("options: %j",o),new this._transportsByName[e](o)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&f.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){p("setting transport %s",e.name),this.transport&&(p("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){p("socket open"),this.readyState="open",f.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(p('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else p('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();p("flushing %d packets in socket",e.length),this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const o=this.writeBuffer[t].data;if(o&&(e+=(0,i.byteLength)(o)),t>0&&e>this._maxPayload)return p("only send %d out of %d packets",t,this.writeBuffer.length),this.writeBuffer.slice(0,t);e+=2}return p("payload size is %d (max: %d)",e,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(p("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,(0,u.nextTick)(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,o){return this._sendPacket("message",e,t,o),this}send(e,t,o){return this._sendPacket("message",e,t,o),this}_sendPacket(e,t,o,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof o&&(r=o,o=null),"closing"===this.readyState||"closed"===this.readyState)return;(o=o||{}).compress=!1!==o.compress;const n={type:e,data:t,options:o};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),p("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},o=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?o():e()}):this.upgrading?o():e()),this}_onError(e){if(p("socket error %j",e),f.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return p("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(p('socket close with reason: "%s"',e),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),h&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=d.indexOf(this._offlineEventListener);-1!==e&&(p("removing listener for the 'offline' event"),d.splice(e,1))}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}o.SocketWithoutUpgrade=f,f.protocol=l.protocol;class m extends f{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade){p("starting upgrade probes");for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}}_probe(e){p('probing transport "%s"',e);let t=this.createTransport(e),o=!1;f.priorWebsocketSuccess=!1;const r=()=>{o||(p('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",r=>{if(!o)if("pong"===r.type&&"probe"===r.data){if(p('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;f.priorWebsocketSuccess="websocket"===t.name,p('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{o||"closed"!==this.readyState&&(p("changing transport and sending upgrade packet"),l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{p('probe transport "%s" failed',e);const o=new Error("probe error");o.transport=t.name,this.emitReserved("upgradeError",o)}}))};function n(){o||(o=!0,l(),t.close(),t=null)}const i=o=>{const r=new Error("probe error: "+o);r.transport=t.name,n(),p('probe transport "%s" failed because of error: %s',e,o),this.emitReserved("upgradeError",r)};function c(){i("transport closed")}function s(){i("socket closed")}function a(e){t&&e.name!==t.name&&(p('"%s" works - aborting "%s"',e.name,t.name),n())}const l=()=>{t.removeListener("open",r),t.removeListener("error",i),t.removeListener("close",c),this.off("close",s),this.off("upgrading",a)};t.once("open",r),t.once("error",i),t.once("close",c),this.once("close",s),this.once("upgrading",a),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{o||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let o=0;o<e.length;o++)~this.transports.indexOf(e[o])&&t.push(e[o]);return t}}o.SocketWithUpgrade=m,o.Socket=class extends m{constructor(e,t={}){const o="object"==typeof e?e:t;(!o.transports||o.transports&&"string"==typeof o.transports[0])&&(o.transports=(o.transports||["polling","websocket","webtransport"]).map(e=>n.transports[e]).filter(e=>!!e)),super(e,o)}}},{"./contrib/parseqs.js":6,"./contrib/parseuri.js":7,"./globals.node.js":8,"./transports/index.js":12,"./util.js":18,"@socket.io/component-emitter":2,debug:3,"engine.io-parser":23}],11:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.Transport=o.TransportError=void 0;const n=e("engine.io-parser"),i=e("@socket.io/component-emitter"),c=e("./util.js"),s=e("./contrib/parseqs.js"),a=(0,r(e("debug")).default)("engine.io-client:transport");class l extends Error{constructor(e,t,o){super(e),this.description=t,this.context=o,this.type="TransportError"}}o.TransportError=l,o.Transport=class extends i.Emitter{constructor(e){super(),this.writable=!1,(0,c.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,o){return super.emitReserved("error",new l(e,t,o)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):a("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=(0,n.decodePacket)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=(0,s.encode)(e);return t.length?"?"+t:""}}},{"./contrib/parseqs.js":6,"./util.js":18,"@socket.io/component-emitter":2,debug:3,"engine.io-parser":23}],12:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.transports=void 0;const r=e("./polling-xhr.node.js"),n=e("./websocket.node.js"),i=e("./webtransport.js");o.transports={websocket:n.WS,webtransport:i.WT,polling:r.XHR}},{"./polling-xhr.node.js":14,"./websocket.node.js":16,"./webtransport.js":17}],13:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Fetch=void 0;const r=e("./polling.js");o.Fetch=class extends r.Polling{doPoll(){this._fetch().then(e=>{if(!e.ok)return this.onError("fetch read error",e.status,e);e.text().then(e=>this.onData(e))}).catch(e=>{this.onError("fetch read error",e)})}doWrite(e,t){this._fetch(e).then(e=>{if(!e.ok)return this.onError("fetch write error",e.status,e);t()}).catch(e=>{this.onError("fetch write error",e)})}_fetch(e){var t;const o=void 0!==e,r=new Headers(this.opts.extraHeaders);return o&&r.set("content-type","text/plain;charset=UTF-8"),null===(t=this.socket._cookieJar)||void 0===t||t.appendCookies(r),fetch(this.uri(),{method:o?"POST":"GET",body:o?e:null,headers:r,credentials:this.opts.withCredentials?"include":"omit"}).then(e=>{var t;return null===(t=this.socket._cookieJar)||void 0===t||t.parseCookies(e.headers.getSetCookie()),e})}}},{"./polling.js":15}],14:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.XHR=o.Request=o.BaseXHR=void 0;const n=e("./polling.js"),i=e("@socket.io/component-emitter"),c=e("../util.js"),s=e("../globals.node.js"),a=e("../contrib/has-cors.js"),l=(0,r(e("debug")).default)("engine.io-client:polling");function u(){}class p extends n.Polling{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let o=location.port;o||(o=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||o!==e.port}}doWrite(e,t){const o=this.request({method:"POST",data:e});o.on("success",t),o.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){l("xhr poll");const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}o.BaseXHR=p;class h extends i.Emitter{constructor(e,t,o){super(),this.createRequest=e,(0,c.installTimerFunctions)(this,o),this._opts=o,this._method=o.method||"GET",this._uri=t,this._data=void 0!==o.data?o.data:null,this._create()}_create(){var e;const t=(0,c.pick)(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const o=this._xhr=this.createRequest(t);try{l("xhr open %s: %s",this._method,this._uri),o.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&o.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(r){}if("POST"===this._method)try{o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{o.setRequestHeader("Accept","*/*")}catch(r){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(o),"withCredentials"in o&&(o.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(o.timeout=this._opts.requestTimeout),o.onreadystatechange=()=>{var e;3===o.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(o.getResponseHeader("set-cookie"))),4===o.readyState&&(200===o.status||1223===o.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof o.status?o.status:0)},0))},l("xhr data %s",this._data),o.send(this._data)}catch(r){return void this.setTimeoutFn(()=>{this._onError(r)},0)}"undefined"!=typeof document&&(this._index=h.requestsCount++,h.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=u,e)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete h.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(o.Request=h,h.requestsCount=0,h.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",d);else if("function"==typeof addEventListener){const e="onpagehide"in s.globalThisShim?"pagehide":"unload";addEventListener(e,d,!1)}function d(){for(let e in h.requests)h.requests.hasOwnProperty(e)&&h.requests[e].abort()}const f=function(){const e=m({xdomain:!1});return e&&null!==e.responseType}();function m(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||a.hasCORS))return new XMLHttpRequest}catch(o){}if(!t)try{return new(s.globalThisShim[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(o){}}o.XHR=class extends p{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=f&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new h(m,this.uri(),e)}}},{"../contrib/has-cors.js":5,"../globals.node.js":8,"../util.js":18,"./polling.js":15,"@socket.io/component-emitter":2,debug:3}],15:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.Polling=void 0;const n=e("../transport.js"),i=e("../util.js"),c=e("engine.io-parser"),s=(0,r(e("debug")).default)("engine.io-client:polling");o.Polling=class extends n.Transport{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{s("paused"),this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(s("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){s("pre-pause polling complete"),--e||t()})),this.writable||(s("we are currently writing - waiting to pause"),e++,this.once("drain",function(){s("pre-pause writing complete"),--e||t()}))}else t()}_poll(){s("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){s("polling got data %s",e),(0,c.decodePayload)(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this._poll():s('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=()=>{s("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(s("transport open - closing"),e()):(s("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,c.encodePayload)(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,i.randomString)()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}},{"../transport.js":11,"../util.js":18,debug:3,"engine.io-parser":23}],16:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.WS=o.BaseWS=void 0;const n=e("../transport.js"),i=e("../util.js"),c=e("engine.io-parser"),s=e("../globals.node.js"),a=(0,r(e("debug")).default)("engine.io-client:websocket"),l="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class u extends n.Transport{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,o=l?{}:(0,i.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(o.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,o)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const o=e[t],r=t===e.length-1;(0,c.encodePacket)(o,this.supportsBinary,e=>{try{this.doWrite(o,e)}catch(t){a("websocket closed before onclose event")}r&&(0,s.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,i.randomString)()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}o.BaseWS=u;const p=s.globalThisShim.WebSocket||s.globalThisShim.MozWebSocket;o.WS=class extends u{createSocket(e,t,o){return l?new p(e,t,o):t?new p(e,t):new p(e)}doWrite(e,t){this.ws.send(t)}}},{"../globals.node.js":8,"../transport.js":11,"../util.js":18,debug:3,"engine.io-parser":23}],17:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.WT=void 0;const n=e("../transport.js"),i=e("../globals.node.js"),c=e("engine.io-parser"),s=(0,r(e("debug")).default)("engine.io-client:webtransport");o.WT=class extends n.Transport{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{s("transport closed gracefully"),this.onClose()}).catch(e=>{s("transport closed due to %s",e),this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=(0,c.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER,this.socket.binaryType),o=e.readable.pipeThrough(t).getReader(),r=(0,c.createPacketEncoderStream)();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const n=()=>{o.read().then(({done:e,value:t})=>{e?s("session is closed"):(s("received chunk: %o",t),this.onPacket(t),n())}).catch(e=>{s("an error occurred while reading: %s",e)})};n();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const o=e[t],r=t===e.length-1;this._writer.write(o).then(()=>{r&&(0,i.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}}},{"../globals.node.js":8,"../transport.js":11,debug:3,"engine.io-parser":23}],18:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.pick=function(e,...t){return t.reduce((t,o)=>(e.hasOwnProperty(o)&&(t[o]=e[o]),t),{})},o.installTimerFunctions=function(e,t){t.useNativeTimers?(e.setTimeoutFn=n.bind(r.globalThisShim),e.clearTimeoutFn=i.bind(r.globalThisShim)):(e.setTimeoutFn=r.globalThisShim.setTimeout.bind(r.globalThisShim),e.clearTimeoutFn=r.globalThisShim.clearTimeout.bind(r.globalThisShim))},o.byteLength=function(e){return"string"==typeof e?s(e):Math.ceil((e.byteLength||e.size)*c)},o.randomString=function(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)};const r=e("./globals.node.js"),n=r.globalThisShim.setTimeout,i=r.globalThisShim.clearTimeout,c=1.33;function s(e){let t=0,o=0;for(let r=0,n=e.length;r<n;r++)(t=e.charCodeAt(r))<128?o+=1:t<2048?o+=2:t<55296||t>=57344?o+=3:(r++,o+=4);return o}},{"./globals.node.js":8}],19:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ERROR_PACKET=o.PACKET_TYPES_REVERSE=o.PACKET_TYPES=void 0;const r=Object.create(null);o.PACKET_TYPES=r,r.open="0",r.close="1",r.ping="2",r.pong="3",r.message="4",r.upgrade="5",r.noop="6";const n=Object.create(null);o.PACKET_TYPES_REVERSE=n,Object.keys(r).forEach(e=>{n[r[e]]=e}),o.ERROR_PACKET={type:"error",data:"parser error"}},{}],20:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.decode=o.encode=void 0;const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let i=0;i<r.length;i++)n[r.charCodeAt(i)]=i;o.encode=e=>{let t,o=new Uint8Array(e),n=o.length,i="";for(t=0;t<n;t+=3)i+=r[o[t]>>2],i+=r[(3&o[t])<<4|o[t+1]>>4],i+=r[(15&o[t+1])<<2|o[t+2]>>6],i+=r[63&o[t+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i},o.decode=e=>{let t,o,r,i,c,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const u=new ArrayBuffer(s),p=new Uint8Array(u);for(t=0;t<a;t+=4)o=n[e.charCodeAt(t)],r=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],c=n[e.charCodeAt(t+3)],p[l++]=o<<2|r>>4,p[l++]=(15&r)<<4|i>>2,p[l++]=(3&i)<<6|63&c;return u}},{}],21:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.decodePacket=void 0;const r=e("./commons.js"),n=e("./contrib/base64-arraybuffer.js"),i="function"==typeof ArrayBuffer;o.decodePacket=(e,t)=>{if("string"!=typeof e)return{type:"message",data:s(e,t)};const o=e.charAt(0);return"b"===o?{type:"message",data:c(e.substring(1),t)}:r.PACKET_TYPES_REVERSE[o]?e.length>1?{type:r.PACKET_TYPES_REVERSE[o],data:e.substring(1)}:{type:r.PACKET_TYPES_REVERSE[o]}:r.ERROR_PACKET};const c=(e,t)=>{if(i){const o=(0,n.decode)(e);return s(o,t)}return{base64:!0,data:e}},s=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}}},{"./commons.js":19,"./contrib/base64-arraybuffer.js":20}],22:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.encodePacket=void 0,o.encodePacketToBinary=function(e,t){return n&&e.data instanceof Blob?e.data.arrayBuffer().then(l).then(t):i&&(e.data instanceof ArrayBuffer||c(e.data))?t(l(e.data)):void s(e,!1,e=>{u||(u=new TextEncoder),t(u.encode(e))})};const r=e("./commons.js"),n="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),i="function"==typeof ArrayBuffer,c=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,s=({type:e,data:t},o,s)=>n&&t instanceof Blob?o?s(t):a(t,s):i&&(t instanceof ArrayBuffer||c(t))?o?s(t):a(new Blob([t]),s):s(r.PACKET_TYPES[e]+(t||""));o.encodePacket=s;const a=(e,t)=>{const o=new FileReader;return o.onload=function(){const e=o.result.split(",")[1];t("b"+(e||""))},o.readAsDataURL(e)};function l(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let u},{"./commons.js":19}],23:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.decodePayload=o.decodePacket=o.encodePayload=o.encodePacket=o.protocol=void 0,o.createPacketEncoderStream=function(){return new TransformStream({transform(e,t){(0,r.encodePacketToBinary)(e,o=>{const r=o.length;let n;if(r<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,r);else if(r<65536){n=new Uint8Array(3);const e=new DataView(n.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{n=new Uint8Array(9);const e=new DataView(n.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!=typeof e.data&&(n[0]|=128),t.enqueue(n),t.enqueue(o)})}})},o.createPacketDecoderStream=function(e,t){s||(s=new TextDecoder);const o=[];let r=0,c=-1,u=!1;return new TransformStream({transform(p,h){for(o.push(p);;){if(0===r){if(a(o)<1)break;const e=l(o,1);u=128==(128&e[0]),c=127&e[0],r=c<126?3:126===c?1:2}else if(1===r){if(a(o)<2)break;const e=l(o,2);c=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(a(o)<8)break;const e=l(o,8),t=new DataView(e.buffer,e.byteOffset,e.length),n=t.getUint32(0);if(n>Math.pow(2,21)-1){h.enqueue(i.ERROR_PACKET);break}c=n*Math.pow(2,32)+t.getUint32(4),r=3}else{if(a(o)<c)break;const e=l(o,c);h.enqueue((0,n.decodePacket)(u?e:s.decode(e),t)),r=0}if(0===c||c>e){h.enqueue(i.ERROR_PACKET);break}}}})};const r=e("./encodePacket.js");Object.defineProperty(o,"encodePacket",{enumerable:!0,get:function(){return r.encodePacket}});const n=e("./decodePacket.js");Object.defineProperty(o,"decodePacket",{enumerable:!0,get:function(){return n.decodePacket}});const i=e("./commons.js"),c=String.fromCharCode(30);let s;function a(e){return e.reduce((e,t)=>e+t.length,0)}function l(e,t){if(e[0].length===t)return e.shift();const o=new Uint8Array(t);let r=0;for(let n=0;n<t;n++)o[n]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),o}o.encodePayload=(e,t)=>{const o=e.length,n=new Array(o);let i=0;e.forEach((e,s)=>{(0,r.encodePacket)(e,!1,e=>{n[s]=e,++i===o&&t(n.join(c))})})},o.decodePayload=(e,t)=>{const o=e.split(c),r=[];for(let i=0;i<o.length;i++){const e=(0,n.decodePacket)(o[i],t);if(r.push(e),"error"===e.type)break}return r},o.protocol=4},{"./commons.js":19,"./decodePacket.js":21,"./encodePacket.js":22}],24:[function(e,t){var o=1e3,r=60*o,n=60*r,i=24*n,c=7*i,s=365.25*i;function a(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"weeks":case"week":case"w":return a*c;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function l(e){var t=Math.abs(e);return t>=i?Math.round(e/i)+"d":t>=n?Math.round(e/n)+"h":t>=r?Math.round(e/r)+"m":t>=o?Math.round(e/o)+"s":e+"ms"}function u(e,t,o,r){var n=t>=1.5*o;return Math.round(e/o)+" "+r+(n?"s":"")}t.exports=function(e,t){t=t||{};var c,s,p=typeof e;if("string"===p&&e.length>0)return a(e);if("number"===p&&isFinite(e))return t.long?(c=e,(s=Math.abs(c))>=i?u(c,s,i,"day"):s>=n?u(c,s,n,"hour"):s>=r?u(c,s,r,"minute"):s>=o?u(c,s,o,"second"):c+" ms"):l(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],25:[function(e,t,o){"use strict";function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Object.defineProperty(o,"__esModule",{value:!0}),o.Backoff=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),o=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-o:e+o}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},{}],26:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.WebTransport=o.WebSocket=o.NodeWebSocket=o.XHR=o.NodeXHR=o.Fetch=o.Socket=o.Manager=o.protocol=void 0,o.io=l,o.connect=l,o.default=l;const n=e("./url.js"),i=e("./manager.js");Object.defineProperty(o,"Manager",{enumerable:!0,get:function(){return i.Manager}});const c=e("./socket.js");Object.defineProperty(o,"Socket",{enumerable:!0,get:function(){return c.Socket}});const s=(0,r(e("debug")).default)("socket.io-client"),a={};function l(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};const o=(0,n.url)(e,t.path||"/socket.io"),r=o.source,c=o.id,l=o.path,u=a[c]&&l in a[c].nsps;let p;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(s("ignoring socket cache for %s",r),p=new i.Manager(r,t)):(a[c]||(s("new io instance for %s",r),a[c]=new i.Manager(r,t)),p=a[c]),o.query&&!t.query&&(t.query=o.queryKey),p.socket(o.path,t)}Object.assign(l,{Manager:i.Manager,Socket:c.Socket,io:l,connect:l});var u=e("socket.io-parser");Object.defineProperty(o,"protocol",{enumerable:!0,get:function(){return u.protocol}});var p=e("engine.io-client");Object.defineProperty(o,"Fetch",{enumerable:!0,get:function(){return p.Fetch}}),Object.defineProperty(o,"NodeXHR",{enumerable:!0,get:function(){return p.NodeXHR}}),Object.defineProperty(o,"XHR",{enumerable:!0,get:function(){return p.XHR}}),Object.defineProperty(o,"NodeWebSocket",{enumerable:!0,get:function(){return p.NodeWebSocket}}),Object.defineProperty(o,"WebSocket",{enumerable:!0,get:function(){return p.WebSocket}}),Object.defineProperty(o,"WebTransport",{enumerable:!0,get:function(){return p.WebTransport}}),t.exports=l},{"./manager.js":27,"./socket.js":29,"./url.js":30,debug:3,"engine.io-client":9,"socket.io-parser":32}],27:[function(e,t,o){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,r,n)}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return n(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.Manager=void 0;const s=e("engine.io-client"),a=e("./socket.js"),l=i(e("socket.io-parser")),u=e("./on.js"),p=e("./contrib/backo2.js"),h=e("@socket.io/component-emitter"),d=(0,c(e("debug")).default)("socket.io-client:manager");o.Manager=class extends h.Emitter{constructor(e,t){var o;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,(0,s.installTimerFunctions)(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(o=t.randomizationFactor)&&void 0!==o?o:.5),this.backoff=new p.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||l;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(d("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;d("opening %s",this.uri),this.engine=new s.Socket(this.uri,this.opts);const t=this.engine,o=this;this._readyState="opening",this.skipReconnect=!1;const r=(0,u.on)(t,"open",function(){o.onopen(),e&&e()}),n=t=>{d("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},i=(0,u.on)(t,"error",n);if(!1!==this._timeout){const e=this._timeout;d("connect attempt will timeout after %d",e);const o=this.setTimeoutFn(()=>{d("connect attempt timed out after %d",e),r(),n(new Error("timeout")),t.close()},e);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}return this.subs.push(r),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){d("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push((0,u.on)(e,"ping",this.onping.bind(this)),(0,u.on)(e,"data",this.ondata.bind(this)),(0,u.on)(e,"error",this.onerror.bind(this)),(0,u.on)(e,"close",this.onclose.bind(this)),(0,u.on)(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){(0,s.nextTick)(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){d("error",e),this.emitReserved("error",e)}socket(e,t){let o=this.nsps[e];return o?this._autoConnect&&!o.active&&o.connect():(o=new a.Socket(this,e,t),this.nsps[e]=o),o}_destroy(e){const t=Object.keys(this.nsps);for(const o of t)if(this.nsps[o].active)return void d("socket %s is still active, skipping close",o);this._close()}_packet(e){d("writing packet %j",e);const t=this.encoder.encode(e);for(let o=0;o<t.length;o++)this.engine.write(t[o],e.options)}cleanup(){d("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){d("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var o;d("closed due to %s",e),this.cleanup(),null===(o=this.engine)||void 0===o||o.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();d("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const o=this.setTimeoutFn(()=>{e.skipReconnect||(d("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(d("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(d("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}},{"./contrib/backo2.js":25,"./on.js":28,"./socket.js":29,"@socket.io/component-emitter":2,debug:3,"engine.io-client":9,"socket.io-parser":32}],28:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.on=function(e,t,o){return e.on(t,o),function(){e.off(t,o)}}},{}],29:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.Socket=void 0;const n=e("socket.io-parser"),i=e("./on.js"),c=e("@socket.io/component-emitter"),s=(0,r(e("debug")).default)("socket.io-client:socket"),a=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});o.Socket=class extends c.Emitter{constructor(e,t,o){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,o&&o.auth&&(this.auth=o.auth),this._opts=Object.assign({},o),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[(0,i.on)(e,"open",this.onopen.bind(this)),(0,i.on)(e,"packet",this.onpacket.bind(this)),(0,i.on)(e,"error",this.onerror.bind(this)),(0,i.on)(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var o,r,i;if(a.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const c={type:n.PacketType.EVENT,data:t,options:{}};if(c.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++;s("emitting packet with ack id %d",e);const o=t.pop();this._registerAckCallback(e,o),c.id=e}const l=null===(r=null===(o=this.io.engine)||void 0===o?void 0:o.transport)||void 0===r?void 0:r.writable,u=this.connected&&!(null===(i=this.io.engine)||void 0===i?void 0:i._hasPingExpired());return this.flags.volatile&&!l?s("discard packet as the transport is not currently writable"):u?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c),this.flags={},this}_registerAckCallback(e,t){var o;const r=null!==(o=this.flags.timeout)&&void 0!==o?o:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&(s("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(t,1));s("event with ack id %d has timed out after %d ms",e,r),t.call(this,new Error("operation has timed out"))},r),i=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,e)};i.withError=!0,this.acks[e]=i}emitWithAck(e,...t){return new Promise((o,r)=>{const n=(e,t)=>e?r(e):o(t);n.withError=!0,t.push(n),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const o={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...r)=>{if(o===this._queue[0])return null!==e?o.tryCount>this._opts.retries&&(s("packet [%d] is discarded after %d tries",o.id,o.tryCount),this._queue.shift(),t&&t(e)):(s("packet [%d] was successfully sent",o.id),this._queue.shift(),t&&t(null,...r)),o.pending=!1,this._drainQueue()}),this._queue.push(o),this._drainQueue()}_drainQueue(e=!1){if(s("draining queue"),!this.connected||0===this._queue.length)return;const t=this._queue[0];!t.pending||e?(t.pending=!0,t.tryCount++,s("sending packet [%d] (try n\xb0%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)):s("packet [%d] has already been sent and is waiting for an ack",t.id)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){s("transport is open - connecting"),"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:n.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){s("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case n.PacketType.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case n.PacketType.EVENT:case n.PacketType.BINARY_EVENT:this.onevent(e);break;case n.PacketType.ACK:case n.PacketType.BINARY_ACK:this.onack(e);break;case n.PacketType.DISCONNECT:this.ondisconnect();break;case n.PacketType.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];s("emitting event %j",t),null!=e.id&&(s("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const o of t)o.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let o=!1;return function(...r){o||(o=!0,s("sending ack %j",r),t.packet({type:n.PacketType.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(delete this.acks[e.id],s("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data)):s("bad ack %s",e.id)}onconnect(e,t){s("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){s("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(s("performing disconnect (%s)",this.nsp),this.packet({type:n.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let o=0;o<t.length;o++)if(e===t[o])return t.splice(o,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let o=0;o<t.length;o++)if(e===t[o])return t.splice(o,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const o of t)o.apply(this,e.data)}}}},{"./on.js":28,"@socket.io/component-emitter":2,debug:3,"socket.io-parser":32}],30:[function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.url=function(e,t="",o){let r=e;o=o||"undefined"!=typeof location&&location,null==e&&(e=o.protocol+"//"+o.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?o.protocol+e:o.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==o?o.protocol+"//"+e:"https://"+e),i("parse %s",e),r=(0,n.parse)(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const c=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+c+":"+r.port+t,r.href=r.protocol+"://"+c+(o&&o.port===r.port?"":":"+r.port),r};const n=e("engine.io-client"),i=(0,r(e("debug")).default)("socket.io-client:url")},{debug:3,"engine.io-client":9}],31:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.reconstructPacket=o.deconstructPacket=void 0;const r=e("./is-binary.js");function n(e,t){if(!e)return e;if((0,r.isBinary)(e)){const o={_placeholder:!0,num:t.length};return t.push(e),o}if(Array.isArray(e)){const o=new Array(e.length);for(let r=0;r<e.length;r++)o[r]=n(e[r],t);return o}if("object"==typeof e&&!(e instanceof Date)){const o={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=n(e[r],t));return o}return e}function i(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let o=0;o<e.length;o++)e[o]=i(e[o],t);else if("object"==typeof e)for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(e[o]=i(e[o],t));return e}o.deconstructPacket=function(e){const t=[],o=e.data,r=e;return r.data=n(o,t),r.attachments=t.length,{packet:r,buffers:t}},o.reconstructPacket=function(e,t){return e.data=i(e.data,t),delete e.attachments,e}},{"./is-binary.js":33}],32:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Decoder=o.Encoder=o.PacketType=o.protocol=void 0;const r=e("@socket.io/component-emitter"),n=e("./binary.js"),i=e("./is-binary.js"),c=(0,e("debug").default)("socket.io-parser"),s=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var a;function l(e){return"[object Object]"===Object.prototype.toString.call(e)}o.protocol=5,function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(a=o.PacketType||(o.PacketType={})),o.Encoder=class{constructor(e){this.replacer=e}encode(e){return c("encoding packet %j",e),e.type!==a.EVENT&&e.type!==a.ACK||!(0,i.hasBinary)(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==a.BINARY_EVENT&&e.type!==a.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),c("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=(0,n.deconstructPacket)(e),o=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(o),r}};class u extends r.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");const o=(t=this.decodeString(e)).type===a.BINARY_EVENT;o||t.type===a.BINARY_ACK?(t.type=o?a.EVENT:a.ACK,this.reconstructor=new p(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!(0,i.isBinary)(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const o={type:Number(e.charAt(0))};if(void 0===a[o.type])throw new Error("unknown packet type "+o.type);if(o.type===a.BINARY_EVENT||o.type===a.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const n=e.substring(r,t);if(n!=Number(n)||"-"!==e.charAt(t))throw new Error("Illegal attachments");o.attachments=Number(n)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);o.nsp=e.substring(r,t)}else o.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const o=e.charAt(t);if(null==o||Number(o)!=o){--t;break}if(t===e.length)break}o.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!u.isPayloadValid(o.type,r))throw new Error("invalid payload");o.data=r}return c("decoded %s as %j",e,o),o}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case a.CONNECT:return l(t);case a.DISCONNECT:return void 0===t;case a.CONNECT_ERROR:return"string"==typeof t||l(t);case a.EVENT:case a.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===s.indexOf(t[0]));case a.ACK:case a.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}o.Decoder=u;class p{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=(0,n.reconstructPacket)(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},{"./binary.js":31,"./is-binary.js":33,"@socket.io/component-emitter":2,debug:3}],33:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.hasBinary=o.isBinary=void 0;const r="function"==typeof ArrayBuffer,n=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,i=Object.prototype.toString,c="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);function a(e){return r&&(e instanceof ArrayBuffer||n(e))||c&&e instanceof Blob||s&&e instanceof File}o.isBinary=a,o.hasBinary=function e(t){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let o=0,r=t.length;o<r;o++)if(e(t[o]))return!0;return!1}if(a(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0;return!1}},{}],GameStartOverlay:[function(e,t,o){"use strict";cc._RF.push(t,"9b1daoSAMZL+45oEwkf5kb7","GameStartOverlay");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.letterContainer=null,t}return n(t,e),t.prototype.onLoad=function(){this.playDropAnimations()},t.prototype.playDropAnimations=function(){var e=this,t=this.letterContainer.getChildByName("GameRow"),o=this.letterContainer.getChildByName("StartRow");if(t&&o){this.animateLetterRow(t.children,0),this.animateLetterRow(o.children,.5);var r=.1*t.children.length+.1*o.children.length+1;this.scheduleOnce(function(){cc.tween(e.node).to(.5,{opacity:0}).call(function(){return e.node.destroy()}).start()},r)}else console.warn("GameRow \ub610\ub294 StartRow \ub178\ub4dc\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},t.prototype.animateLetterRow=function(e,t){e.forEach(function(e,o){e.opacity=0,e.setPosition(e.x,100),cc.tween(e).delay(t+.1*o).to(.25,{position:cc.v3(e.x,0),opacity:255},{easing:"backOut"}).start()})},i([a(cc.Node)],t.prototype,"letterContainer",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],GameState:[function(e,t,o){"use strict";cc._RF.push(t,"24196qclGpLUqqgSVLhURzx","GameState"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(){}return e.resetGame=function(){this.lastGameScene="",this.score=0},e.resetUser=function(){this.nickname="",this.character="",this.recentSingleScores=[],this.incomingRoomId="",this.createdRoomId="",this.isHost=!1,this.hostNickname="",this.hostCharacter="",this.guestNickname="",this.guestCharacter=""},e.resetMultiplay=function(){this.createdRoomId="",this.incomingRoomId="",this.isHost=!1,this.hostNickname="",this.hostCharacter="",this.guestNickname="",this.guestCharacter=""},e.lastGameScene="",e.nickname="",e.character="",e.score=0,e.gameId="",e.incomingRoomId="",e.createdRoomId="",e.isHost=!1,e.hostNickname="",e.hostCharacter="",e.guestNickname="",e.guestCharacter="",e.recentSingleScores=[],e.browserId="",e}();o.default=r,cc._RF.pop()},{}],Loading:[function(e,t,o){"use strict";cc._RF.push(t,"5abb9rmIaNJtbQJccVhhJoN","Loading");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadingLabel=null,t.dots="",t.timer=0,t.interval=.5,t}return n(t,e),t.prototype.update=function(e){this.timer+=e,this.timer>=this.interval&&(this.timer=0,this.updateDots())},t.prototype.updateDots=function(){this.dots.length>=3?this.dots="":this.dots+=".",this.loadingLabel.string="Loading"+this.dots},i([a(cc.Label)],t.prototype,"loadingLabel",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],LoginManager:[function(e,t,o){"use strict";cc._RF.push(t,"724b4McXHlDyZSM2r3LX3+s","LoginManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function s(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./GameState"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nicknameInput=null,t.startButton=null,t.dogPrefab=null,t.rabbitPrefab=null,t.tigerPrefab=null,t.dogCharacter=null,t.rabbitCharacter=null,t.tigerCharacter=null,t.dogSlot=null,t.rabbitSlot=null,t.tigerSlot=null,t.currentSelectedContainer=null,t.selectedCharacter="",t}return n(t,e),t.prototype.onLoad=function(){var e=cc.find("Canvas/TransitionOverlay");e&&(e.active=!1,e.opacity=0),this.startButton.interactable=!1,this.tryAutoLogin(),this.clearSlots(),this.instantiateCharacter("dog"),this.instantiateCharacter("rabbit"),this.instantiateCharacter("tiger"),this.registerButtonEvents(this.startButton.node,this.onClickStart.bind(this)),cc.sys.isMobile||(this.startButton.node.on(cc.Node.EventType.MOUSE_ENTER,function(){cc.game.canvas.style.cursor="pointer"}),this.startButton.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){cc.game.canvas.style.cursor="default"}))},t.prototype.registerButtonEvents=function(e,t){e.on(cc.Node.EventType.TOUCH_END,t),e.on(cc.Node.EventType.MOUSE_DOWN,t)},t.prototype.clearSlots=function(){this.dogSlot.removeAllChildren(),this.rabbitSlot.removeAllChildren(),this.tigerSlot.removeAllChildren()},t.prototype.instantiateCharacter=function(e){var t,o,r,n=this;switch(e){case"dog":t=this.dogPrefab,o=this.dogSlot,r=this.dogCharacter;break;case"rabbit":t=this.rabbitPrefab,o=this.rabbitSlot,r=this.rabbitCharacter;break;case"tiger":t=this.tigerPrefab,o=this.tigerSlot,r=this.tigerCharacter}if(t&&o&&r){var i=cc.instantiate(t);o.removeAllChildren(),o.addChild(i),r.on(cc.Node.EventType.MOUSE_DOWN,function(){n.selectCharacter(e,r)}),r.on(cc.Node.EventType.TOUCH_START,function(){n.selectCharacter(e,r)}),cc.sys.isMobile||(r.on(cc.Node.EventType.MOUSE_ENTER,function(){cc.game.canvas.style.cursor="pointer"}),r.on(cc.Node.EventType.MOUSE_LEAVE,function(){cc.game.canvas.style.cursor="default"}))}},t.prototype.selectCharacter=function(e,t){this.selectedCharacter=e,this.currentSelectedContainer&&this.currentSelectedContainer!==t&&this.setCharacterEffect(this.currentSelectedContainer,!1),this.setCharacterEffect(t,!0),this.currentSelectedContainer=t,this.checkFormValid()},t.prototype.setCharacterEffect=function(e,t){e.setScale(t?1.2:1),e.opacity=t?255:200},t.prototype.onSelectCharacter=function(e,t){"string"==typeof t?(this.selectedCharacter=t,cc.log("\uce90\ub9ad\ud130 \uc120\ud0dd\ub428:",t)):(cc.warn("\uc798\ubabb\ub41c \uce90\ub9ad\ud130 \uc120\ud0dd\uac12:",t),this.selectedCharacter=""),this.checkFormValid()},t.prototype.onNicknameChanged=function(){cc.log("\ub2c9\ub124\uc784 \uc785\ub825 \uc911:",this.nicknameInput.string),this.checkFormValid()},t.prototype.checkFormValid=function(){var e=""!==this.nicknameInput.string.trim()&&""!==this.selectedCharacter;this.startButton.interactable=e,cc.log("\ud3fc \uc720\ud6a8\uc131:",e)},t.prototype.onClickStart=function(){return c(this,void 0,void 0,function(){var e,t,o,r,n,i,c,l;return s(this,function(s){switch(s.label){case 0:if(e=this.nicknameInput.string.trim(),t=this.selectedCharacter,!e||!t)return[2];s.label=1;case 1:return s.trys.push([1,5,,6]),(o=localStorage.getItem("browserId"))||(o=this.generateBrowserId(),localStorage.setItem("browserId",o)),a.default.browserId=o,[4,fetch("https://smartzoo.shop/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({browserId:o})})];case 2:return(r=s.sent()).ok?[4,r.json()]:[2];case 3:return n=s.sent(),i=n.token,localStorage.setItem("jwtToken",i),[4,fetch("https://smartzoo.shop/auth/set-profile",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i},body:JSON.stringify({nickname:e,character:t})})];case 4:return s.sent().ok?(a.default.nickname=e,a.default.character=t,(c=localStorage.getItem("pendingRoomId"))?(a.default.incomingRoomId=c,a.default.isHost=!1,localStorage.removeItem("pendingRoomId"),this.fadeOutToScene("PlayerConnect")):this.fadeOutToScene("MainScene"),[3,6]):[2];case 5:return l=s.sent(),cc.error("\uc5d0\ub7ec \ubc1c\uc0dd:",l),[3,6];case 6:return[2]}})})},t.prototype.generateBrowserId=function(){var e=new Uint8Array(16);return window.crypto.getRandomValues(e),Array.from(e).map(function(e){return e.toString(16).padStart(2,"0")}).join("")},t.prototype.tryAutoLogin=function(){return c(this,void 0,void 0,function(){var e,t,o,r,n;return s(this,function(i){switch(i.label){case 0:return e=localStorage.getItem("jwtToken"),t=localStorage.getItem("browserId"),e&&t?(a.default.browserId=t,[4,fetch("https://smartzoo.shop/auth/verify-token",{method:"POST",headers:{Authorization:"Bearer "+e}})]):[2];case 1:return[4,(o=i.sent()).json()];case 2:return r=i.sent(),o.ok&&r.success?[4,fetch("https://smartzoo.shop/auth/user-info",{method:"GET",headers:{Authorization:"Bearer "+e}})]:[2];case 3:return[4,i.sent().json()];case 4:return(n=i.sent()).success&&(a.default.nickname=n.nickname,a.default.character=n.character,a.default.recentSingleScores=n.recentSingleScores,cc.log("\uc790\ub3d9 \ub85c\uadf8\uc778 GameState \ucc44\uc6c0:",a.default),this.fadeOutToScene("MainScene")),[2]}})})},t.prototype.fadeOutToScene=function(e){var t=cc.find("Canvas/TransitionOverlay");if(!t)return cc.warn("TransitionOverlay\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void cc.director.loadScene(e);t.active=!0,t.opacity=0,cc.tween(t).to(.5,{opacity:255}).call(function(){cc.director.loadScene(e)}).start()},i([p(cc.EditBox)],t.prototype,"nicknameInput",void 0),i([p(cc.Button)],t.prototype,"startButton",void 0),i([p(cc.Prefab)],t.prototype,"dogPrefab",void 0),i([p(cc.Prefab)],t.prototype,"rabbitPrefab",void 0),i([p(cc.Prefab)],t.prototype,"tigerPrefab",void 0),i([p(cc.Node)],t.prototype,"dogCharacter",void 0),i([p(cc.Node)],t.prototype,"rabbitCharacter",void 0),i([p(cc.Node)],t.prototype,"tigerCharacter",void 0),i([p(cc.Node)],t.prototype,"dogSlot",void 0),i([p(cc.Node)],t.prototype,"rabbitSlot",void 0),i([p(cc.Node)],t.prototype,"tigerSlot",void 0),i([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"./GameState":"GameState"}],MainMenuScene:[function(e,t,o){"use strict";cc._RF.push(t,"8ce8fHZrg9NhKJ4PqiMsmMT","MainMenuScene");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function s(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,l=a.ccclass,u=a.property,p=e("../CommonUI/GameState"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.singleButton=null,t.multiButton=null,t.myPageButton=null,t}return n(t,e),t.prototype.onLoad=function(){return c(this,void 0,void 0,function(){var e,t,o,r,n,i,c;return s(this,function(s){switch(s.label){case 0:if(e=new URLSearchParams(window.location.search),t=e.get("roomId"),o=localStorage.getItem("jwtToken"),r=localStorage.getItem("browserId"),t)return cc.log("\ucd08\ub300 \ub9c1\ud06c \uac10\uc9c0 roomId:",t),o&&r?(history.replaceState(null,"",window.location.pathname),p.default.incomingRoomId=t,p.default.isHost=!1,cc.director.loadScene("PlayerConnect"),[2]):(cc.warn("\ub85c\uadf8\uc778 \uc548\ub428 \u2192 \ub85c\uadf8\uc778 \ud6c4 \ubcf5\uadc0\ub97c \uc704\ud574 roomId \uc800\uc7a5"),localStorage.setItem("pendingRoomId",t),history.replaceState(null,"",window.location.pathname),cc.director.loadScene("LoginScene"),[2]);if(!o||!r)return cc.warn("\ud1a0\ud070 \ub610\ub294 \ube0c\ub77c\uc6b0\uc800 ID \uc5c6\uc74c \u2192 \ub85c\uadf8\uc778\uc73c\ub85c \uc774\ub3d9"),cc.director.loadScene("LoginScene"),[2];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch("https://smartzoo.shop/auth/verify-token",{method:"POST",headers:{Authorization:"Bearer "+o}})];case 2:return[4,(n=s.sent()).json()];case 3:return i=s.sent(),n.ok&&i.success?(cc.log("\ud1a0\ud070 \uac80\uc99d \uc644\ub8cc"),this.registerButtonEvents(this.singleButton.node,this.onClickSingle.bind(this)),this.registerButtonEvents(this.multiButton.node,this.onClickMulti.bind(this)),this.registerButtonEvents(this.myPageButton.node,this.onClickMyPage.bind(this)),[3,5]):(cc.warn("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud1a0\ud070. \ub85c\uadf8\uc778\uc73c\ub85c \ub9ac\ub2e4\uc774\ub809\ud2b8"),localStorage.removeItem("jwtToken"),cc.director.loadScene("LoginScene"),[2]);case 4:return c=s.sent(),cc.error("\uc11c\ubc84 \ud1b5\uc2e0 \uc624\ub958 \u2192 \ub85c\uadf8\uc778\uc73c\ub85c \uc774\ub3d9",c),cc.director.loadScene("LoginScene"),[3,5];case 5:return[2]}})})},t.prototype.registerButtonEvents=function(e,t){cc.log("\ubc84\ud2bc \uc774\ubca4\ud2b8 \ub4f1\ub85d:",e.name),e.on(cc.Node.EventType.TOUCH_END,t),e.on(cc.Node.EventType.MOUSE_DOWN,t)},t.prototype.onClickSingle=function(){cc.log("\uc2f1\uae00 \uac8c\uc784 \ubc84\ud2bc \ud074\ub9ad\ub428. SingleGameList \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("SingleGameList")},t.prototype.onClickMulti=function(){cc.log("onClickMulti \ud638\ucd9c\ub428"),p.default.isHost=!0,cc.log("isHost \uc124\uc815\ub428:",p.default.isHost),cc.director.loadScene("MultiWatingPage")},t.prototype.onClickMyPage=function(){cc.log("\ub9c8\uc774\ud398\uc774\uc9c0 \ubc84\ud2bc \ud074\ub9ad\ub428. MyInfo \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("MyInfo")},t.prototype.onClickLogin=function(){cc.log("\ub4a4\ub85c\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad\ub428. Login \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("LoginScene")},i([u(cc.Button)],t.prototype,"singleButton",void 0),i([u(cc.Button)],t.prototype,"multiButton",void 0),i([u(cc.Button)],t.prototype,"myPageButton",void 0),i([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],MazeGameData:[function(e,t,o){"use strict";cc._RF.push(t,"40194f0OxFJo7xjtjiZh/ac","MazeGameData"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Controller/CommonUI/GameState"),n=function(){function e(){}return Object.defineProperty(e,"playerType",{get:function(){return!r.default||"tiger"!==r.default.character&&"dog"!==r.default.character&&"rabbit"!==r.default.character?"tiger":r.default.character},set:function(e){r.default&&(r.default.character=e)},enumerable:!1,configurable:!0}),e.addScore=function(){this.score+=10},e.resetScore=function(){this.score=0},e.currentLevel=1,e.score=0,e}();o.default=n,cc._RF.pop()},{"../Controller/CommonUI/GameState":"GameState"}],MazeGameOverManager:[function(e,t,o){"use strict";cc._RF.push(t,"ba55241+4FM1oLcOvRC1meQ","MazeGameOverManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./MazeGameData"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){this.retryBtn.on("click",function(){return cc.director.loadScene("MazeSingleScene")}),this.mainBtn.on("click",function(){c.default.currentLevel=1,cc.director.loadScene("Maze_InformScene")})},i([l(cc.Node)],t.prototype,"retryBtn",void 0),i([l(cc.Node)],t.prototype,"mainBtn",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./MazeGameData":"MazeGameData"}],MazeGenerator:[function(e,t,o){"use strict";cc._RF.push(t,"4b4b9YKGjZKlYxCj4Psn5/9","MazeGenerator");var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.rows=21,this.cols=21}return e.prototype.generateMaze=function(e){var t;return t=e<=4?this._dfs():e<=10?this._huntAndKill():this._wilson(),t=this._addLoops(t,e),this._ensureMinPath(t,e)},e.prototype._dfs=function(){var e=this,t=Array(this.rows).fill(0).map(function(){return Array(e.cols).fill(1)}),o=[{x:1,y:1}];for(t[1][1]=0;o.length;){var r=o[o.length-1],n=this._cellNeighbors(r.x,r.y,t);if(n.length){var i=n[Math.floor(Math.random()*n.length)],c=r.x+i.x>>1;t[r.y+i.y>>1][c]=t[i.y][i.x]=0,o.push(i)}else o.pop()}return t},e.prototype._huntAndKill=function(){var e=this,t=Array(this.rows).fill(0).map(function(){return Array(e.cols).fill(1)}),o=Array(this.rows).fill(0).map(function(){return Array(e.cols).fill(!1)}),r={x:1,y:1};o[1][1]=!0,t[1][1]=0;for(var n=[{dx:0,dy:2},{dx:2,dy:0},{dx:0,dy:-2},{dx:-2,dy:0}];;){var i=n.map(function(e){return{x:r.x+e.dx,y:r.y+e.dy,d:e}}).filter(function(t){return t.x>0&&t.x<e.cols-1&&t.y>0&&t.y<e.rows-1&&!o[t.y][t.x]});if(i.length>0){var c=i[Math.floor(Math.random()*i.length)],s=r.x+c.d.dx/2,a=r.y+c.d.dy/2;t[a][s]=0,t[c.y][c.x]=0,o[c.y][c.x]=!0,r={x:c.x,y:c.y}}else{for(var l=!1,u=function(i){for(var c=function(c){if(!o[i][c]){var s=n.map(function(e){return{x:c+e.dx,y:i+e.dy,d:e}}).filter(function(t){return t.x>0&&t.x<e.cols-1&&t.y>0&&t.y<e.rows-1&&o[t.y][t.x]});if(s.length>0){var a=s[Math.floor(Math.random()*s.length)],u=c+a.d.dx/2,p=i+a.d.dy/2;return t[p][u]=0,t[i][c]=0,o[i][c]=!0,r={x:c,y:i},l=!0,"break"}}},s=1;s<p.cols&&"break"!==c(s);s+=2);if(l)return"break"},p=this,h=1;h<this.rows&&"break"!==u(h);h+=2);if(!l)break}}return t},e.prototype._wilson=function(){for(var e=this,t=Array(this.rows).fill(0).map(function(){return Array(e.cols).fill(1)}),o=Array(this.rows).fill(0).map(function(){return Array(e.cols).fill(!1)}),r=[],n=1;n<this.rows;n+=2)for(var i=1;i<this.cols;i+=2)r.push([i,n]);var c=r.splice(Math.floor(Math.random()*r.length),1)[0],s=c[0],a=c[1];for(t[a][s]=0,o[a][s]=!0;r.length>0;){for(var l=r[Math.floor(Math.random()*r.length)],u=l[0],p=l[1],h=[[u,p]],d=(new Set([u+","+p]),[[0,2],[2,0],[0,-2],[-2,0]]),f=function(){for(var e=[],t=0,o=d;t<o.length;t++){var r=o[t],n=r[0],i=r[1],c=u+n,s=p+i;c>0&&c<m.cols-1&&s>0&&s<m.rows-1&&e.push([c,s])}var a=e[Math.floor(Math.random()*e.length)],l=a[0],f=a[1],y=h.findIndex(function(e){var t=e[0],o=e[1];return t===l&&o===f});-1!==y?h=h.slice(0,y+1):h.push([l,f]),u=l,p=f},m=this;!o[p][u];)f();for(var y=0;y<h.length;y++){var g=h[y],b=g[0],v=g[1];if(t[v][b]=0,o[v][b]=!0,y>0){var _=h[y-1],S=_[0],w=_[1];t[v+w>>1][b+S>>1]=0,o[v+w>>1][b+S>>1]=!0}}r=r.filter(function(e){var t=e[0],r=e[1];return!o[r][t]})}return t},e.prototype._cellNeighbors=function(e,t,o){for(var r=[],n=0,i=[[0,2],[2,0],[0,-2],[-2,0]];n<i.length;n++){var c=i[n],s=e+c[0],a=t+c[1];s>0&&s<this.cols-1&&a>0&&a<this.rows-1&&1===o[a][s]&&r.push({x:s,y:a})}return r},e.prototype._addLoops=function(e,t){for(var o=Math.min(.03+.17/21*(t-1),.2),r=1;r<this.rows-1;r++)for(var n=1;n<this.cols-1;n++)1===e[r][n]&&Math.random()<o&&1===this._cellNeighbors(n,r,e).length&&(e[r][n]=0);return e},e.prototype._ensureMinPath=function(e,t){for(var o=Math.min(t,22),n=this.rows+this.cols,i=Math.floor(n*(1+.08*o)),c=0;++c<5&&!(this._calcShortestPath(e)>=i);)t<=4?e.splice.apply(e,r([0,e.length],this._dfs())):t<=10?e.splice.apply(e,r([0,e.length],this._huntAndKill())):e.splice.apply(e,r([0,e.length],this._wilson())),this._addLoops(e,t);return e},e.prototype._calcShortestPath=function(e){var t=this,o=Array(this.rows).fill(0).map(function(){return Array(t.cols).fill(!1)}),r=[{x:1,y:1,d:0}];for(o[1][1]=!0;r.length;){var n=r.shift(),i=n.x,c=n.y,s=n.d;if(i===this.cols-2&&c===this.rows-2)return s;for(var a=0,l=this._cellNeighbors(i,c,e);a<l.length;a++){var u=l[a];o[u.y][u.x]||0!==e[u.y][u.x]||(o[u.y][u.x]=!0,r.push({x:u.x,y:u.y,d:s+1}))}}return 0},e}();o.default=n,cc._RF.pop()},{}],MazeLogic:[function(e,t,o){"use strict";cc._RF.push(t,"ff7a2su8tNBnoE+upLUF5DV","MazeLogic"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("./MazeGenerator"),n=e("./MazeRenderer"),i=function(){function e(e,t,o,i,c){this.cellSize=c,this.maze=[],this.goalPos={x:19,y:19},this.generator=new r.default(21,21),this.renderer=new n.default(e,t,o,i,c)}return e.prototype.build=function(e){void 0===e&&(e=1),this.maze=this.generator.generateMaze(e),this.renderer.render(this.maze),this.goalPos={x:19,y:19}},e.prototype.isWalkable=function(e,t){return e>=0&&e<21&&t>=0&&t<21&&0===this.maze[t][e]},e.prototype.getStartPosition=function(){return{x:1,y:1}},e.prototype.getGoalPosition=function(){return this.goalPos},e}();o.default=i,cc._RF.pop()},{"./MazeGenerator":"MazeGenerator","./MazeRenderer":"MazeRenderer"}],MazePlayerController:[function(e,t,o){"use strict";cc._RF.push(t,"4945dCYaAtPU49aTpTuPF+Z","MazePlayerController");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function s(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,h=e("./MazeGameData"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.START_XY=cc.v2(1,1),t.baseX=0,t.baseY=0,t.currentGridPos=t.START_XY.clone(),t.isMoving=!1,t.movedOnce=!1,t.gameOverShown=!1,t.drawnPath=[],t.drawingLine=null,t.isDrawing=!1,t.visualPathPixels=[],t.pathGrids=[],t}return n(t,e),t.prototype.resetPlayer=function(){this.isMoving=!1,this.movedOnce=!1,this.gameOverShown=!1,this.pathGrids=[],this.visualPathPixels=[],this.drawingLine&&this.drawingLine.clear(),this.currentGridPos=this.START_XY.clone(),this.node.setPosition(this.gridToWorld(this.START_XY))},t.prototype.onLoad=function(){switch(this.sprite=this.node.getComponent(cc.Sprite)||this.node.addComponent(cc.Sprite),h.default.playerType){case"tiger":this.sprite.spriteFrame=this.tigerFrame;break;case"dog":this.sprite.spriteFrame=this.dogFrame;break;case"rabbit":this.sprite.spriteFrame=this.rabbitFrame;break;default:this.sprite.spriteFrame=this.tigerFrame}this.sprite.type=cc.Sprite.Type.SIMPLE,this.sprite.sizeMode=cc.Sprite.SizeMode.TRIMMED,this.node.setScale(1),this.node.setContentSize(50,50),this.node.setAnchorPoint(.5,.5),this.node.zIndex=500;var e=this.node.parent.getChildByName("PathGraphics");e||(e=new cc.Node("PathGraphics"),this.node.parent.addChild(e,999)),this.drawingLine=e.getComponent(cc.Graphics)||e.addComponent(cc.Graphics);var t=this.node.parent;t.on(cc.Node.EventType.TOUCH_START,this.onDrawStart,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onDrawMove,this),t.on(cc.Node.EventType.TOUCH_END,this.onDrawEnd,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.onDrawEnd,this)},t.prototype.onDestroy=function(){var e=this.node.parent;e.off(cc.Node.EventType.TOUCH_START,this.onDrawStart,this),e.off(cc.Node.EventType.TOUCH_MOVE,this.onDrawMove,this),e.off(cc.Node.EventType.TOUCH_END,this.onDrawEnd,this),e.off(cc.Node.EventType.TOUCH_CANCEL,this.onDrawEnd,this)},t.prototype.gridToWorld=function(e){var t=this.mazeLogic.cellSize;return cc.v2(this.baseX+e.x*t+t/2,this.baseY+e.y*t+t/2)},t.prototype.screenToGrid=function(e){var t=this.mazeLogic.cellSize,o=Math.floor((e.x-this.baseX)/t),r=Math.floor((e.y-this.baseY)/t);return o<0||r<0||o>=this.mazeLogic.maze[0].length||r>=this.mazeLogic.maze.length?this.currentGridPos.clone():cc.v2(o,r)},t.prototype.isValidGrid=function(e){return e.x>=0&&e.y>=0&&e.x<this.mazeLogic.maze[0].length&&e.y<this.mazeLogic.maze.length&&this.mazeLogic.isWalkable(e.x,e.y)},t.prototype.getLinePath=function(e,t){var o=[],r=e.x,n=e.y,i=t.x,c=t.y;if(r===i)for(var s=n+(l=c>n?1:-1);s!==c+l;s+=l){var a=cc.v2(r,s);if(!this.isValidGrid(a))break;o.push(a)}else if(n===c)for(var l,u=r+(l=i>r?1:-1);u!==i+l&&(a=cc.v2(u,n),this.isValidGrid(a));u+=l)o.push(a);return o},t.prototype.getManhattanPath=function(e,t){var o=cc.v2(t.x,e.y),r=cc.v2(e.x,t.y),n=this.getLinePath(e,o).concat(this.getLinePath(o,t)),i=this.getLinePath(e,r).concat(this.getLinePath(r,t));return n.length===Math.abs(t.x-e.x)+Math.abs(t.y-e.y)?n:i.length===Math.abs(t.x-e.x)+Math.abs(t.y-e.y)?i:[]},t.prototype.onDrawStart=function(e){if(this.mazeLogic&&!this.isMoving&&!this.movedOnce&&!this.gameOverShown){this.drawingLine.clear(),this.visualPathPixels=[],this.pathGrids=[];var t=e.getLocation();if(this.screenToGrid(t).equals(this.currentGridPos)){var o=this.gridToWorld(this.currentGridPos);this.visualPathPixels.push(o.clone()),this.pathGrids.push(this.currentGridPos.clone()),this.drawingLine.moveTo(o.x,o.y)}}},t.prototype.onDrawMove=function(e){if(!this.isMoving&&0!==this.pathGrids.length&&!this.movedOnce&&!this.gameOverShown){var t=e.getLocation(),o=this.screenToGrid(t),r=this.pathGrids[this.pathGrids.length-1];if(!(1===this.pathGrids.length&&r.equals(o)||r.equals(o))){var n=this.getManhattanPath(r,o);if(n.length>0)for(var i=function(e){if(!c.isValidGrid(e))return"break";if(c.pathGrids.find(function(t){return t.equals(e)}))return"continue";c.pathGrids.push(e.clone());var t=c.gridToWorld(e);c.visualPathPixels.push(t.clone()),c.drawingLine.lineTo(t.x,t.y),c.drawingLine.strokeColor=cc.color(255,0,0,255),c.drawingLine.lineWidth=6,c.drawingLine.stroke()},c=this,s=0,a=n;s<a.length&&"break"!==i(a[s]);s++);}}},t.prototype.onDrawEnd=function(){this.movedOnce||this.gameOverShown||this.pathGrids.length>1&&this.followPath(a(this.pathGrids))},t.prototype.followPath=function(e){return c(this,void 0,void 0,function(){var t,o,r,n,i,c,a,l=this;return s(this,function(s){switch(s.label){case 0:this.isMoving=!0,this.visualPathPixels=e.map(function(e){return l.gridToWorld(e)}),t=this.mazeLogic.getGoalPosition(),o=1,s.label=1;case 1:return o<e.length?[4,this.moveToGrid(e[o])]:[3,4];case 2:if(s.sent(),this.visualPathPixels.shift(),this.drawingLine.clear(),this.visualPathPixels.length>=2){for(r=this.visualPathPixels[0],this.drawingLine.moveTo(r.x,r.y),n=1;n<this.visualPathPixels.length;n++)i=this.visualPathPixels[n],this.drawingLine.lineTo(i.x,i.y);this.drawingLine.strokeColor=cc.color(255,0,0,255),this.drawingLine.lineWidth=6,this.drawingLine.stroke()}if(this.currentGridPos.x===t.x&&this.currentGridPos.y===t.y)return this.isMoving=!1,this.drawingLine.clear(),this.pathGrids=[],this.visualPathPixels=[],this.node.emit("playerReachedGoal"),[2];s.label=3;case 3:return o++,[3,1];case 4:return this.isMoving=!1,this.drawingLine.clear(),this.pathGrids=[],this.visualPathPixels=[],this.movedOnce=!0,this.gameOverUIPrefab&&(c=cc.instantiate(this.gameOverUIPrefab),(a=cc.find("Canvas")).addChild(c),c.zIndex=1e3,c.setSiblingIndex(a.childrenCount-1),c.setPosition(540,960),this.gameOverShown=!0),[2]}})})},t.prototype.moveToGrid=function(e){var t=this;return new Promise(function(o){var r=t.gridToWorld(e);cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.12,{x:r.x,y:r.y}).call(function(){t.currentGridPos=e.clone(),o()}).start()})},i([p(cc.SpriteFrame)],t.prototype,"tigerFrame",void 0),i([p(cc.SpriteFrame)],t.prototype,"dogFrame",void 0),i([p(cc.SpriteFrame)],t.prototype,"rabbitFrame",void 0),i([p(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([u],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./MazeGameData":"MazeGameData"}],MazeRenderer:[function(e,t,o){"use strict";cc._RF.push(t,"e8d69E0+upFJJC6bMelP2BM","MazeRenderer"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t,o,r,n){this.container=e,this.tilePrefab=t,this.pathFrame=o,this.grassFrame=r,this.cellSize=n}return e.prototype.render=function(e){this.container.removeAllChildren();for(var t=e.length,o=e[0].length,r=0;r<t;r++)for(var n=0;n<o;n++){var i=cc.instantiate(this.tilePrefab);i.setPosition(cc.v2(n*this.cellSize+this.cellSize/2,r*this.cellSize+this.cellSize/2)),i.setContentSize(this.cellSize,this.cellSize);var c=i.getComponent(cc.Sprite);c.type=cc.Sprite.Type.SIMPLE,c.spriteFrame=0===e[r][n]?this.pathFrame:this.grassFrame,this.container.addChild(i)}},e}();o.default=r,cc._RF.pop()},{}],MazeSingleGameManager:[function(e,t,o){"use strict";cc._RF.push(t,"4f092SlID9Pt5Qa8xNU9wGe","MazeSingleGameManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./MazeGameData"),s=e("./MazeLogic"),a=e("./MazePlayerController"),l=e("./MazeUIManager"),u=e("../Controller/CommonUI/GameState"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeRem=60,t.gameOver=!1,t.isGoalReached=!1,t}return n(t,e),t.prototype.debugSetLevel=function(e){this._startLevel(e)},t.prototype.debugSetTime=function(e){this.timeRem=e,this.uiMgr&&this.uiMgr.setTimer(this.timeRem)},t.prototype.onLoad=function(){var e=this;this.node.on("nextLevel",function(){return e._startLevel(c.default.currentLevel+1)}),this.playerCtrl.node.on("playerReachedGoal",function(){},this)},t.prototype.start=function(){var e=this;if(u.default.lastGameScene=cc.director.getScene().name,this.gameStartOverlayPrefab){var t=cc.instantiate(this.gameStartOverlayPrefab),o=cc.find("Canvas");o.addChild(t),t.zIndex=1e3,t.setSiblingIndex(o.childrenCount-1),t.setPosition(540,960);var r=t.getComponent(cc.Animation);r?(r.play("GameStartFade"),r.once(cc.Animation.EventType.FINISHED,function(){t.destroy(),e.startGameLogic()},this)):this.scheduleOnce(function(){t.destroy(),e.startGameLogic()},1.5)}else this.startGameLogic();window.GM=this},t.prototype.startGameLogic=function(){this.uiMgr.setScore(0),c.default.score=0,this.logic=new s.default(this.mazeContainer,this.tilePrefab,this.pathFrame,this.grassFrame,50),this.playerCtrl.mazeLogic=this.logic,this.isGoalReached=!1,this.gameOver=!1,this._startLevel(c.default.currentLevel)},t.prototype._startLevel=function(e){c.default.currentLevel=e,this.timeRem=30,this.gameOver=!1,this.isGoalReached=!1,this.logic=new s.default(this.mazeContainer,this.tilePrefab,this.pathFrame,this.grassFrame,50),this.playerCtrl.mazeLogic=this.logic,this.logic.build(e);var t=this.logic.cellSize,o=(1080-this.logic.maze[0].length*t)/2,r=(1920-this.logic.maze.length*t)/2;this.mazeContainer.setPosition(o,r),this.playerCtrl.baseX=o,this.playerCtrl.baseY=r,this.playerCtrl.resetPlayer();var n,i=this.logic.getStartPosition();switch(this.playerCtrl.currentGridPos=cc.v2(i.x,i.y),this.playerCtrl.node.setPosition(o+i.x*t+t/2,r+i.y*t+t/2),c.default.playerType){case"tiger":n=this.goalSongpyeon;break;case"dog":n=this.goalBone;break;case"rabbit":n=this.goalCarrot;break;default:n=this.goalSongpyeon}var a=this.goalNode.getComponent(cc.Sprite);a||(a=this.goalNode.addComponent(cc.Sprite)),a.type=cc.Sprite.Type.SIMPLE,a.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.goalNode.setContentSize(t,t),this.goalNode.zIndex=500,a.spriteFrame=n;var l=this.logic.getGoalPosition();this.goalNode.setPosition(cc.v2(o+l.x*t+t/2,r+l.y*t+t/2)),this.uiMgr.setTimer(this.timeRem),this.uiMgr.setScore(c.default.score)},t.prototype.update=function(e){var t=this;if(this.logic&&this.logic.maze&&!this.gameOver){var o=this.logic.cellSize,r=(1080-this.logic.maze[0].length*o)/2,n=(1920-this.logic.maze.length*o)/2,i=this.logic.getGoalPosition(),s=cc.v2(r+i.x*o+o/2,n+i.y*o+o/2);if(!this.isGoalReached&&this.playerCtrl.node.getPosition().sub(s).mag()<.5*o)return this.isGoalReached=!0,this.gameOver=!0,c.default.addScore(c.default.currentLevel),this.uiMgr.setScore(c.default.score),void this.scheduleOnce(function(){t._startLevel(c.default.currentLevel+1)},.1);if(this.timeRem-=e,this.uiMgr.setTimer(this.timeRem),this.timeRem<=0){if(this.gameOver=!0,u.default.lastGameScene=cc.director.getScene().name,u.default.score=c.default.score,u.default.gameId="maze-game",this.gameOverUIPrefab){var a=cc.instantiate(this.gameOverUIPrefab),l=cc.find("Canvas");l.addChild(a),a.zIndex=1e3,a.setSiblingIndex(l.childrenCount-1),a.setPosition(540,960);var p=a.getChildByName("RetryButton");p&&p.on(cc.Node.EventType.TOUCH_END,function(){c.default.score=0,t.uiMgr.setScore(0),c.default.currentLevel=1,t._startLevel(1),a.destroy()},this)}c.default.currentLevel=1}}},i([d(cc.Node)],t.prototype,"mazeContainer",void 0),i([d(a.default)],t.prototype,"playerCtrl",void 0),i([d(l.default)],t.prototype,"uiMgr",void 0),i([d(cc.Node)],t.prototype,"goalNode",void 0),i([d(cc.Prefab)],t.prototype,"tilePrefab",void 0),i([d(cc.SpriteFrame)],t.prototype,"pathFrame",void 0),i([d(cc.SpriteFrame)],t.prototype,"grassFrame",void 0),i([d(cc.SpriteFrame)],t.prototype,"goalSongpyeon",void 0),i([d(cc.SpriteFrame)],t.prototype,"goalBone",void 0),i([d(cc.SpriteFrame)],t.prototype,"goalCarrot",void 0),i([d(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([d(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../Controller/CommonUI/GameState":"GameState","./MazeGameData":"MazeGameData","./MazeLogic":"MazeLogic","./MazePlayerController":"MazePlayerController","./MazeUIManager":"MazeUIManager"}],MazeUIManager:[function(e,t,o){"use strict";cc._RF.push(t,"cec73N5ZjNJQYlYwuo3Uml1","MazeUIManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timerPrefab=null,t.scorePrefab=null,t.backBtn=null,t.timerLabel=null,t.scoreLabel=null,t}return n(t,e),t.prototype.onLoad=function(){if(this.timerPrefab){var e=cc.instantiate(this.timerPrefab);this.node.addChild(e);var t=e.getChildByName("TimerLabel");t&&(this.timerLabel=t.getComponent(cc.Label)),this.timerLabel||console.warn("\u26a0\ufe0f TimerLabel \uc5f0\uacb0 \uc2e4\ud328! \ud504\ub9ac\ud339 \uad6c\uc870 \ub610\ub294 \ub178\ub4dc \uc774\ub984 \ud655\uc778 \ud544\uc694.")}if(this.scorePrefab){var o=cc.instantiate(this.scorePrefab);this.node.addChild(o);var r=o.getChildByName("ScoreLabel");r&&(this.scoreLabel=r.getComponent(cc.Label)),this.scoreLabel||console.warn("\u26a0\ufe0f ScoreLabel \uc5f0\uacb0 \uc2e4\ud328! \ud504\ub9ac\ud339 \uad6c\uc870 \ub610\ub294 \ub178\ub4dc \uc774\ub984 \ud655\uc778 \ud544\uc694.")}this.backBtn&&this.backBtn.on("click",function(){cc.director.loadScene("SingleGameList")})},t.prototype.setTimer=function(e){this.timerLabel&&(this.timerLabel.string=""+Math.ceil(e))},t.prototype.setScore=function(e){this.scoreLabel&&(this.scoreLabel.string=""+e)},i([a(cc.Prefab)],t.prototype,"timerPrefab",void 0),i([a(cc.Prefab)],t.prototype,"scorePrefab",void 0),i([a(cc.Node)],t.prototype,"backBtn",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Maze_explainSceneManager:[function(e,t,o){"use strict";cc._RF.push(t,"3ce4bjAkZFBSr8F4aGIbGs9","Maze_explainSceneManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./MazeGameData"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BackButton=null,t}return n(t,e),t.prototype.start=function(){c.default.currentLevel=1,this.startBtn.on("click",function(){return cc.director.loadScene("MazeSingleScene")})},t.prototype.onClickList=function(){cc.log("\ub4a4\ub85c\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad\ub428. SingleGameList \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("SingleGameList")},i([l(cc.Button)],t.prototype,"BackButton",void 0),i([l(cc.Node)],t.prototype,"startBtn",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./MazeGameData":"MazeGameData"}],MoleExplain:[function(e,t,o){"use strict";cc._RF.push(t,"afc55Gc2nZMuannl5wsNcAU","MoleExplain");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameStartButton=null,t.BackToSingleGameListButton=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.gameStartButton.node.on("click",this.onClickStartGame,this),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_ENTER,function(){cc.game.canvas.style.cursor="pointer",e.gameStartButton.node.runAction(cc.scaleTo(.1,1.1))}),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){cc.game.canvas.style.cursor="default",e.gameStartButton.node.runAction(cc.scaleTo(.1,1))})},t.prototype.onClickStartGame=function(){cc.log("\uac8c\uc784 \uc2dc\uc791 \ubc84\ud2bc \ud074\ub9ad\ub428"),cc.director.loadScene("MoleGameScene")},t.prototype.onClickBackSingleGameList=function(){cc.log("\uc2f1\uae00\uac8c\uc784\ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([a(cc.Button)],t.prototype,"gameStartButton",void 0),i([a(cc.Button)],t.prototype,"BackToSingleGameListButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MoleGameScene:[function(e,t,o){"use strict";cc._RF.push(t,"91bdevLJ/ZGZJl7sY0rhKiI","MoleGameScene");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../../Controller/CommonUI/GameState"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.exitButton=null,t.Hole1=null,t.Hole2=null,t.Hole3=null,t.Hole4=null,t.Hole5=null,t.Hole6=null,t.Hole7=null,t.Hole8=null,t.Hole9=null,t.molePrefab=null,t.molePrefabGood=null,t.hammerSprite=null,t.timerDisplayPrefab=null,t.scoreDisplayPrefab=null,t.moleHitSprite=null,t.goodMoleHitSprite=null,t.gameOverUIPrefab=null,t.gameStartOverlayPrefab=null,t.hammerNode=null,t.moleHoles=[],t.holeStates=[],t.score=0,t.timer=60,t.timerNode=null,t.timerLabel=null,t.scoreNode=null,t.scoreLabel=null,t.isGameOver=!1,t.moleSpawnCallback=null,t}return n(t,e),t.prototype.start=function(){var e=this;if(c.default.lastGameScene=cc.director.getScene().name,this.gameStartOverlayPrefab){var t=cc.instantiate(this.gameStartOverlayPrefab);this.node.addChild(t),t.setPosition(0,0),this.scheduleOnce(function(){e.startGameLogic()},1)}else this.startGameLogic()},t.prototype.startGameLogic=function(){this.moleHoles=[this.Hole1,this.Hole2,this.Hole3,this.Hole4,this.Hole5,this.Hole6,this.Hole7,this.Hole8,this.Hole9],this.holeStates=new Array(this.moleHoles.length).fill(!1),this.createHammer(),this.score=0,this.timerNode=cc.instantiate(this.timerDisplayPrefab),this.node.addChild(this.timerNode),this.timerLabel=this.timerNode.getChildByName("TimerLabel").getComponent(cc.Label),this.updateTimerLabel(),this.scoreNode=cc.instantiate(this.scoreDisplayPrefab),this.node.addChild(this.scoreNode),this.scoreLabel=this.scoreNode.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScoreLabel(),this.schedule(this.decreaseTimer,1),this.spawnMoles()},t.prototype.createHammer=function(){this.hammerNode=new cc.Node("Hammer"),this.hammerNode.addComponent(cc.Sprite).spriteFrame=this.hammerSprite,this.hammerNode.parent=this.node,this.hammerNode.zIndex=999,this.hammerNode.setContentSize(200,200),this.hammerNode.anchorX=.2,this.hammerNode.anchorY=.2,this.hammerNode.active=!1},t.prototype.decreaseTimer=function(){this.isGameOver||(this.timer--,this.updateTimerLabel(),this.timer<=0&&this.gameOver())},t.prototype.updateScoreLabel=function(){this.scoreLabel.string=""+this.score},t.prototype.updateTimerLabel=function(){this.timerLabel.string=""+this.timer},t.prototype.spawnMoles=function(){var e=this;this.moleSpawnCallback&&this.unschedule(this.moleSpawnCallback),this.moleSpawnCallback=function(){if(!e.isGameOver){var t=e.holeStates.map(function(e,t){return e?-1:t}).filter(function(e){return-1!==e});if(0!==t.length){var o=t[Math.floor(Math.random()*t.length)],r=e.moleHoles[o],n=Math.random()<.3,i=cc.instantiate(n?e.molePrefabGood:e.molePrefab);i.name="Mole",r.addChild(i),i.setPosition(0,-130),i.active=!0,e.holeStates[o]=!0;var c=function(t){if(t.stopPropagation(),i.active&&!e.isGameOver){var r=i.convertToWorldSpaceAR(cc.v2(0,0)),s=e.node.convertToNodeSpaceAR(r);e.showHammerEffect(s);var a=i.getComponent(cc.Sprite);a&&(a.spriteFrame=n?e.goodMoleHitSprite:e.moleHitSprite),e.score+=n?-10:10,e.updateScoreLabel(),i.off(cc.Node.EventType.TOUCH_END,c,e),cc.tween(i).repeat(3,cc.tween().by(.05,{angle:15}).by(.05,{angle:-30}).by(.05,{angle:15})).delay(.8).call(function(){i&&i.isValid&&(i.destroy(),e.holeStates[o]=!1)}).start()}};i.on(cc.Node.EventType.TOUCH_END,c,e),cc.tween(i).to(.2,{position:cc.v3(0,-20)},{easing:"sineOut"}).delay(1).call(function(){i.isValid&&(i.off(cc.Node.EventType.TOUCH_END,c,e),i.destroy(),e.holeStates[o]=!1)}).start()}}},this.schedule(this.moleSpawnCallback,.5,cc.macro.REPEAT_FOREVER)},t.prototype.showHammerEffect=function(e){var t=this;this.hammerNode.setPosition(e),this.hammerNode.active=!0,cc.tween(this.hammerNode).set({scale:1}).parallel(cc.tween().to(.05,{scale:1.2},{easing:"cubicOut"}),cc.tween().by(.05,{position:cc.v3(0,-30)})).parallel(cc.tween().to(.1,{scale:1},{easing:"bounceOut"}),cc.tween().by(.1,{position:cc.v3(0,30)})).call(function(){t.hammerNode.active=!1}).start()},t.prototype.gameOver=function(){if(!this.isGameOver){this.isGameOver=!0,this.moleSpawnCallback&&this.unschedule(this.moleSpawnCallback),this.unscheduleAllCallbacks(),this.timer=0,this.updateTimerLabel(),this.moleHoles.forEach(function(e){var t=e.getChildByName("Mole");t&&(t.active=!1)}),this.hammerNode.active=!1,console.log("\uac8c\uc784 \uc885\ub8cc!"),c.default.lastGameScene=cc.director.getScene().name,c.default.score=this.score,c.default.gameId="Molegame";var e=cc.instantiate(this.gameOverUIPrefab);this.node.addChild(e),e.setPosition(0,0)}},t.prototype.loadList=function(){console.log("\uc2f1\uae00 \uac8c\uc784 \ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30");var e=document.getElementById("GameCanvas");e&&(e.style.cursor="default"),cc.director.loadScene("SingleGameList")},i([l(cc.Button)],t.prototype,"exitButton",void 0),i([l(cc.Node)],t.prototype,"Hole1",void 0),i([l(cc.Node)],t.prototype,"Hole2",void 0),i([l(cc.Node)],t.prototype,"Hole3",void 0),i([l(cc.Node)],t.prototype,"Hole4",void 0),i([l(cc.Node)],t.prototype,"Hole5",void 0),i([l(cc.Node)],t.prototype,"Hole6",void 0),i([l(cc.Node)],t.prototype,"Hole7",void 0),i([l(cc.Node)],t.prototype,"Hole8",void 0),i([l(cc.Node)],t.prototype,"Hole9",void 0),i([l(cc.Prefab)],t.prototype,"molePrefab",void 0),i([l(cc.Prefab)],t.prototype,"molePrefabGood",void 0),i([l(cc.SpriteFrame)],t.prototype,"hammerSprite",void 0),i([l(cc.Prefab)],t.prototype,"timerDisplayPrefab",void 0),i([l(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([l(cc.SpriteFrame)],t.prototype,"moleHitSprite",void 0),i([l(cc.SpriteFrame)],t.prototype,"goodMoleHitSprite",void 0),i([l(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([l(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState"}],MultiFlowController:[function(e,t,o){"use strict";cc._RF.push(t,"95c34Sns9FBiqV8rLcLlrPT","MultiFlowController");var r=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=e("../CommonUI/GameState"),i=cc._decorator.ccclass,c=function(){function e(){}return e.initializeSocketListeners=function(){if(!cc.sys.isNative&&window.socket){var e=n.default.createdRoomId||n.default.incomingRoomId;e&&(window.socket.emit("join-room",e),n.default.isHost||setTimeout(function(){window.socket.emit("game-event",{type:"guest-ready",roomId:e,payload:{playerId:n.default.browserId||""}})},200),window.socket.off("game-event"),window.socket.on("game-event",function(t){var o=t.type,r=t.payload;if(t.roomId===e)switch(o){case"guest-ready":n.default.isHost&&(window.socket.emit("game-event",{type:"game-start",roomId:e,payload:{}}),cc.director.emit("multi-game-start"));break;case"game-start":n.default.isHost||cc.director.emit("multi-game-start");break;case"spawn-mole":case"hit-mole":case"sequence-generated":case"user-input":case"input-result":case"level-up":case"spawn-question":case"answer-result":case"score-update":cc.director.emit(o,r);break;case"move-scene":cc.log('[FlowController] move-scene \uc218\uc2e0. payload.sceneName = "'+(null==r?void 0:r.sceneName)+'"');var i=null==r?void 0:r.sceneName;i?(cc.log('[FlowController] loadScene \uc2dc\ub3c4 \u2192 "'+i+'"'),cc.director.loadScene(i,function(){cc.log('[FlowController] loadScene \ucf5c\ubc31: "'+i+'" \ub85c\ub4dc \uc644\ub8cc')})):cc.warn("[FlowController] move-scene: payload.sceneName\uc774 \uc5c6\uc5b4\uc11c loadScene \ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");break;case"host-left":n.default.resetMultiplay(),cc.director.loadScene("MainScene");break;default:console.warn("MultiGameFlowController: \uc54c \uc218 \uc5c6\ub294 game-event:",o)}}),window.socket.on("connect",function(){e&&window.socket.emit("join-room",e)}))}},e.endGame=function(e){var t;if(!e.isGameOver){e.isGameOver=!0,null===(t=e.unscheduleAllCallbacks)||void 0===t||t.call(e);var o=n.default.createdRoomId||n.default.incomingRoomId,r=e.score;!cc.sys.isNative&&window.socket&&o&&window.socket.emit("game-event",{type:"game-end",roomId:o,payload:{score:r,nickname:n.default.nickname,character:n.default.character,isHost:!0===n.default.isHost}}),cc.log("MultiGameFlowController.endGame \u2192 game-end emit, \uc810\uc218:",r)}},r([i],e)}();o.default=c,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],MultiGameList:[function(e,t,o){"use strict";cc._RF.push(t,"ef542TYLFJBrbpjDKj7XKqL","MultiGameList");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../CommonUI/GameState"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameCardContainer=null,t.gameCardPrefab=null,t.selectButton=null,t.leftArrow=null,t.rightArrow=null,t.BackButton=null,t.currentIndex=0,t.cards=[],t.selectedScene=null,t._gameEventHandler=null,t.pollingTimer=null,t.gameList=[{title:"\ub450\ub354\uc9c0 \uac8c\uc784",thumbnail:"mole_thumb",scene:"MultiMoleGameScene",desc:"\ub098\uc05c \ub450\ub354\uc9c0\ub97c \ucd5c\ub300\ud55c \ub9ce\uc774 \uc7a1\uc73c\uc138\uc694!\n \ucc29\ud55c \ub450\ub354\uc9c0\ub97c \uc7a1\uc73c\uba74 \uc810\uc218\uac00 \ub5a8\uc5b4\uc9c0\ub2c8 \uc870\uc2ec\ud558\uc138\uc694!"},{title:"\uae30\uc5b5\ub825 \uac8c\uc784",thumbnail:"remember_thumb",scene:"MultiRememberGameScene",desc:"\uae5c\ube61\uc774\ub294 \uc78e\uc758 \uc21c\uc11c\ub97c \uc798 \uae30\uc5b5\ud574\uc11c\n  \uadf8\ub300\ub85c \ub20c\ub7ec\ubcf4\uc138\uc694!\n \ud558\uc9c0\ub9cc \ubc29\uc2ec\ud558\uba74 \ubc18\uc804\uc5d0 \ub180\ub784\uc9c0\ub3c4 \ubab0\ub77c\uc694!"},{title:"\uc22b\uc790 \ub4a4\uc9d1\uc5b4 \ub9de\ucd94\uae30",thumbnail:"reverse_thumb",scene:"Reversecorrect_Multiscene",desc:"\uc7a0\uae50 \uacf5\uac1c\ub41c \uc22b\uc790\ub97c \uae30\uc5b5\ud558\uace0 \ub9de\ud600\ubcf4\uc138\uc694!\n\uac00\ub054\uc529\uc740 \uc5ed\ubc29\ud5a5\uc73c\ub85c \ub9de\ucdb0\ubcf4\uc138\uc694! "},{title:"\ubbf8\ub85c \uac8c\uc784",thumbnail:"maze_thumb",scene:"Maze_MultiScene",desc:"\ubbf8\ub85c\ub97c \ub6ab\uace0 \ub3d9\ubb3c\ub4e4\uc774 \uc74c\uc2dd\uc744 \ucc3e\ub294 \uac78 \n \ub3c4\uc640\uc8fc\uc138\uc694!  \uae30\ud68c\ub294 \ub2e8 \ud55c\ubc88 \ubfd0\uc774\uc5d0\uc694!"}],t}return n(t,e),t.prototype.onLoad=function(){var e=this;if(cc.debug.setDisplayStats(!1),this.selectButton.interactable=!1,cc.log("MultiGameListController onLoad \uc2e4\ud589\ub428"),cc.log("GameState.isHost =",c.default.isHost),this.loadGameCards(),this.registerArrowEvents(this.leftArrow,this.showPrevCard.bind(this)),this.registerArrowEvents(this.rightArrow,this.showNextCard.bind(this)),this.registerButtonEvents(this.selectButton.node,this.onSelectButtonClick.bind(this)),this.registerButtonEvents(this.BackButton.node,this.onClickMain.bind(this)),c.default.isHost||(this.selectButton.node.active=!1),!cc.sys.isNative&&window.socket){var t=c.default.createdRoomId||c.default.incomingRoomId;window.socket.connected||(console.warn("\uc18c\ucf13\uc774 \ub04a\uaca8 \uc788\uc74c. \uc7ac\uc5f0\uacb0 \uc2dc\ub3c4 \uc911"),window.socket.connect()),t&&(cc.log("join-room \uc7ac\uc694\uccad:",t),window.socket.emit("join-room",t)),this._gameEventHandler=function(t){var o;switch(cc.log("game-event \uc218\uc2e0:",t),null==t?void 0:t.type){case"move-scene":var r=null===(o=t.payload)||void 0===o?void 0:o.sceneName;r?(cc.log("\uc52c \uc774\ub3d9 \uc2dc\ub3c4:",r),cc.director.loadScene(r)):cc.warn("sceneName \ub204\ub77d\ub428:",t);break;case"host-left":cc.warn("\ud638\uc2a4\ud2b8\uac00 \ubc29\uc744 \ub098\uac14\uc2b5\ub2c8\ub2e4. \uba54\uc778 \ud654\uba74\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4."),e.pollingTimer&&(clearInterval(e.pollingTimer),e.pollingTimer=null),c.default.resetMultiplay(),cc.sys.localStorage.removeItem("isHost"),cc.director.loadScene("MainScene");break;default:cc.warn("\uc54c \uc218 \uc5c6\ub294 game-event \ud0c0\uc785 \ub610\ub294 \uc798\ubabb\ub41c \uad6c\uc870:",t)}},window.socket.on("game-event",this._gameEventHandler),window.socket.on("connect",function(){cc.log("\uc18c\ucf13 \uc7ac\uc5f0\uacb0\ub428. join-room \uc7ac\uc804\uc1a1"),t&&window.socket.emit("join-room",t)})}},t.prototype.onDestroy=function(){this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null),!cc.sys.isNative&&window.socket&&this._gameEventHandler&&window.socket.off("game-event",this._gameEventHandler)},t.prototype.registerButtonEvents=function(e,t){e.off(cc.Node.EventType.TOUCH_END),e.on(cc.Node.EventType.TOUCH_END,t)},t.prototype.registerArrowEvents=function(e,t){e.off(cc.Node.EventType.TOUCH_END),e.on(cc.Node.EventType.TOUCH_END,t)},t.prototype.loadGameCards=function(){var e=this;this.gameList.forEach(function(t,o){var r;cc.log("\uce74\ub4dc \uc0dd\uc131:",o,t.title);var n=cc.instantiate(e.gameCardPrefab),i=null===(r=n.getChildByName("GameTitleBox"))||void 0===r?void 0:r.getChildByName("GameTitle");i&&i.getComponent(cc.Label)&&(i.getComponent(cc.Label).string=t.title);var c=n.getChildByName("GameDesc");c&&c.getComponent(cc.Label)&&(c.getComponent(cc.Label).string=t.desc);var s=n.getChildByName("GameThumbnail");s&&s.getComponent(cc.Sprite)&&cc.resources.load("Images/Common/thumbnails/"+t.thumbnail,cc.SpriteFrame,function(e,t){!e&&t&&(s.getComponent(cc.Sprite).spriteFrame=t)}),n.active=!1,e.cards.push(n),e.gameCardContainer.addChild(n)}),this.showCardAtIndex(0)},t.prototype.showCardAtIndex=function(e){cc.log("showCardAtIndex \ud638\ucd9c: index = "+e+", cards.length = "+this.cards.length),this.cards.forEach(function(t,o){t.active=o===e}),this.currentIndex=e,this.selectScene(this.gameList[e].scene,this.cards[e])},t.prototype.showNextCard=function(){var e=(this.currentIndex+1)%this.cards.length;this.showCardAtIndex(e)},t.prototype.showPrevCard=function(){var e=(this.currentIndex-1+this.cards.length)%this.cards.length;this.showCardAtIndex(e)},t.prototype.selectScene=function(e,t){this.selectedScene=e,this.gameCardContainer.children.forEach(function(e){e.scale=e===t?1.1:1,e.opacity=e===t?255:180}),this.selectButton.interactable=!0},t.prototype.onSelectButtonClick=function(){if(this.selectedScene){var e=c.default.createdRoomId;console.log("[onSelectButtonClick] move-scene emit \uc2dc\ub3c4:",this.selectedScene,c.default.isHost,e),c.default.isHost&&e&&window.socket&&window.socket.emit("game-event",{type:"move-scene",payload:{sceneName:this.selectedScene},roomId:e}),console.log("window.socket \uc0c1\ud0dc:",window.socket&&window.socket.connected)}},t.prototype.onClickMain=function(){this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null);var e=c.default.createdRoomId||c.default.incomingRoomId,t=c.default.browserId;cc.log("[leave-room emit]",{roomId:e,playerId:t}),window.socket&&e&&t&&window.socket.emit("leave-room",{roomId:e,playerId:t}),c.default.resetMultiplay(),cc.sys.localStorage.removeItem("isHost"),cc.director.loadScene("MainScene")},i([l(cc.Node)],t.prototype,"gameCardContainer",void 0),i([l(cc.Prefab)],t.prototype,"gameCardPrefab",void 0),i([l(cc.Button)],t.prototype,"selectButton",void 0),i([l(cc.Node)],t.prototype,"leftArrow",void 0),i([l(cc.Node)],t.prototype,"rightArrow",void 0),i([l(cc.Button)],t.prototype,"BackButton",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],MultiGameResult:[function(e,t,o){"use strict";cc._RF.push(t,"2ecb8zIzdRBcYYC0CX8D7P7","MultiGameResult");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../CommonUI/GameState"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.NameLabel=null,t.ScoreLabel=null,t.VictoryCharacter=null,t.BackButton=null,t}return n(t,e),t.prototype.start=function(){var e=this,t=c.default.createdRoomId||c.default.incomingRoomId;t?fetch("https://smartzoo.shop/multi/game/result/"+t).then(function(e){return e.json()}).then(function(t){var o;if(t.success&&(null===(o=t.data)||void 0===o?void 0:o.winner)&&!t.data.winner.isTie){var r=t.data.winner;cc.log("\uc2b9\uc790 \uc815\ubcf4:",r),e.NameLabel.string=r.nickname||"???",e.ScoreLabel.string=r.score+"\uc810",e.setCharacterSprite(r.character)}else cc.warn("\uc2b9\uc790 \uc5c6\uc74c \ub610\ub294 \ubb34\uc2b9\ubd80"),e.NameLabel.string="\ubb34\uc2b9\ubd80",e.ScoreLabel.string=""}).catch(function(e){cc.error("\uacb0\uacfc API \uc624\ub958:",e)}):cc.warn("roomId \uc5c6\uc74c")},t.prototype.setCharacterSprite=function(e){var t=this,o="Images/Common/characters/"+e;cc.resources.load(o,cc.SpriteFrame,function(e,r){!e&&r?t.VictoryCharacter.spriteFrame=r:cc.warn("\uce90\ub9ad\ud130 \uc774\ubbf8\uc9c0 \ub85c\ub529 \uc2e4\ud328:",o)})},t.prototype.onClickBack=function(){var e=c.default.createdRoomId||c.default.incomingRoomId,t=c.default.browserId;window.socket&&e&&t&&window.socket.emit("leave-room",{roomId:e,playerId:t}),cc.sys.localStorage.removeItem("isHost"),c.default.resetMultiplay(),cc.director.loadScene("MainScene")},i([l(cc.Label)],t.prototype,"NameLabel",void 0),i([l(cc.Label)],t.prototype,"ScoreLabel",void 0),i([l(cc.Sprite)],t.prototype,"VictoryCharacter",void 0),i([l(cc.Button)],t.prototype,"BackButton",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],MultiGameWait:[function(e,t,o){"use strict";cc._RF.push(t,"012c28XmmBC+IePFsvpf6TO","MultiGameWait");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.multiStartButton=null,t.backButton=null,t}return n(t,e),t.prototype.onLoad=function(){cc.debug.setDisplayStats(!1)},t.prototype.start=function(){this.multiStartButton&&this.registerButtonEvents(this.multiStartButton,function(){cc.director.loadScene("PlayerConnect")}),this.backButton&&this.registerButtonEvents(this.backButton,this.onClickMain.bind(this))},t.prototype.registerButtonEvents=function(e,t){e.on(cc.Node.EventType.TOUCH_END,t),e.on(cc.Node.EventType.MOUSE_DOWN,t)},t.prototype.onClickMain=function(){cc.log("\ub4a4\ub85c\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad\ub428. MainMenu \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("MainScene")},i([a(cc.Node)],t.prototype,"multiStartButton",void 0),i([a(cc.Node)],t.prototype,"backButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MultiGuestViewerRemember:[function(e,t,o){"use strict";cc._RF.push(t,"a1cb9kLTRJIoL95r2uVcYec","MultiGuestViewerRemember");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.redButton=null,t.yellowButton=null,t.greenButton=null,t.blueButton=null,t.frogSprite=null,t.scoreDisplayPrefab=null,t.buttonMap={},t.score=0,t.scoreLabel=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.buttonMap={red:this.redButton.node,yellow:this.yellowButton.node,green:this.greenButton.node,blue:this.blueButton.node},this.initScoreDisplay(),cc.director.on("sequence-generated",function(t){e.showBlinkSequence(t.sequence)}),cc.director.on("user-input",function(t){e.showClickFeedback(t.color)}),cc.director.on("input-result",function(t){e.updateFrogState(t.correct?"smile":"cry")}),cc.director.on("score-update",function(t){e.setScore(t.score)})},t.prototype.initScoreDisplay=function(){if(this.scoreDisplayPrefab){var e=cc.instantiate(this.scoreDisplayPrefab);this.node.addChild(e),this.scoreLabel=e.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScoreLabel()}},t.prototype.updateScoreLabel=function(){this.scoreLabel&&(this.scoreLabel.string=""+this.score)},t.prototype.setScore=function(e){this.score=e,this.updateScoreLabel()},t.prototype.showBlinkSequence=function(e){var t=this;Object.values(this.buttonMap).forEach(function(e){e.opacity=100});var o=0;e.forEach(function(e){var r=t.buttonMap[e];r&&(t.scheduleOnce(function(){t.blinkButton(r)},o),o+=1)}),this.scheduleOnce(function(){Object.values(t.buttonMap).forEach(function(e){e.opacity=255})},o)},t.prototype.blinkButton=function(e){var t=e.scale;e.opacity=100,cc.tween(e).to(.15,{scale:1.05*t,opacity:255},{easing:"quadOut"}).to(.15,{scale:t,opacity:100},{easing:"quadIn"}).start()},t.prototype.showClickFeedback=function(e){var t=this.buttonMap[e];if(t){var o=t.scale,r=t.opacity||100;cc.tween(t).to(.1,{scale:.9*o,opacity:180},{easing:"quadIn"}).to(.1,{scale:o,opacity:r},{easing:"quadOut"}).start()}},t.prototype.updateFrogState=function(e){var t=this,o={neutral:"\ubb34\ud45c\uc815\uac1c\uad74",smile:"\uc6c3\ub294\uac1c\uad74",cry:"\uc6b0\ub294\uac1c\uad74"}[e],r={neutral:{width:200,height:200},smile:{width:200,height:250},cry:{width:300,height:300}}[e];cc.resources.load("Images/Sim/"+o,cc.SpriteFrame,function(e,n){e?console.error("\uac1c\uad6c\ub9ac \uc774\ubbf8\uc9c0 \ub85c\ub4dc \uc2e4\ud328: "+o,e):(t.frogSprite.spriteFrame=n,t.frogSprite.type=cc.Sprite.Type.SIMPLE,t.frogSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.frogSprite.node.setContentSize(r.width,r.height))})},i([a(cc.Button)],t.prototype,"redButton",void 0),i([a(cc.Button)],t.prototype,"yellowButton",void 0),i([a(cc.Button)],t.prototype,"greenButton",void 0),i([a(cc.Button)],t.prototype,"blueButton",void 0),i([a(cc.Sprite)],t.prototype,"frogSprite",void 0),i([a(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MultiGuestViewer:[function(e,t,o){"use strict";cc._RF.push(t,"4a5618Caj1N44TdZMU+UUnD","MultiGuestViewer");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Hole1=null,t.Hole2=null,t.Hole3=null,t.Hole4=null,t.Hole5=null,t.Hole6=null,t.Hole7=null,t.Hole8=null,t.Hole9=null,t.molePrefab=null,t.molePrefabGood=null,t.moleHitSprite=null,t.goodMoleHitSprite=null,t.scoreDisplayPrefab=null,t.holes=[],t.score=0,t.scoreLabel=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.holes=[this.Hole1,this.Hole2,this.Hole3,this.Hole4,this.Hole5,this.Hole6,this.Hole7,this.Hole8,this.Hole9],this.initScore(),cc.director.on("spawn-mole",function(t){e.spawnMoleFromData(t)}),cc.director.on("hit-mole",function(t){e.hitMoleAnimation(t.index,t.moleType)}),cc.director.on("score-update",function(t){e.setScore(t.score)})},t.prototype.initScore=function(){var e=cc.instantiate(this.scoreDisplayPrefab);this.node.addChild(e),this.scoreLabel=e.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScoreLabel()},t.prototype.updateScoreLabel=function(){this.scoreLabel.string=""+this.score},t.prototype.setScore=function(e){this.score=e,this.updateScoreLabel()},t.prototype.spawnMoleFromData=function(e){var t=e.index,o=e.type,r=this.holes[t];if(r){var n=cc.instantiate("good"===o?this.molePrefabGood:this.molePrefab);n.name="OpponentMole",n.setPosition(0,-130),n.active=!0,n.zIndex=9999,r.addChild(n),cc.tween(n).to(.2,{position:cc.v3(0,-20)},{easing:"sineOut"}).delay(1).call(function(){n.isValid&&n.destroy()}).start()}},t.prototype.hitMoleAnimation=function(e,t){var o=this.holes[e].getChildByName("OpponentMole");if(o&&o.isValid){var r=o.getComponent(cc.Sprite);r&&(r.spriteFrame="good"===t?this.goodMoleHitSprite:this.moleHitSprite),cc.tween(o).repeat(3,cc.tween().by(.05,{angle:15}).by(.05,{angle:-30}).by(.05,{angle:15})).start()}},i([a(cc.Node)],t.prototype,"Hole1",void 0),i([a(cc.Node)],t.prototype,"Hole2",void 0),i([a(cc.Node)],t.prototype,"Hole3",void 0),i([a(cc.Node)],t.prototype,"Hole4",void 0),i([a(cc.Node)],t.prototype,"Hole5",void 0),i([a(cc.Node)],t.prototype,"Hole6",void 0),i([a(cc.Node)],t.prototype,"Hole7",void 0),i([a(cc.Node)],t.prototype,"Hole8",void 0),i([a(cc.Node)],t.prototype,"Hole9",void 0),i([a(cc.Prefab)],t.prototype,"molePrefab",void 0),i([a(cc.Prefab)],t.prototype,"molePrefabGood",void 0),i([a(cc.SpriteFrame)],t.prototype,"moleHitSprite",void 0),i([a(cc.SpriteFrame)],t.prototype,"goodMoleHitSprite",void 0),i([a(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],MultiOpponent:[function(e,t,o){"use strict";cc._RF.push(t,"0b9dc7VdBVPZ7loMPli6jdj","MultiOpponent");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function s(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.questionLabel=null,t.sequenceLabel=null,t.scoreDisplayPrefab=null,t.correctSign=null,t.wrongSign=null,t.scoreLabel=null,t.lastQuestionNumbers=[],t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.initScoreUI(),window.socket.on("game-event",function(t){if(t&&t.type)switch(t.type){case"spawn-question":e.showQuestion(t.payload.numbers,t.payload.direction);break;case"answer-result":e.showResult(t.payload.input,t.payload.isCorrect)}}),cc.director.on("score-update",function(t){console.log("[MultiOpponent] score-update \uc218\uc2e0:",t),e.updateScore(t.score)})},t.prototype.initScoreUI=function(){var e=cc.instantiate(this.scoreDisplayPrefab);this.node.addChild(e),this.scoreLabel=e.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScore(0)},t.prototype.showQuestion=function(e,t){var o=this;this.lastQuestionNumbers=e,this.questionLabel.string=e.join(""),this.questionLabel.node.active=!0,this.sequenceLabel.node.active=!1,this.scheduleOnce(function(){o.questionLabel.node.active=!1,o.sequenceLabel.string="reverse"===t?"\uc5ed\ubc29\ud5a5":"\uc815\ubc29\ud5a5",o.sequenceLabel.node.active=!0},1.5)},t.prototype.showResult=function(e,t){return c(this,void 0,void 0,function(){var o;return s(this,function(r){switch(r.label){case 0:return o=t?this.correctSign:this.wrongSign,this.sequenceLabel.node.active=!1,this.questionLabel.node.active=!1,this.questionLabel.string=e.join(" "),this.questionLabel.node.active=!0,o.active=!0,[4,(1500,new Promise(function(e){return setTimeout(e,1500)}))];case 1:return r.sent(),o.active=!1,this.questionLabel.string===e.join(" ")&&(this.questionLabel.node.active=!1),[2]}})})},t.prototype.updateScore=function(e){this.scoreLabel&&(this.scoreLabel.string=""+e)},i([u(cc.Label)],t.prototype,"questionLabel",void 0),i([u(cc.Label)],t.prototype,"sequenceLabel",void 0),i([u(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([u(cc.Node)],t.prototype,"correctSign",void 0),i([u(cc.Node)],t.prototype,"wrongSign",void 0),i([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{}],MultiPlayConnect:[function(e,t,o){"use strict";cc._RF.push(t,"55b5f5aZTNIaqvFwvNlUyiI","MultiPlayConnect");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function s(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../CommonUI/GameState"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.StartButton=null,t.backButton=null,t.ConnectLinkLabel=null,t.player1Label=null,t.player1CharacterNode=null,t.player2Label=null,t.player2CharacterNode=null,t.CopyButton=null,t.CopyButtonLabel=null,t.roomId="",t.pollingTimer=null,t.isRoomCreating=!1,t}return n(t,e),t.prototype.onLoad=function(){cc.debug.setDisplayStats(!1),this.CopyButton&&(this.CopyButton.node.active=!1)},t.prototype.start=function(){cc.log("MultiPlayConnect start() \uc9c4\uc785"),cc.log("GameState.isHost:",a.default.isHost),this.StartButton&&(this.StartButton.active=a.default.isHost,a.default.isHost?(cc.log("StartButton \ud65c\uc131\ud654 (Host)"),this.registerButtonEvents(this.StartButton,this.createRoomAndShowInviteLink.bind(this))):cc.log("Guest\ub294 StartButton \ube44\ud65c\uc131\ud654"));var e=a.default.nickname||"\ud50c\ub808\uc774\uc5b4",t=a.default.character||"dog";if(a.default.isHost)cc.log("Host UI \uc138\ud305"),this.player1Label&&(this.player1Label.string="\ub2c9\ub124\uc784 : "+e),this.setCharacterSprite(this.player1CharacterNode,t),a.default.createdRoomId&&(this.roomId=a.default.createdRoomId,this.listenForGuestUpdate());else{cc.log("Guest UI \uc138\ud305"),this.player2Label&&(this.player2Label.string="\ub2c9\ub124\uc784 : "+e),this.setCharacterSprite(this.player2CharacterNode,t);var o=a.default.incomingRoomId;o&&(this.roomId=o,cc.log("Guest \ubc29 \uc785\uc7a5 \uc694\uccad:",this.roomId),this.joinRoomAsGuest())}},t.prototype.registerButtonEvents=function(e,t){e.off(cc.Node.EventType.TOUCH_END),e.on(cc.Node.EventType.TOUCH_END,t)},t.prototype.createRoomAndShowInviteLink=function(){return c(this,void 0,void 0,function(){var e,t,o,r=this;return s(this,function(n){switch(n.label){case 0:if(!a.default.isHost)return cc.warn("Guest\ub294 \ubc29\uc744 \uc0dd\uc131\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),[2];if(this.isRoomCreating)return[2];if(this.isRoomCreating=!0,cc.log("createRoomAndShowInviteLink \uc2e4\ud589\ub428"),!(e=localStorage.getItem("jwtToken")))return cc.warn("JWT \ud1a0\ud070 \uc5c6\uc74c"),this.isRoomCreating=!1,[2];n.label=1;case 1:return n.trys.push([1,4,5,6]),[4,fetch("https://smartzoo.shop/multi/room/create-room",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({selectedGameId:"MultiMoleGameScene"})})];case 2:return[4,n.sent().json()];case 3:return t=n.sent(),cc.log("\uc11c\ubc84 \uc751\ub2f5:",t),t.success&&(this.roomId=t.roomId,a.default.createdRoomId=this.roomId,this.ConnectLinkLabel&&(this.ConnectLinkLabel.string=t.inviteUrl),this.CopyButton&&(this.CopyButton.node.active=!0,this.CopyButton.node.off(cc.Node.EventType.TOUCH_END),this.CopyButton.node.on(cc.Node.EventType.TOUCH_END,function(){navigator.clipboard?navigator.clipboard.writeText(t.inviteUrl).then(function(){cc.log("\ucd08\ub300 \ub9c1\ud06c \ubcf5\uc0ac \uc644\ub8cc"),r.CopyButtonLabel&&(r.CopyButtonLabel.string="\ubcf5\uc0ac \uc131\uacf5",r.scheduleOnce(function(){r.CopyButtonLabel&&(r.CopyButtonLabel.string="\ubcf5\uc0ac")},1.5))}).catch(function(){return cc.warn("\ubcf5\uc0ac \uc2e4\ud328")}):cc.warn("\uc774 \ube0c\ub77c\uc6b0\uc800\ub294 \ud074\ub9bd\ubcf4\ub4dc \ubcf5\uc0ac\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")})),cc.log("\uc0dd\uc131\ub41c \ubc29 \ucf54\ub4dc: "+this.roomId),cc.log("\ucd08\ub300 \ub9c1\ud06c: "+t.inviteUrl),this.listenForGuestUpdate()),[3,6];case 4:return o=n.sent(),cc.log("\uc11c\ubc84 \uc694\uccad \uc2e4\ud328:",o.message),[3,6];case 5:return this.isRoomCreating=!1,[7];case 6:return[2]}})})},t.prototype.listenForGuestUpdate=function(){var e=this;this.checkGuestUpdate(),this.pollingTimer=setInterval(function(){return e.checkGuestUpdate()},3e3)},t.prototype.checkGuestUpdate=function(){return c(this,void 0,void 0,function(){var e,t,o,r;return s(this,function(n){switch(n.label){case 0:if(!this.roomId)return cc.warn("roomId \uc5c6\uc74c. polling \uc911\ub2e8\ub428"),[2];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch("https://smartzoo.shop/multi/room/room-status/"+this.roomId)];case 2:return[4,n.sent().json()];case 3:return e=n.sent(),cc.log("\uc11c\ubc84 \uc751\ub2f5:",e),e.success&&e.data?(t=e.data,cc.log("\ud604\uc7ac status:",t.status),a.default.isHost?(t.guestNickname&&t.guestCharacter&&(a.default.guestNickname=t.guestNickname,a.default.guestCharacter=t.guestCharacter,this.player2Label&&(this.player2Label.string="\ub2c9\ub124\uc784 : "+t.guestNickname),this.setCharacterSprite(this.player2CharacterNode,t.guestCharacter)),"ready"===t.status&&this.StartButton&&(cc.log("\ubaa8\ub4e0 \uc778\uc6d0 \uc785\uc7a5 \uc644\ub8cc. \uac8c\uc784 \uc2dc\uc791 \uac00\ub2a5"),(o=this.StartButton.getComponentInChildren(cc.Label))&&(o.string="\uac8c\uc784 \uc2dc\uc791 !"),this.StartButton.off(cc.Node.EventType.TOUCH_END),this.StartButton.off(cc.Node.EventType.MOUSE_DOWN),this.registerButtonEvents(this.StartButton,this.startGameList.bind(this)))):(t.hostNickname&&t.hostCharacter&&(a.default.hostNickname=t.hostNickname,a.default.hostCharacter=t.hostCharacter,this.player1Label&&(this.player1Label.string="\ub2c9\ub124\uc784 : "+t.hostNickname),this.setCharacterSprite(this.player1CharacterNode,t.hostCharacter)),"started"===t.status&&(cc.log("Host\uac00 \uac8c\uc784 \uc2dc\uc791 \u2192 Guest\ub3c4 MultiGameList \uc774\ub3d9"),cc.director.loadScene("MultiGameList"))),[3,5]):(cc.warn("[checkGuestUpdate] \ubc29\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uac70\ub098 \uc5d0\ub7ec:",e.message),this.handleRoomJoinFail(),[2]);case 4:return r=n.sent(),cc.error("[checkGuestUpdate] \ubc29 \uc0c1\ud0dc \ud655\uc778 \uc2e4\ud328(\ub124\ud2b8\uc6cc\ud06c/\uc0ad\uc81c):",r.message),this.handleRoomJoinFail(),[3,5];case 5:return[2]}})})},t.prototype.handleRoomJoinFail=function(){a.default.resetMultiplay(),a.default.incomingRoomId="",cc.sys.localStorage.removeItem("isHost"),localStorage.removeItem("pendingRoomId"),cc.director.loadScene("MainScene")},t.prototype.setCharacterSprite=function(e,t){var o=e.getComponent(cc.Sprite);if(o){["dog","rabbit","tiger"].includes(t)||(t="dog");var r="Images/Common/characters/"+t;cc.resources.load(r,cc.SpriteFrame,function(e,t){!e&&t&&(o.spriteFrame=t)})}},t.prototype.joinRoomAsGuest=function(){return c(this,void 0,void 0,function(){var e,t,o,r;return s(this,function(n){switch(n.label){case 0:if(!(e=localStorage.getItem("jwtToken")))return this.handleRoomJoinFail(),[2];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch("https://smartzoo.shop/multi/room/join-room/"+this.roomId,{method:"POST",headers:{Authorization:"Bearer "+e}})];case 2:return(t=n.sent()).ok?[4,t.json()]:(cc.warn("[joinRoomAsGuest] \uc11c\ubc84 \uc751\ub2f5 \uc624\ub958:",t.status,t.statusText),this.handleRoomJoinFail(),[2]);case 3:return(o=n.sent()).success?this.listenForGuestUpdate():(cc.warn("[joinRoomAsGuest] \uc11c\ubc84 \uc751\ub2f5 \uc2e4\ud328:",o.message),this.handleRoomJoinFail()),[3,5];case 4:return r=n.sent(),cc.error("[joinRoomAsGuest] \ub124\ud2b8\uc6cc\ud06c/\uc608\uc678:",r.message),this.handleRoomJoinFail(),[3,5];case 5:return[2]}})})},t.prototype.onDestroy=function(){this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null)},t.prototype.onClickMain=function(){var e=a.default.createdRoomId||a.default.incomingRoomId,t=a.default.browserId;window.socket&&e&&t&&window.socket.emit("leave-room",{roomId:e,playerId:t}),a.default.resetMultiplay(),a.default.incomingRoomId="",cc.sys.localStorage.removeItem("isHost"),localStorage.removeItem("pendingRoomId"),cc.director.loadScene("MainScene")},t.prototype.startGameList=function(){return c(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:cc.log("Host \uac8c\uc784 \uc2dc\uc791 \ubc84\ud2bc \ud074\ub9ad\ub428"),a.default.isHost=!0,cc.sys.localStorage.setItem("isHost","true"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,fetch("https://smartzoo.shop/multi/room/start-game/"+this.roomId,{method:"POST"})];case 2:return t.sent(),this.pollingTimer&&(clearInterval(this.pollingTimer),this.pollingTimer=null),cc.director.loadScene("MultiGameList"),[3,4];case 3:return e=t.sent(),cc.error("start-game API \uc2e4\ud328:",e.message),[3,4];case 4:return[2]}})})},i([p(cc.Node)],t.prototype,"StartButton",void 0),i([p(cc.Node)],t.prototype,"backButton",void 0),i([p(cc.Label)],t.prototype,"ConnectLinkLabel",void 0),i([p(cc.Label)],t.prototype,"player1Label",void 0),i([p(cc.Node)],t.prototype,"player1CharacterNode",void 0),i([p(cc.Label)],t.prototype,"player2Label",void 0),i([p(cc.Node)],t.prototype,"player2CharacterNode",void 0),i([p(cc.Button)],t.prototype,"CopyButton",void 0),i([p(cc.Label)],t.prototype,"CopyButtonLabel",void 0),i([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],MultiPlayerRememberGame:[function(e,t,o){"use strict";cc._RF.push(t,"8a916iwh+ZFCIdZX3MA2v9N","MultiPlayerRememberGame");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../Controller/CommonUI/GameState"),a=e("../../Controller/Multi/MultiFlowController"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startButton=null,t.redButton=null,t.yellowButton=null,t.greenButton=null,t.blueButton=null,t.frogSprite=null,t.gameStartOverlayPrefab=null,t.gameOverUIPrefab=null,t.scoreUIPrefab=null,t.timerUIPrefab=null,t.scoreLabel=null,t.timerLabel=null,t.colorSequence=[],t.userInput=[],t.score=0,t.level=1,t.isGameActive=!1,t.isGameOver=!1,t.remainingTime=0,t.buttonMap={},t.colors=["red","yellow","green","blue"],t}return n(t,e),t.prototype.onLoad=function(){var e=this;if(s.default.lastGameScene=cc.director.getScene().name,cc.director.on("multi-game-start",function(){e.beginGame()}),this.scoreUIPrefab){var t=cc.instantiate(this.scoreUIPrefab);this.node.addChild(t);var o=t.getChildByName("ScoreLabel");o&&(this.scoreLabel=o.getComponent(cc.Label)),this.scoreLabel||console.warn("ScoreLabel \uc5f0\uacb0 \uc2e4\ud328: \ud504\ub9ac\ud339 \uad6c\uc870\ub97c \ud655\uc778\ud558\uc138\uc694.")}if(this.timerUIPrefab){var r=cc.instantiate(this.timerUIPrefab);this.node.addChild(r);var n=r.getChildByName("TimerLabel");n&&(this.timerLabel=n.getComponent(cc.Label)),this.timerLabel||console.warn("TimerLabel \uc5f0\uacb0 \uc2e4\ud328: \ud504\ub9ac\ud339 \uad6c\uc870\ub97c \ud655\uc778\ud558\uc138\uc694.")}cc.debug.setDisplayStats(!1),this.buttonMap={red:this.redButton,yellow:this.yellowButton,green:this.greenButton,blue:this.blueButton},this.startButton.node.on("click",this.onStartGame,this),this.redButton.node.on("click",function(){return e.onColorButtonClick("red")},this),this.yellowButton.node.on("click",function(){return e.onColorButtonClick("yellow")},this),this.greenButton.node.on("click",function(){return e.onColorButtonClick("green")},this),this.blueButton.node.on("click",function(){return e.onColorButtonClick("blue")},this),this.setInitialButtonState(),this.startButton.node.active=!1,this.tickCallback=this.updateTimer.bind(this),this.setFrogState("neutral")},t.prototype.startGame=function(){this.beginGame()},t.prototype.beginGame=function(){var e=this;this.isGameActive||(this.colorSequence=[],this.userInput=[],this.score=0,this.level=1,this.updateScore(),this.isGameActive=!0,this.setFrogState("neutral"),this.startTimer(),this.scheduleOnce(function(){e.generateColorSequence(),e.showColorSequence()},3))},t.prototype.setFrogState=function(e){var t=this,o={neutral:"\ubb34\ud45c\uc815\uac1c\uad74",smile:"\uc6c3\ub294\uac1c\uad74",cry:"\uc6b0\ub294\uac1c\uad74"}[e],r={neutral:{width:200,height:200},smile:{width:200,height:250},cry:{width:300,height:300}}[e];cc.resources.load("Images/Sim/"+o,cc.SpriteFrame,function(e,n){e?console.error("\uac1c\uad6c\ub9ac \uc774\ubbf8\uc9c0 \ub85c\ub4dc \uc2e4\ud328: "+o,e):(t.frogSprite.spriteFrame=n,t.frogSprite.type=cc.Sprite.Type.SIMPLE,t.frogSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.frogSprite.node.setContentSize(r.width,r.height))})},t.prototype.onStartGame=function(){"\ub2e4\uc2dc"===this.startButton.node.getComponentInChildren(cc.Label).string&&(this.userInput=[],this.isGameActive=!0,this.startButton.node.active=!1,this.setFrogState("neutral"),this.generateColorSequence(),this.showColorSequence())},t.prototype.onColorButtonClick=function(e){if(this.isGameActive&&this.buttonMap[e].interactable){var t=this.buttonMap[e],o=t.node.scale,r=t.node.getPosition();cc.tween(t.node).parallel(cc.tween().to(.1,{scale:.85*o},{easing:"quadIn"}),cc.tween().to(.1,{opacity:180}),cc.tween().to(.1,{position:cc.v3(r.x,r.y-5)})).parallel(cc.tween().to(.1,{scale:o},{easing:"quadOut"}),cc.tween().to(.1,{opacity:255}),cc.tween().to(.1,{position:r})).start(),this.userInput.push(e);var n=s.default.createdRoomId||s.default.incomingRoomId;!cc.sys.isNative&&window.socket&&n&&window.socket.emit("game-event",{type:"user-input",roomId:n,payload:{color:e,inputIndex:this.userInput.length-1}}),this.checkUserInput()}},t.prototype.updateTimer=function(){this.remainingTime--,this.timerLabel.string=""+this.remainingTime,this.remainingTime<=0&&(this.unschedule(this.tickCallback),this.onTimeUp())},t.prototype.startTimer=function(){this.unschedule(this.tickCallback),this.remainingTime=60,this.timerLabel.string=""+this.remainingTime,this.timerLabel.node.active=!0,this.schedule(this.tickCallback,1)},t.prototype.onTimeUp=function(){this.isGameActive=!1,this.disableButtons(!0),this.startButton.interactable=!1,this.endGame()},t.prototype.checkUserInput=function(){for(var e=this,t=!0,o=3===this.level?c(this.colorSequence).reverse():this.colorSequence,r=0;r<this.userInput.length;r++)if(this.userInput[r]!==o[r]){t=!1;break}var n=s.default.createdRoomId||s.default.incomingRoomId,i=s.default.isHost?"host":"guest";t&&this.userInput.length===o.length?(this.setFrogState("smile"),this.score+=10,this.updateScore(),!cc.sys.isNative&&window.socket&&n&&window.socket.emit("game-event",{type:"input-result",roomId:n,payload:{correct:!0,level:this.level,player:i}}),!cc.sys.isNative&&window.socket&&n&&window.socket.emit("game-event",{type:"score-update",roomId:n,payload:{player:i,score:this.score}}),!cc.sys.isNative&&window.socket&&n&&window.socket.emit("game-event",{type:"level-up",roomId:n,payload:{newLevel:this.level+1,player:i}}),this.userInput=[],this.level++,this.scheduleOnce(function(){e.generateColorSequence(),e.showColorSequence()},3)):t||(this.setFrogState("cry"),this.userInput=[],this.startButton.node.getComponentInChildren(cc.Label).string="\ub2e4\uc2dc",this.startButton.node.active=!0,this.isGameActive=!1,this.disableButtons(!0),!cc.sys.isNative&&window.socket&&n&&window.socket.emit("game-event",{type:"input-result",roomId:n,payload:{correct:!1,level:this.level,player:i}}))},t.prototype.generateColorSequence=function(){this.colorSequence=[];for(var e=this.level>=5?7:this.level+2,t=0;t<e;t++){var o=Math.floor(Math.random()*this.colors.length);this.colorSequence.push(this.colors[o])}console.log("\uc0dd\uc131\ub41c \uc0c9\uc0c1 \uc21c\uc11c:",this.colorSequence);var r=s.default.createdRoomId||s.default.incomingRoomId;!cc.sys.isNative&&window.socket&&r&&window.socket.emit("game-event",{type:"sequence-generated",roomId:r,payload:{level:this.level,sequence:this.colorSequence.slice()}})},t.prototype.setInitialButtonState=function(){Object.values(this.buttonMap).forEach(function(e){e.node.opacity=100,e.interactable=!1})},t.prototype.showColorSequence=function(){var e=this;this.setFrogState("neutral"),this.setInitialButtonState();var t=0;this.colorSequence.forEach(function(o){var r=e.buttonMap[o];e.scheduleOnce(function(){return e.activateButtonForBlink(r)},t),t+=1}),this.scheduleOnce(function(){e.enableAnswerInput()},t)},t.prototype.activateButtonForBlink=function(e){var t=e.node.scale;e.node.opacity=100,e.interactable=!1,cc.tween(e.node).to(.15,{opacity:255,scale:1.05*t},{easing:"quadOut"}).to(.15,{opacity:100,scale:t},{easing:"quadIn"}).start()},t.prototype.enableAnswerInput=function(){Object.values(this.buttonMap).forEach(function(e){var t=e.node.getChildByName("Background");t&&e.node.setContentSize(t.getContentSize()),e.node.opacity=255,e.interactable=!0,console.log(e.node.name+" size:",e.node.width,e.node.height)})},t.prototype.updateScore=function(){this.scoreLabel&&(this.scoreLabel.string=""+this.score)},t.prototype.disableButtons=function(e){Object.values(this.buttonMap).forEach(function(t){t.interactable=!e})},t.prototype.endGame=function(){a.default.endGame(this)},i([p(cc.Button)],t.prototype,"startButton",void 0),i([p(cc.Button)],t.prototype,"redButton",void 0),i([p(cc.Button)],t.prototype,"yellowButton",void 0),i([p(cc.Button)],t.prototype,"greenButton",void 0),i([p(cc.Button)],t.prototype,"blueButton",void 0),i([p(cc.Sprite)],t.prototype,"frogSprite",void 0),i([p(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([p(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([p(cc.Prefab)],t.prototype,"scoreUIPrefab",void 0),i([p(cc.Prefab)],t.prototype,"timerUIPrefab",void 0),i([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","../../Controller/Multi/MultiFlowController":"MultiFlowController"}],MultiReversecorrectGameController:[function(e,t,o){"use strict";cc._RF.push(t,"434e5TEHZNAmLNPx69T1Tev","MultiReversecorrectGameController");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./Multiplayer"),s=e("./MultiOpponent"),a=e("../../Controller/CommonUI/GameState"),l=e("../../Controller/Multi/MultiFlowController"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myGameArea=null,t.opponentGameArea=null,t.exitButton=null,t.myNameLabel=null,t.myCharacterNode=null,t.guestNameLabel=null,t.guestCharacterNode=null,t.myGame=null,t.opponent=null,t}return n(t,e),t.prototype.start=function(){this.exitButton&&this.exitButton.on(cc.Node.EventType.TOUCH_END,this.loadMain,this),this.setPlayerInfoFromGameState()},t.prototype.onLoad=function(){var e=this;if(this.myGame=this.myGameArea.getComponent(c.default),this.opponent=this.opponentGameArea.getComponent(s.default),l.default.initializeSocketListeners(),console.log("[DEBUG] initializeSocketListeners \ud638\ucd9c\ub428"),cc.director.on("spawn-question",function(t){e.opponent.showQuestion(t.numbers,t.direction)}),cc.director.on("answer-result",function(t){e.opponent.showResult(t.input,t.isCorrect)}),cc.director.on("score-update",function(t){var o=a.default.isHost;(o&&"guest"===t.player||!o&&"host"===t.player)&&e.opponent.updateScore(t.score)}),!a.default.isHost){var t=a.default.createdRoomId||a.default.incomingRoomId;window.socket.emit("game-event",{type:"guest-ready",roomId:t,payload:{}})}this.myGame.startGame()},t.prototype.setPlayerInfoFromGameState=function(){var e=a.default.isHost,t=a.default.nickname||"\ub098",o=a.default.character||"dog",r=a.default.guestNickname||"\uac8c\uc2a4\ud2b8",n=a.default.guestCharacter||"rabbit",i=a.default.hostNickname||"\ud638\uc2a4\ud2b8",c=a.default.hostCharacter||"tiger";console.log("[DEBUG] \ub0b4 \uce90\ub9ad\ud130 \ud0a4:",o),console.log("[DEBUG] \uc0c1\ub300 \uce90\ub9ad\ud130 \ud0a4:",n),e?(this.myNameLabel&&(this.myNameLabel.string=t),this.guestNameLabel&&(this.guestNameLabel.string=r),this.setCharacterSprite(this.myCharacterNode,o),this.setCharacterSprite(this.guestCharacterNode,n)):(this.myNameLabel&&(this.myNameLabel.string=t),this.guestNameLabel&&(this.guestNameLabel.string=i),this.setCharacterSprite(this.myCharacterNode,o),this.setCharacterSprite(this.guestCharacterNode,c))},t.prototype.setCharacterSprite=function(e,t){var o=e.getComponent(cc.Sprite);if(o){var r="Images/Common/characters/"+t+"Head";cc.resources.load(r,cc.SpriteFrame,function(e,t){console.log("[DEBUG] \uacbd\ub85c: "+r),console.log("[DEBUG] \ub85c\ub4dc \uc5d0\ub7ec:",e),console.log("[DEBUG] \ub85c\ub4dc\ub41c spriteFrame:",t),!e&&t&&(o.spriteFrame=t)})}else console.log("[DEBUG] \uc2a4\ud504\ub77c\uc774\ud2b8 \ucef4\ud3ec\ub10c\ud2b8 \uc5c6\uc74c:",e.name)},t.prototype.loadMain=function(){var e=a.default.incomingRoomId||a.default.createdRoomId,t=a.default.browserId;!cc.sys.isNative&&window.socket&&e&&t&&(console.log("[MMGC] 'leave-room' emit \u2192",{roomId:e,playerId:t}),window.socket.emit("leave-room",{roomId:e,playerId:t})),a.default.resetMultiplay(),cc.sys.localStorage.removeItem("isHost"),cc.director.loadScene("MainScene")},t.prototype.onDestroy=function(){cc.director.off("spawn-question"),cc.director.off("answer-result"),cc.director.off("score-update")},i([h(cc.Node)],t.prototype,"myGameArea",void 0),i([h(cc.Node)],t.prototype,"opponentGameArea",void 0),i([h(cc.Node)],t.prototype,"exitButton",void 0),i([h(cc.Label)],t.prototype,"myNameLabel",void 0),i([h(cc.Node)],t.prototype,"myCharacterNode",void 0),i([h(cc.Label)],t.prototype,"guestNameLabel",void 0),i([h(cc.Node)],t.prototype,"guestCharacterNode",void 0),i([p],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","../../Controller/Multi/MultiFlowController":"MultiFlowController","./MultiOpponent":"MultiOpponent","./Multiplayer":"Multiplayer"}],MultiplayerGameScene:[function(e,t,o){"use strict";cc._RF.push(t,"f09f8mp3lBBQYiP3QFem2cx","MultiplayerGameScene");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../../Controller/CommonUI/GameState"),s=e("../../Controller/Multi/MultiFlowController"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Hole1=null,t.Hole2=null,t.Hole3=null,t.Hole4=null,t.Hole5=null,t.Hole6=null,t.Hole7=null,t.Hole8=null,t.Hole9=null,t.molePrefab=null,t.molePrefabGood=null,t.moleHitSprite=null,t.goodMoleHitSprite=null,t.hammerSprite=null,t.timerDisplayPrefab=null,t.scoreDisplayPrefab=null,t.moleHoles=[],t.holeStates=[],t.hammerNode=null,t.timerNode=null,t.scoreNode=null,t.timerLabel=null,t.scoreLabel=null,t.score=0,t.timer=60,t.isGameOver=!1,t.moleSpawnCallback=null,t}return n(t,e),t.prototype.startGame=function(){this.initGame()},t.prototype.initGame=function(){this.moleHoles=[this.Hole1,this.Hole2,this.Hole3,this.Hole4,this.Hole5,this.Hole6,this.Hole7,this.Hole8,this.Hole9],this.holeStates=new Array(9).fill(!1),this.score=0,this.timer=60,this.isGameOver=!1,this.createHammer(),this.initTimer(),this.initScore(),this.schedule(this.decreaseTimer,1),this.spawnMoles()},t.prototype.createHammer=function(){this.hammerNode=new cc.Node("Hammer"),this.hammerNode.addComponent(cc.Sprite).spriteFrame=this.hammerSprite,this.hammerNode.parent=this.node,this.hammerNode.zIndex=999,this.hammerNode.setContentSize(200,200),this.hammerNode.anchorX=.2,this.hammerNode.anchorY=.2,this.hammerNode.active=!1},t.prototype.initTimer=function(){this.timerNode=cc.instantiate(this.timerDisplayPrefab),this.node.addChild(this.timerNode),this.timerLabel=this.timerNode.getChildByName("TimerLabel").getComponent(cc.Label),this.updateTimerLabel()},t.prototype.initScore=function(){this.scoreNode=cc.instantiate(this.scoreDisplayPrefab),this.node.addChild(this.scoreNode),this.scoreLabel=this.scoreNode.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScoreLabel()},t.prototype.updateTimerLabel=function(){this.timerLabel.string=""+this.timer},t.prototype.updateScoreLabel=function(){this.scoreLabel.string=""+this.score},t.prototype.decreaseTimer=function(){this.isGameOver||(this.timer--,this.updateTimerLabel(),this.timer<=0&&this.endGame())},t.prototype.spawnMoles=function(){var e=this;this.moleSpawnCallback&&this.unschedule(this.moleSpawnCallback),this.moleSpawnCallback=function(){if(!e.isGameOver){var t=e.holeStates.map(function(e,t){return e?-1:t}).filter(function(e){return-1!==e});if(0!==t.length){var o=t[Math.floor(Math.random()*t.length)],r=e.moleHoles[o],n=Math.random()<.3,i=cc.instantiate(n?e.molePrefabGood:e.molePrefab);i.name="Mole",r.addChild(i),i.setPosition(0,-130),i.active=!0,e.holeStates[o]=!0,i.on(cc.Node.EventType.TOUCH_END,function(t){if(t.stopPropagation(),i.active&&!e.isGameOver){var r=i.convertToWorldSpaceAR(cc.v2(0,0)),s=e.node.convertToNodeSpaceAR(r);e.showHammerEffect(s);var a=i.getComponent(cc.Sprite);a&&(a.spriteFrame=n?e.goodMoleHitSprite:e.moleHitSprite),e.score+=n?-10:10,e.updateScoreLabel();var l=c.default.createdRoomId||c.default.incomingRoomId;!cc.sys.isNative&&window.socket&&l&&(window.socket.emit("game-event",{type:"hit-mole",roomId:l,payload:{index:o,moleType:n?"good":"bad"}}),window.socket.emit("game-event",{type:"score-update",roomId:l,payload:{player:c.default.isHost?"host":"guest",score:e.score}})),i.off(cc.Node.EventType.TOUCH_END,null,e),cc.tween(i).repeat(3,cc.tween().by(.05,{angle:15}).by(.05,{angle:-30}).by(.05,{angle:15})).delay(.8).call(function(){i&&i.isValid&&(i.destroy(),e.holeStates[o]=!1)}).start()}},e),cc.tween(i).to(.2,{position:cc.v3(0,-20)},{easing:"sineOut"}).delay(1).call(function(){i.isValid&&(i.off(cc.Node.EventType.TOUCH_END,null,e),i.destroy(),e.holeStates[o]=!1)}).start();var s=c.default.createdRoomId||c.default.incomingRoomId;!cc.sys.isNative&&window.socket&&s&&window.socket.emit("game-event",{type:"spawn-mole",roomId:s,payload:{index:o,type:n?"good":"bad",spawnTime:Date.now()}})}}},this.schedule(this.moleSpawnCallback,1,cc.macro.REPEAT_FOREVER)},t.prototype.showHammerEffect=function(e){var t=this;this.hammerNode.setPosition(e),this.hammerNode.active=!0,cc.tween(this.hammerNode).set({scale:1}).parallel(cc.tween().to(.05,{scale:1.2},{easing:"cubicOut"}),cc.tween().by(.05,{position:cc.v3(0,-30)})).parallel(cc.tween().to(.1,{scale:1},{easing:"bounceOut"}),cc.tween().by(.1,{position:cc.v3(0,30)})).call(function(){t.hammerNode.active=!1}).start()},t.prototype.endGame=function(){s.default.endGame(this)},i([u(cc.Node)],t.prototype,"Hole1",void 0),i([u(cc.Node)],t.prototype,"Hole2",void 0),i([u(cc.Node)],t.prototype,"Hole3",void 0),i([u(cc.Node)],t.prototype,"Hole4",void 0),i([u(cc.Node)],t.prototype,"Hole5",void 0),i([u(cc.Node)],t.prototype,"Hole6",void 0),i([u(cc.Node)],t.prototype,"Hole7",void 0),i([u(cc.Node)],t.prototype,"Hole8",void 0),i([u(cc.Node)],t.prototype,"Hole9",void 0),i([u(cc.Prefab)],t.prototype,"molePrefab",void 0),i([u(cc.Prefab)],t.prototype,"molePrefabGood",void 0),i([u(cc.SpriteFrame)],t.prototype,"moleHitSprite",void 0),i([u(cc.SpriteFrame)],t.prototype,"goodMoleHitSprite",void 0),i([u(cc.SpriteFrame)],t.prototype,"hammerSprite",void 0),i([u(cc.Prefab)],t.prototype,"timerDisplayPrefab",void 0),i([u(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","../../Controller/Multi/MultiFlowController":"MultiFlowController"}],MultiplayerMemoryGameController:[function(e,t,o){"use strict";cc._RF.push(t,"66f6eU5fSFIRLYqs1besI9R","MultiplayerMemoryGameController");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./MultiPlayerRememberGame"),s=e("./MultiGuestViewerRemember"),a=e("../../Controller/CommonUI/GameState"),l=e("../../Controller/Multi/MultiFlowController"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myGameArea=null,t.opponentGameArea=null,t.exitButton=null,t.myNameLabel=null,t.myCharacterNode=null,t.guestNameLabel=null,t.guestCharacterNode=null,t.loadingPopupPrefab=null,t.myGameCtrl=null,t.opponentView=null,t._alreadyStarted=!1,t.loadingNode=null,t}return n(t,e),t.prototype.start=function(){var e=this;if(this.loadingPopupPrefab){this.loadingNode=cc.instantiate(this.loadingPopupPrefab);var t=cc.find("Canvas");t?(this.loadingNode.zIndex=9999,t.addChild(this.loadingNode),this.loadingNode.setPosition(cc.v2(0,0))):this.node.addChild(this.loadingNode)}if(this.scheduleOnce(function(){e.loadingNode&&e.loadingNode.isValid&&(e.loadingNode.destroy(),e.loadingNode=null)},2),!this._alreadyStarted){this._alreadyStarted=!0,l.default.initializeSocketListeners();var o=cc.sys.localStorage.getItem("isHost");a.default.isHost="true"===o,this.myGameCtrl=this.myGameArea?this.myGameArea.getComponent(c.default):null,this.myGameArea||cc.error("[MMemGC] \uc5d0\ub7ec: myGameArea \ud504\ub85c\ud37c\ud2f0\uac00 \ubc18\ub4dc\uc2dc Inspector\uc5d0\uc11c \uc5f0\uacb0\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."),this.myGameCtrl||cc.error("[MMemGC] \uc5d0\ub7ec: myGameArea \ub178\ub4dc\uc5d0 GameController \ucef4\ud3ec\ub10c\ud2b8\uac00 \ubd99\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694."),this.opponentView=this.opponentGameArea?this.opponentGameArea.getComponent(s.default):null,this.opponentGameArea||cc.error("[MMemGC] \uc5d0\ub7ec: opponentGameArea \ud504\ub85c\ud37c\ud2f0\uac00 \ubc18\ub4dc\uc2dc Inspector\uc5d0\uc11c \uc5f0\uacb0\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."),this.opponentView||cc.error("[MMemGC] \uc5d0\ub7ec: opponentGameArea \ub178\ub4dc\uc5d0 OpponentMemoryViewer \ucef4\ud3ec\ub10c\ud2b8\uac00 \ubd99\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694."),this.setPlayerInfoFromGameState(),cc.director.on("sequence-generated",function(t){e.opponentView&&e.opponentView.showBlinkSequence(t.sequence)}),cc.director.on("user-input",function(t){e.opponentView&&e.opponentView.showClickFeedback(t.color)}),cc.director.on("input-result",function(t){e.opponentView&&e.opponentView.updateFrogState(t.correct?"smile":"cry")}),cc.director.on("score-update",function(t){var o,r,n=a.default.isHost;n&&"guest"===t.player?null===(o=e.opponentView)||void 0===o||o.setScore(t.score):n||"host"!==t.player||null===(r=e.opponentView)||void 0===r||r.setScore(t.score)}),cc.director.on("multi-game-start",function(){e.myGameCtrl?e.myGameCtrl.beginGame():cc.error("[MMemGC] myGameCtrl\uc774 null\uc774\ub77c beginGame\uc744 \ud638\ucd9c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")}),this.exitButton&&this.exitButton.on(cc.Node.EventType.TOUCH_END,this.loadMain,this)}},t.prototype.setPlayerInfoFromGameState=function(){var e=a.default.isHost,t=a.default.nickname||"\ub098",o=a.default.character||"dog",r=a.default.guestNickname||"\uac8c\uc2a4\ud2b8",n=a.default.guestCharacter||"rabbit",i=a.default.hostNickname||"\ud638\uc2a4\ud2b8",c=a.default.hostCharacter||"tiger";e?(this.myNameLabel&&(this.myNameLabel.string=t),this.guestNameLabel&&(this.guestNameLabel.string=r),this.setCharacterSprite(this.myCharacterNode,o),this.setCharacterSprite(this.guestCharacterNode,n)):(this.myNameLabel&&(this.myNameLabel.string=t),this.guestNameLabel&&(this.guestNameLabel.string=i),this.setCharacterSprite(this.myCharacterNode,o),this.setCharacterSprite(this.guestCharacterNode,c))},t.prototype.setCharacterSprite=function(e,t){var o=e.getComponent(cc.Sprite);if(o){var r="Images/Common/characters/"+t+"Head";cc.resources.load(r,cc.SpriteFrame,function(e,t){!e&&t&&(o.spriteFrame=t)})}},t.prototype.loadMain=function(){var e=a.default.incomingRoomId||a.default.createdRoomId,t=a.default.browserId;!cc.sys.isNative&&window.socket&&e&&t&&window.socket.emit("leave-room",{roomId:e,playerId:t}),a.default.resetMultiplay(),cc.sys.localStorage.removeItem("isHost"),cc.director.loadScene("MainScene")},i([h(cc.Node)],t.prototype,"myGameArea",void 0),i([h(cc.Node)],t.prototype,"opponentGameArea",void 0),i([h(cc.Node)],t.prototype,"exitButton",void 0),i([h(cc.Label)],t.prototype,"myNameLabel",void 0),i([h(cc.Node)],t.prototype,"myCharacterNode",void 0),i([h(cc.Label)],t.prototype,"guestNameLabel",void 0),i([h(cc.Node)],t.prototype,"guestCharacterNode",void 0),i([h(cc.Prefab)],t.prototype,"loadingPopupPrefab",void 0),i([p],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","../../Controller/Multi/MultiFlowController":"MultiFlowController","./MultiGuestViewerRemember":"MultiGuestViewerRemember","./MultiPlayerRememberGame":"MultiPlayerRememberGame"}],MultiplayerMoleGameController:[function(e,t,o){"use strict";cc._RF.push(t,"1ff7cpA9TFEG7L6+q66EBB4","MultiplayerMoleGameController");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./MultiplayerGameScene"),s=e("./MultiGuestViewer"),a=e("../../Controller/CommonUI/GameState"),l=e("../../Controller/Multi/MultiFlowController"),u=cc._decorator,p=u.ccclass,h=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myGameArea=null,t.opponentGameArea=null,t.exitButton=null,t.myNameLabel=null,t.myCharacterNode=null,t.guestNameLabel=null,t.guestCharacterNode=null,t.loadingPopupPrefab=null,t.myGameCtrl=null,t.opponentView=null,t._alreadyStarted=!1,t.loadingNode=null,t}return n(t,e),t.prototype.start=function(){var e=this;if(this.loadingPopupPrefab){this.loadingNode=cc.instantiate(this.loadingPopupPrefab);var t=cc.find("Canvas");t?(this.loadingNode.zIndex=9999,t.addChild(this.loadingNode),this.loadingNode.setPosition(cc.v2(0,0))):this.node.addChild(this.loadingNode)}if(this.scheduleOnce(function(){e.loadingNode&&e.loadingNode.isValid&&(e.loadingNode.destroy(),e.loadingNode=null)},2),console.log("[MMGC] myGameArea \uc5f0\uacb0 \uc0c1\ud0dc:",!!this.myGameArea),console.log("[MMGC] myGameArea\uc5d0 PlayerMoleGameScene\uc774 \ubd99\uc5c8\ub294\uac00:",!(!this.myGameArea||!this.myGameArea.getComponent(c.default))),!this._alreadyStarted){this._alreadyStarted=!0,cc.director.on("multi-game-start",function(){console.log("[MMGC] 'multi-game-start' \uc218\uc2e0 \u2192 myGameCtrl:",e.myGameCtrl),e.myGameCtrl?e.myGameCtrl.startGame():cc.error("[MMGC] myGameCtrl\uc774 null\uc774\ub77c startGame\uc744 \ud638\ucd9c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")}),console.log("[MMGC] 'multi-game-start' \ub9ac\uc2a4\ub108 \ub4f1\ub85d \uc644\ub8cc");var o=cc.sys.localStorage.getItem("isHost");a.default.isHost="true"===o,cc.log("\ubcf5\uc6d0\ub41c isHost \uac12:",a.default.isHost),this.myGameCtrl=this.myGameArea?this.myGameArea.getComponent(c.default):null,console.log("[MMGC] myGameArea \ub178\ub4dc:",this.myGameArea),console.log("[MMGC] \ud560\ub2f9\ub41c myGameCtrl:",this.myGameCtrl),this.myGameArea||cc.error("[MMGC] \uc5d0\ub7ec: myGameArea \ud504\ub85c\ud37c\ud2f0\uac00 \ubc18\ub4dc\uc2dc Inspector\uc5d0\uc11c \uc5f0\uacb0\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."),this.myGameCtrl||cc.error("[MMGC] \uc5d0\ub7ec: myGameArea \ub178\ub4dc\uc5d0 PlayerMoleGameScene \ucef4\ud3ec\ub10c\ud2b8\uac00 \ubd99\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694."),this.opponentView=this.opponentGameArea?this.opponentGameArea.getComponent(s.default):null,console.log("[MMGC] opponentGameArea \ub178\ub4dc:",this.opponentGameArea),console.log("[MMGC] \ud560\ub2f9\ub41c opponentView:",this.opponentView),this.opponentGameArea||cc.error("[MMGC] \uc5d0\ub7ec: opponentGameArea \ud504\ub85c\ud37c\ud2f0\uac00 \ubc18\ub4dc\uc2dc Inspector\uc5d0\uc11c \uc5f0\uacb0\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4."),this.opponentView||cc.error("[MMGC] \uc5d0\ub7ec: opponentGameArea \ub178\ub4dc\uc5d0 OpponentMoleViewer \ucef4\ud3ec\ub10c\ud2b8\uac00 \ubd99\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694."),this.setPlayerInfoFromGameState(),l.default.initializeSocketListeners(),cc.director.on("spawn-mole",function(t){console.log("[MMGC] 'spawn-mole' \uc774\ubca4\ud2b8 \uc218\uc2e0 \u2192",t),e.opponentView&&e.opponentView.spawnMoleFromData(t)}),cc.director.on("hit-mole",function(t){console.log("[MMGC] 'hit-mole' \uc774\ubca4\ud2b8 \uc218\uc2e0 \u2192",t),e.opponentView&&e.opponentView.hitMoleAnimation(t.index,t.moleType)}),cc.director.on("score-update",function(t){var o=a.default.isHost;o&&"guest"===t.player?e.opponentView.setScore(t.score):o||"host"!==t.player||e.opponentView.setScore(t.score)}),this.exitButton&&this.exitButton.on(cc.Node.EventType.TOUCH_END,this.loadMain,this)}},t.prototype.setPlayerInfoFromGameState=function(){var e=a.default.isHost,t=a.default.nickname||"\ub098",o=a.default.character||"dog",r=a.default.guestNickname||"\uac8c\uc2a4\ud2b8",n=a.default.guestCharacter||"rabbit",i=a.default.hostNickname||"\ud638\uc2a4\ud2b8",c=a.default.hostCharacter||"tiger";e?(this.myNameLabel&&(this.myNameLabel.string=t),this.guestNameLabel&&(this.guestNameLabel.string=r),this.setCharacterSprite(this.myCharacterNode,o),this.setCharacterSprite(this.guestCharacterNode,n)):(this.myNameLabel&&(this.myNameLabel.string=t),this.guestNameLabel&&(this.guestNameLabel.string=i),this.setCharacterSprite(this.myCharacterNode,o),this.setCharacterSprite(this.guestCharacterNode,c))},t.prototype.setCharacterSprite=function(e,t){var o=e.getComponent(cc.Sprite);if(o){var r="Images/Common/characters/"+t+"Head";cc.resources.load(r,cc.SpriteFrame,function(e,t){!e&&t&&(o.spriteFrame=t)})}},t.prototype.loadMain=function(){var e=a.default.incomingRoomId||a.default.createdRoomId,t=a.default.browserId;!cc.sys.isNative&&window.socket&&e&&t&&(console.log("[MMGC] 'leave-room' emit \u2192",{roomId:e,playerId:t}),window.socket.emit("leave-room",{roomId:e,playerId:t})),a.default.resetMultiplay(),cc.sys.localStorage.removeItem("isHost"),cc.director.loadScene("MainScene")},i([h(cc.Node)],t.prototype,"myGameArea",void 0),i([h(cc.Node)],t.prototype,"opponentGameArea",void 0),i([h(cc.Node)],t.prototype,"exitButton",void 0),i([h(cc.Label)],t.prototype,"myNameLabel",void 0),i([h(cc.Node)],t.prototype,"myCharacterNode",void 0),i([h(cc.Label)],t.prototype,"guestNameLabel",void 0),i([h(cc.Node)],t.prototype,"guestCharacterNode",void 0),i([h(cc.Prefab)],t.prototype,"loadingPopupPrefab",void 0),i([p],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","../../Controller/Multi/MultiFlowController":"MultiFlowController","./MultiGuestViewer":"MultiGuestViewer","./MultiplayerGameScene":"MultiplayerGameScene"}],Multiplayer:[function(e,t,o){"use strict";cc._RF.push(t,"e0b84fKovhGYYoLlzb6J7OF","Multiplayer");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../Controller/CommonUI/GameState"),a=e("../../Controller/Multi/MultiFlowController"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreDisplayPrefab=null,t.timerDisplayPrefab=null,t.correctSign=null,t.wrongSign=null,t.sequenceLabel=null,t.input_label=null,t.random_label=null,t.layout=null,t.numbersToShow=[],t.userInput=[],t.isReverseMode=!1,t.correctCount=0,t.score=0,t.questionLength=3,t.timer=30,t.scoreLabel=null,t.timerLabel=null,t.inputEnabled=!1,t.isGameOver=!1,t.lastSentQuestion=null,t}return n(t,e),t.prototype.startGame=function(){var e=this;this.initScoreUI(),this.initTimerUI(),this.schedule(this.decreaseTimer,1),this.showNewQuestion(),this.registerButtons(),window.socket.on("game-event",function(t){if("guest-ready"===t.type){var o=s.default.createdRoomId||s.default.incomingRoomId;s.default.isHost&&e.lastSentQuestion&&(console.log("[DEBUG] guest-ready \uc218\uc2e0 \u2192 \ub9c8\uc9c0\ub9c9 \ubb38\uc81c \uc7ac\uc804\uc1a1"),window.socket.emit("game-event",{type:"spawn-question",roomId:o,payload:e.lastSentQuestion}))}})},t.prototype.initScoreUI=function(){var e=cc.instantiate(this.scoreDisplayPrefab);this.node.addChild(e),this.scoreLabel=e.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScoreLabel()},t.prototype.initTimerUI=function(){var e=cc.instantiate(this.timerDisplayPrefab);this.node.addChild(e),this.timerLabel=e.getChildByName("TimerLabel").getComponent(cc.Label),this.updateTimerLabel()},t.prototype.updateScoreLabel=function(){this.scoreLabel&&(this.scoreLabel.string=""+this.score)},t.prototype.updateTimerLabel=function(){this.timerLabel&&(this.timerLabel.string=""+this.timer)},t.prototype.decreaseTimer=function(){--this.timer<0?this.endGame():this.updateTimerLabel()},t.prototype.registerButtons=function(){var e=this;this.layout?this.layout.getComponentsInChildren(cc.Button).forEach(function(t){t.node.on("touchend",e.onButtonClicked,e)}):cc.warn("layout\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.")},t.prototype.onButtonClicked=function(e){if(this.inputEnabled){var t=e.target,o=0;switch(t.name){case"number1":o=1;break;case"number2":o=2;break;case"number3":o=3;break;case"number4":o=4;break;case"number5":o=5;break;case"number6":o=6;break;case"number7":o=7;break;case"number8":o=8;break;case"number9":o=9;break;default:return void console.warn("\uc54c \uc218 \uc5c6\ub294 \ubc84\ud2bc \uc774\ub984:",t.name)}this.userInput.push(o),this.input_label&&(this.input_label.string=this.userInput.join(""));for(var r=this.isReverseMode?c(this.numbersToShow).reverse():this.numbersToShow,n=0;n<this.userInput.length;n++)if(this.userInput[n]!==r[n])return void this.handleWrongAnswer();this.userInput.length===r.length&&this.handleCorrectAnswer()}},t.prototype.handleCorrectAnswer=function(){var e=this;this.inputEnabled=!1,this.correctSign&&(this.correctSign.active=!0),this.correctCount++,this.score+=10,this.updateScoreLabel(),this.sendAnswerResult(!0),this.scheduleOnce(function(){e.correctSign&&(e.correctSign.active=!1),e.showNewQuestion()},1.5)},t.prototype.handleWrongAnswer=function(){var e=this;this.inputEnabled=!1,this.sendAnswerResult(!1),this.wrongSign&&(this.wrongSign.active=!0),this.scheduleOnce(function(){e.wrongSign&&(e.wrongSign.active=!1),e.showNewQuestion()},1.5)},t.prototype.sendAnswerResult=function(e){var t=this.userInput.slice(),o=s.default.createdRoomId||s.default.incomingRoomId;window.socket.emit("game-event",{type:"answer-result",roomId:o,payload:{input:t,isCorrect:e}}),e&&(console.log("\uc810\uc218 emit \ud638\ucd9c"),window.socket.emit("game-event",{type:"score-update",roomId:o,payload:{player:s.default.isHost?"host":"guest",score:this.score}}))},t.prototype.showNewQuestion=function(){var e=this;this.inputEnabled=!1,this.userInput=[],this.input_label&&(this.input_label.string=""),this.isReverseMode=Math.random()<.5;var t=Math.floor(this.correctCount/3);this.questionLength=3+t;var o=Math.max(.8,1.5-.2*t);this.numbersToShow=[];for(var r=[1,2,3,4,5,6,7,8,9],n=0;n<this.questionLength;n++){var i=r[Math.floor(Math.random()*r.length)];this.numbersToShow.push(i)}this.random_label&&(this.random_label.string=this.numbersToShow.join(""),this.random_label.node.active=!0),this.sequenceLabel&&(this.sequenceLabel.node.active=!1,this.sequenceLabel.string=""),this.scheduleOnce(function(){e.random_label&&(e.random_label.node.active=!1),e.sequenceLabel&&(e.sequenceLabel.string=e.isReverseMode?"\uc5ed\ubc29\ud5a5":"\uc815\ubc29\ud5a5",e.sequenceLabel.node.active=!0),e.inputEnabled=!0},o);var c=s.default.createdRoomId||s.default.incomingRoomId;this.lastSentQuestion={numbers:this.numbersToShow,direction:this.isReverseMode?"reverse":"forward"},window.socket.emit("game-event",{type:"spawn-question",roomId:c,payload:this.lastSentQuestion})},t.prototype.endGame=function(){var e=this;a.default.endGame({isGameOver:this.isGameOver,unscheduleAllCallbacks:function(){return e.unscheduleAllCallbacks()},score:this.score})},i([p(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([p(cc.Prefab)],t.prototype,"timerDisplayPrefab",void 0),i([p(cc.Node)],t.prototype,"correctSign",void 0),i([p(cc.Node)],t.prototype,"wrongSign",void 0),i([p(cc.Label)],t.prototype,"sequenceLabel",void 0),i([p(cc.Label)],t.prototype,"input_label",void 0),i([p(cc.Label)],t.prototype,"random_label",void 0),i([p(cc.Node)],t.prototype,"layout",void 0),i([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","../../Controller/Multi/MultiFlowController":"MultiFlowController"}],MyInfoController:[function(e,t,o){"use strict";cc._RF.push(t,"64fcf29UQROYIhgN+e3+F5A","MyInfoController");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("../CommonUI/GameState"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.characterSprite=null,t.nicknameLabel=null,t.deleteAccountButton=null,t}return n(t,e),t.prototype.start=function(){this.nicknameLabel.string=c.default.nickname||"\uc774\ub984 \uc5c6\uc74c",this.setCharacterSprite(this.characterSprite.node,c.default.character)},t.prototype.setCharacterSprite=function(e,t){var o=e.getComponent(cc.Sprite);if(o){["dog","rabbit","tiger"].includes(t)||(t="dog");var r="Images/Common/characters/"+t;cc.resources.load(r,cc.SpriteFrame,function(e,t){!e&&t&&(o.spriteFrame=t)})}},t.prototype.onClickDeleteAccount=function(){localStorage.clear(),c.default.nickname="",c.default.character="",c.default.browserId="",cc.director.loadScene("LoginScene")},i([l(cc.Sprite)],t.prototype,"characterSprite",void 0),i([l(cc.Label)],t.prototype,"nicknameLabel",void 0),i([l(cc.Button)],t.prototype,"deleteAccountButton",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],RememberGameController:[function(e,t,o){"use strict";cc._RF.push(t,"45b47OOq/pH4qjX1/B+5QI+","RememberGameController");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../Controller/CommonUI/GameState"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startButton=null,t.redButton=null,t.yellowButton=null,t.greenButton=null,t.blueButton=null,t.statusLabel=null,t.hintLabel=null,t.exitButton=null,t.frogSprite=null,t.gameStartOverlayPrefab=null,t.gameOverUIPrefab=null,t.scoreUIPrefab=null,t.timerUIPrefab=null,t.scoreLabel=null,t.timerLabel=null,t.colorSequence=[],t.userInput=[],t.score=0,t.level=1,t.isGameActive=!1,t.remainingTime=0,t.buttonMap={},t.colors=["red","yellow","green","blue"],t}return n(t,e),t.prototype.onLoad=function(){var e=this;if(s.default.lastGameScene=cc.director.getScene().name,this.scoreUIPrefab){var t=cc.instantiate(this.scoreUIPrefab);this.node.addChild(t);var o=t.getChildByName("ScoreLabel");o&&(this.scoreLabel=o.getComponent(cc.Label)),this.scoreLabel||console.warn("\u26a0\ufe0f ScoreLabel \uc5f0\uacb0 \uc2e4\ud328: \ud504\ub9ac\ud339 \uad6c\uc870\ub97c \ud655\uc778\ud558\uc138\uc694.")}if(this.timerUIPrefab){var r=cc.instantiate(this.timerUIPrefab);this.node.addChild(r);var n=r.getChildByName("TimerLabel");n&&(this.timerLabel=n.getComponent(cc.Label)),this.timerLabel||console.warn("\u26a0\ufe0f TimerLabel \uc5f0\uacb0 \uc2e4\ud328: \ud504\ub9ac\ud339 \uad6c\uc870\ub97c \ud655\uc778\ud558\uc138\uc694.")}if(this.gameStartOverlayPrefab){var i=cc.instantiate(this.gameStartOverlayPrefab);this.node.addChild(i),i.setPosition(0,0),this.scheduleOnce(function(){e.beginGame()},2)}else this.beginGame();cc.debug.setDisplayStats(!1),this.buttonMap={red:this.redButton,yellow:this.yellowButton,green:this.greenButton,blue:this.blueButton},this.startButton.node.on("click",this.onStartGame,this),this.redButton.node.on("click",function(){return e.onColorButtonClick("red")},this),this.yellowButton.node.on("click",function(){return e.onColorButtonClick("yellow")},this),this.greenButton.node.on("click",function(){return e.onColorButtonClick("green")},this),this.blueButton.node.on("click",function(){return e.onColorButtonClick("blue")},this),this.setInitialButtonState(),this.startButton.node.active=!1,this.tickCallback=this.updateTimer.bind(this),this.setFrogState("neutral"),cc.find("Canvas/yellowButton").on("click",function(){return console.log("yellowButton \ub20c\ub9bc")}),cc.find("Canvas/greenButton").on("click",function(){return console.log("greenButton \ub20c\ub9bc")}),cc.find("Canvas/blueButton").on("click",function(){return console.log("blueButton \ub20c\ub9bc")}),cc.find("Canvas/redButton").on("click",function(){return console.log("redButton \ub20c\ub9bc")})},t.prototype.beginGame=function(){this.isGameActive||(this.colorSequence=[],this.userInput=[],this.score=0,this.level=1,this.updateScore(),this.setStatusMessage("\uac8c\uc784 \uc2dc\uc791!"),this.hintLabel.string="",this.isGameActive=!0,this.setFrogState("neutral"),this.startTimer(),this.generateColorSequence(),this.showColorSequence())},t.prototype.setFrogState=function(e){var t=this,o={neutral:"\ubb34\ud45c\uc815\uac1c\uad74",smile:"\uc6c3\ub294\uac1c\uad74",cry:"\uc6b0\ub294\uac1c\uad74"}[e],r={neutral:{width:450,height:510},smile:{width:450,height:600},cry:{width:600,height:500}}[e];cc.resources.load("Images/Sim/"+o,cc.SpriteFrame,function(e,n){e?console.error("\uac1c\uad6c\ub9ac \uc774\ubbf8\uc9c0 \ub85c\ub4dc \uc2e4\ud328: "+o,e):(t.frogSprite.spriteFrame=n,t.frogSprite.type=cc.Sprite.Type.SIMPLE,t.frogSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.frogSprite.node.setContentSize(r.width,r.height))})},t.prototype.onStartGame=function(){"\ub2e4\uc2dc \ub3c4\uc804"===this.startButton.node.getComponentInChildren(cc.Label).string&&(this.userInput=[],this.setStatusMessage("\ud604\uc7ac \ub2e8\uacc4 \ub2e4\uc2dc \uc2dc\uc791!"),this.hintLabel.string="",this.isGameActive=!0,this.startButton.node.active=!1,this.setFrogState("neutral"),this.generateColorSequence(),this.showColorSequence())},t.prototype.onColorButtonClick=function(e){if(this.isGameActive&&this.buttonMap[e].interactable){var t=this.buttonMap[e],o=t.node.scale,r=t.node.getPosition();cc.tween(t.node).parallel(cc.tween().to(.1,{scale:.85*o},{easing:"quadIn"}),cc.tween().to(.1,{opacity:180}),cc.tween().to(.1,{position:cc.v3(r.x,r.y-5)})).parallel(cc.tween().to(.1,{scale:o},{easing:"quadOut"}),cc.tween().to(.1,{opacity:255}),cc.tween().to(.1,{position:r})).start(),this.userInput.push(e),this.checkUserInput()}},t.prototype.updateTimer=function(){this.remainingTime--,this.timerLabel.string=""+this.remainingTime,this.remainingTime<=0&&(this.unschedule(this.tickCallback),this.onTimeUp())},t.prototype.startTimer=function(){this.unschedule(this.tickCallback),this.remainingTime=60,this.timerLabel.string=""+this.remainingTime,this.timerLabel.node.active=!0,this.schedule(this.tickCallback,1)},t.prototype.onTimeUp=function(){this.isGameActive=!1,this.disableButtons(!0),this.startButton.interactable=!1,s.default.lastGameScene=cc.director.getScene().name,s.default.score=this.score,s.default.gameId="remember-game";var e=cc.instantiate(this.gameOverUIPrefab);this.node.addChild(e),e.setPosition(0,0)},t.prototype.checkUserInput=function(){for(var e=this,t=!0,o=3===this.level?c(this.colorSequence).reverse():this.colorSequence,r=0;r<this.userInput.length;r++)if(this.userInput[r]!==o[r]){t=!1;break}t&&this.userInput.length===o.length?(this.setFrogState("smile"),this.setStatusMessage("\uc815\ub2f5! \ub2e4\uc74c \ub2e8\uacc4\ub85c!"),this.score+=10,this.updateScore(),this.userInput=[],this.level++,this.scheduleOnce(function(){e.generateColorSequence(),e.showColorSequence()},3)):t||(this.setFrogState("cry"),this.setStatusMessage("\ud2c0\ub838\uc2b5\ub2c8\ub2e4! \ub2e4\uc2dc \uc2dc\ub3c4\ud558\uc138\uc694."),this.userInput=[],this.startButton.node.getComponentInChildren(cc.Label).string="\ub2e4\uc2dc \ub3c4\uc804",this.startButton.node.active=!0,this.isGameActive=!1,this.disableButtons(!0))},t.prototype.generateColorSequence=function(){this.colorSequence=[];for(var e=this.level>=5?7:this.level+2,t=0;t<e;t++){var o=Math.floor(Math.random()*this.colors.length);this.colorSequence.push(this.colors[o])}this.hintLabel.string=3===this.level?"\ubd88\uc774 \uae5c\ube61\uc774\ub294 \uc21c\uc11c\ub97c \ubc18\ub300\ub85c \uc785\ub825\ud558\ub77c.":"",console.log("\uc0dd\uc131\ub41c \uc0c9\uc0c1 \uc21c\uc11c:",this.colorSequence)},t.prototype.setInitialButtonState=function(){Object.values(this.buttonMap).forEach(function(e){e.node.opacity=100,e.interactable=!1})},t.prototype.showColorSequence=function(){var e=this;this.setFrogState("neutral"),this.setInitialButtonState();var t=0;this.colorSequence.forEach(function(o){var r=e.buttonMap[o];e.scheduleOnce(function(){return e.activateButtonForBlink(r)},t),t+=1}),this.scheduleOnce(function(){e.enableAnswerInput(),e.setStatusMessage("\ubc84\ud2bc \uc21c\uc11c\ub97c \ub9de\ucdb0\uc8fc\uc138\uc694!")},t)},t.prototype.activateButtonForBlink=function(e){var t=e.node.scale;e.node.opacity=100,e.interactable=!1,cc.tween(e.node).to(.15,{opacity:255,scale:1.05*t},{easing:"quadOut"}).to(.15,{opacity:100,scale:t},{easing:"quadIn"}).start()},t.prototype.enableAnswerInput=function(){Object.values(this.buttonMap).forEach(function(e){var t=e.node.getChildByName("Background");t&&e.node.setContentSize(t.getContentSize()),e.node.opacity=255,e.interactable=!0,console.log(e.node.name+" size:",e.node.width,e.node.height)})},t.prototype.updateScore=function(){this.scoreLabel.string=""+this.score},t.prototype.setStatusMessage=function(e){this.statusLabel.string=e},t.prototype.disableButtons=function(e){Object.values(this.buttonMap).forEach(function(t){t.interactable=!e})},t.prototype.loadList=function(){cc.director.loadScene("SingleGameList")},i([u(cc.Button)],t.prototype,"startButton",void 0),i([u(cc.Button)],t.prototype,"redButton",void 0),i([u(cc.Button)],t.prototype,"yellowButton",void 0),i([u(cc.Button)],t.prototype,"greenButton",void 0),i([u(cc.Button)],t.prototype,"blueButton",void 0),i([u(cc.Label)],t.prototype,"statusLabel",void 0),i([u(cc.Label)],t.prototype,"hintLabel",void 0),i([u(cc.Button)],t.prototype,"exitButton",void 0),i([u(cc.Sprite)],t.prototype,"frogSprite",void 0),i([u(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([u(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([u(cc.Prefab)],t.prototype,"scoreUIPrefab",void 0),i([u(cc.Prefab)],t.prototype,"timerUIPrefab",void 0),i([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState"}],RememberGameExplain:[function(e,t,o){"use strict";cc._RF.push(t,"63501GS7bZGpqKMuY0Cb4uj","RememberGameExplain");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameStartButton=null,t.BackToSingleGameListButton=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this;cc.debug.setDisplayStats(!1),this.gameStartButton.node.on("click",this.onClickStartGame,this),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_ENTER,function(){cc.game.canvas.style.cursor="pointer",e.gameStartButton.node.runAction(cc.scaleTo(.1,1.1))}),this.gameStartButton.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){cc.game.canvas.style.cursor="default",e.gameStartButton.node.runAction(cc.scaleTo(.1,1))})},t.prototype.onClickStartGame=function(){cc.log("\uac8c\uc784 \uc2dc\uc791 \ubc84\ud2bc \ud074\ub9ad\ub428"),cc.director.loadScene("RememberGameScene")},t.prototype.onClickBackSingleGameList=function(){cc.log("\uc2f1\uae00\uac8c\uc784\ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([a(cc.Button)],t.prototype,"gameStartButton",void 0),i([a(cc.Button)],t.prototype,"BackToSingleGameListButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Reversecorrect_Button:[function(e,t,o){"use strict";cc._RF.push(t,"f919fmA72VKiZRgvUwx00zD","Reversecorrect_Button");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./Reversecorrect_Game_logic"),s=cc._decorator,a=s.ccclass,l=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameLogic=null,t}return n(t,e),t.prototype.start=function(){var e=this;this.node.children.forEach(function(t){var o=t.getComponent(cc.Button);o&&o.node.on("touchend",e.ButtonClicked,e)})},t.prototype.ButtonClicked=function(e){var t=0;switch(e.target.name){case"number1":t=1;break;case"number2":t=2;break;case"number3":t=3;break;case"number4":t=4;break;case"number5":t=5;break;case"number6":t=6;break;case"number7":t=7;break;case"number8":t=8;break;case"number9":t=9}c.default.player_label_arr.push(t),c.default.count++,this.gameLogic&&(this.gameLogic.updateInputLabel(),this.gameLogic.checkAnswer())},i([l(c.default)],t.prototype,"gameLogic",void 0),i([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./Reversecorrect_Game_logic":"Reversecorrect_Game_logic"}],Reversecorrect_Game_init:[function(e,t,o){"use strict";cc._RF.push(t,"c4754JUFndJMpLQkeWjjUsc","Reversecorrect_Game_init");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=e("./Reversecorrect_Show_QnA"),s=e("../../Controller/CommonUI/GameState"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.qna=null,t.exitButton=null,t.correct_sign=null,t.wrong_sign=null,t.timerDisplayPrefab=null,t.scoreDisplayPrefab=null,t.gameStartOverlayPrefab=null,t.gameOverUIPrefab=null,t.currentTime=60,t.score=0,t.timerNode=null,t.scoreNode=null,t.timerLabel=null,t.scoreLabel=null,t}var o;return n(t,e),o=t,t.prototype.onLoad=function(){var e=this;if(o.instance=this,this.correct_sign.active=!1,this.wrong_sign.active=!1,this.gameStartOverlayPrefab){var t=cc.instantiate(this.gameStartOverlayPrefab);this.node.addChild(t),t.setPosition(0,0);var r=t.getComponent(cc.Animation);r?(r.play("GameStartFade"),r.once(cc.Animation.EventType.FINISHED,function(){t.destroy(),e.startGameLogic()},this)):this.scheduleOnce(function(){t.destroy(),e.startGameLogic()},1.5)}else this.startGameLogic()},t.prototype.startGameLogic=function(){s.default.lastGameScene=cc.director.getScene().name;var e=cc.director.getScene().name;this.timerNode=cc.instantiate(this.timerDisplayPrefab),this.node.addChild(this.timerNode),this.timerLabel=this.timerNode.getChildByName("TimerLabel").getComponent(cc.Label),this.updateTimerLabel(),this.timerNode.setPosition("Reversecorrect_mainscene"===e?cc.v2(-300,800):cc.v2(380,900)),this.scoreNode=cc.instantiate(this.scoreDisplayPrefab),this.node.addChild(this.scoreNode),this.scoreLabel=this.scoreNode.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScore(0),this.scoreNode.setPosition("Reversecorrect_mainscene"===e?cc.v2(300,800):cc.v2(200,-830)),this.schedule(this.updateTimer,1)},t.prototype.updateTimer=function(){this.currentTime--,this.currentTime<=0&&(this.currentTime=0,this.unschedule(this.updateTimer),c.default.isGameOver=!0,this.qna.setButtonsInteractable(!1),this.onGameOver()),this.updateTimerLabel()},t.prototype.updateTimerLabel=function(){this.timerLabel.string=""+this.currentTime},t.prototype.updateScore=function(e){this.score+=e,this.scoreLabel.string=""+this.score},t.prototype.onGameOver=function(){cc.log("\uac8c\uc784 \uc885\ub8cc!"),s.default.lastGameScene=cc.director.getScene().name,s.default.score=this.score,s.default.gameId="ReverseCorrect-Game";var e=cc.instantiate(this.gameOverUIPrefab);this.node.addChild(e),e.setPosition(0,0)},t.prototype.loadList=function(){console.log("\uc2f1\uae00 \uac8c\uc784 \ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},t.instance=null,i([u(c.default)],t.prototype,"qna",void 0),i([u(cc.Button)],t.prototype,"exitButton",void 0),i([u(cc.Node)],t.prototype,"correct_sign",void 0),i([u(cc.Node)],t.prototype,"wrong_sign",void 0),i([u(cc.Prefab)],t.prototype,"timerDisplayPrefab",void 0),i([u(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([u(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([u(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),o=i([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState","./Reversecorrect_Show_QnA":"Reversecorrect_Show_QnA"}],Reversecorrect_Game_logic:[function(e,t,o){"use strict";cc._RF.push(t,"2c718aMM5FK8ZAbHIRNyguQ","Reversecorrect_Game_logic");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,s=i.length;c<s;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./Reversecorrect_Show_QnA"),a=e("./Reversecorrect_Game_init"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.player_label_display=null,t.qna=null,t.sequence_label=null,t}var o;return n(t,e),o=t,t.prototype.updateInputLabel=function(){var e=o.player_label_arr.join("");this.player_label_display.string=e},t.prototype.checkAnswer=function(){var e=this;if(!s.default.isGameOver){for(var t=o.player_label_arr,r=s.default.isReverse?c(s.default.qa).reverse():c(s.default.qa),n=0;n<t.length;n++)if(t[n]!==r[n])return a.default.instance.wrong_sign.active=!0,this.qna.setButtonsInteractable(!1),cc.director.pause(),void setTimeout(function(){cc.director.resume(),a.default.instance.wrong_sign.active=!1,e.nextProblem(!1)},1500);t.length===r.length&&(a.default.instance.updateScore(10),a.default.instance.correct_sign.active=!0,this.qna.setButtonsInteractable(!1),cc.director.pause(),setTimeout(function(){cc.director.resume(),a.default.instance.correct_sign.active=!1,e.nextProblem(!0)},1500))}},t.prototype.nextProblem=function(e){o.player_label_arr=[],o.count=0,this.player_label_display.string="",s.default.qa=[],this.sequence_label&&(this.sequence_label.string="",this.sequence_label.node.active=!1),e&&s.default.correctCount++,this.qna&&this.qna.showNewQuestion()},t.player_label_arr=[],t.count=0,i([p(cc.Label)],t.prototype,"player_label_display",void 0),i([p(s.default)],t.prototype,"qna",void 0),i([p(cc.Label)],t.prototype,"sequence_label",void 0),o=i([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"./Reversecorrect_Game_init":"Reversecorrect_Game_init","./Reversecorrect_Show_QnA":"Reversecorrect_Show_QnA"}],Reversecorrect_Load_Scene:[function(e,t,o){"use strict";cc._RF.push(t,"c7b93ajJA1AFJpRaO4K/0k/","Reversecorrect_Load_Scene");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BackButton=null,t}return n(t,e),t.prototype.start=function(){this.node.on("touchend",function(){cc.director.loadScene("Reversecorrect_mainscene")})},t.prototype.onClickList=function(){cc.log("\ub4a4\ub85c\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad\ub428. SingleGameList \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("SingleGameList")},i([a(cc.Button)],t.prototype,"BackButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Reversecorrect_Show_QnA:[function(e,t,o){"use strict";cc._RF.push(t,"d5e77uqnYZN8Zczx4Uw6LMj","Reversecorrect_Show_QnA");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.random_label=null,t.buttonLayout=null,t.sequence_label=null,t.cnt=3,t.hideDelay=1.5,t.defaultHideDelay=2,t.minHideDelay=.1,t.lastMilestone=0,t}var o;return n(t,e),o=t,t.prototype.start=function(){this.showNewQuestion()},t.prototype.showNewQuestion=function(){var e=this,t=o.correctCount%3;this.hideDelay=1.6-.2*t,o.isReverse=Math.random()<.5;var r=this.print_randnum();this.random_label.string=""+r,this.random_label.node.active=!0,this.setButtonsInteractable(!1),this.sequence_label&&(this.sequence_label.string="",this.sequence_label.node.active=!1),this.scheduleOnce(function(){e.random_label.node.active=!1,e.sequence_label&&(e.sequence_label.string=o.isReverse?"\uc5ed\ubc29\ud5a5":"\uc815\ubc29\ud5a5",e.sequence_label.node.active=!0,e.setButtonsInteractable(!0)),!0===o.isGameOver&&e.setButtonsInteractable(!1)},this.hideDelay)},t.prototype.make_randnum=function(){o.qa=[];var e=[1,2,3,4,5,6,7,8,9],t=Math.floor(o.correctCount/3);t>this.lastMilestone&&(this.cnt++,this.lastMilestone=t,this.hideDelay=this.defaultHideDelay);for(var r=0;r<this.cnt;r++){var n=e[Math.floor(Math.random()*e.length)];o.qa.push(n)}return o.qa},t.prototype.print_randnum=function(){for(var e=this.make_randnum(),t=0,o=0;o<e.length;o++)t=10*t+e[o];return t},t.prototype.setButtonsInteractable=function(e){for(var t=0,o=this.buttonLayout.getComponentsInChildren(cc.Button);t<o.length;t++){var r=o[t];r.interactable=e,e?r.node.resumeSystemEvents(!0):r.node.pauseSystemEvents(!0)}},t.correctCount=0,t.qa=[],t.isGameOver=!1,t.isReverse=!1,i([a(cc.Label)],t.prototype,"random_label",void 0),i([a(cc.Node)],t.prototype,"buttonLayout",void 0),i([a(cc.Label)],t.prototype,"sequence_label",void 0),o=i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Rottenacorn_Load_Scene:[function(e,t,o){"use strict";cc._RF.push(t,"b721eHUF69GJ5l+EVPPoFUJ","Rottenacorn_Load_Scene");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BackButton=null,t}return n(t,e),t.prototype.start=function(){this.node.on("touchend",function(){cc.director.loadScene("Rottenacorn_mainscene")})},t.prototype.onClickList=function(){cc.log("\ub4a4\ub85c\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad\ub428. SingleGameList \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("SingleGameList")},i([a(cc.Button)],t.prototype,"BackButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Rottenacorn_acorn_manager:[function(e,t,o){"use strict";cc._RF.push(t,"f5a9eAEZjtNuIymEkL0217h","Rottenacorn_acorn_manager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=e("./Rottenacorn_acorn"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.acornPrefab=null,t.acornParent=null,t.pool=[],t}return n(t,e),t.prototype.onLoad=function(){this.initPool()},t.prototype.initPool=function(){for(var e=0;e<8;e++){var t=cc.instantiate(this.acornPrefab);t.parent=this.acornParent,t.active=!1,this.pool.push(t)}},t.prototype.getAcorn=function(e){for(var t=0,o=this.pool;t<o.length;t++){var r=o[t];if(!r.active)return this.setupAcorn(r,e),r}return null},t.prototype.setupAcorn=function(e,t){e.active=!0;var o=e.getComponent(l.default);o&&o.activate(t);var r=400*Math.random()-200,n=200*Math.random()-100;e.setPosition(r,n)},t.prototype.resetAll=function(){for(var e=0,t=this.pool;e<t.length;e++)t[e].active=!1},i([a(cc.Prefab)],t.prototype,"acornPrefab",void 0),i([a(cc.Node)],t.prototype,"acornParent",void 0),i([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./Rottenacorn_acorn":"Rottenacorn_acorn"}],Rottenacorn_acorn:[function(e,t,o){"use strict";cc._RF.push(t,"b4810lOqyBGeZnU+y/P5j0Y","Rottenacorn_acorn");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bugNode=null,t.speed=300,t.minSpeed=150,t}return n(t,e),t.prototype.activate=function(e){var t=this;this.bugNode&&(this.bugNode.active=e,e&&this.scheduleOnce(function(){t.bugNode.active=!1},1));var o=this.node.getComponent(cc.RigidBody);if(o){var r=2*Math.random()*Math.PI,n=Math.cos(r)*this.speed,i=Math.sin(r)*this.speed;o.linearVelocity=cc.v2(n,i),o.awake=!0}},t.prototype.update=function(){var e=this.node.getComponent(cc.RigidBody);if(e){var t=e.linearVelocity;if(t.mag()<this.minSpeed){var o=t.normalize();if(o.mag()<.001){var r=2*Math.random()*Math.PI;o.x=Math.cos(r),o.y=Math.sin(r)}var n=(Math.random()-.5)*Math.PI/10,i=Math.atan2(o.y,o.x)+n,c=Math.cos(i)*this.minSpeed,s=Math.sin(i)*this.minSpeed;e.linearVelocity=cc.v2(c,s)}}},i([a(cc.Node)],t.prototype,"bugNode",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Rottenacorn_game_init:[function(e,t,o){"use strict";cc._RF.push(t,"51d5eam6QRMlYtW5l10P8xH","Rottenacorn_game_init");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=e("../../Controller/CommonUI/GameState"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.acornPrefab=null,t.correct_sign=null,t.wrong_sign=null,t.exitButton=null,t.timerDisplayPrefab=null,t.scoreDisplayPrefab=null,t.gameStartOverlayPrefab=null,t.gameOverUIPrefab=null,t.totalTime=60,t.currentTime=60,t.score=0,t.timerNode=null,t.scoreNode=null,t.timerLabel=null,t.scoreLabel=null,t}return n(t,e),t.prototype.onLoad=function(){var e=this,t=cc.director.getPhysicsManager();if(t.enabled=!0,t.gravity=cc.v2(0,0),this.correct_sign.active=!1,this.wrong_sign.active=!1,this.gameStartOverlayPrefab){var o=cc.instantiate(this.gameStartOverlayPrefab);this.node.addChild(o),o.setPosition(0,0),cc.tween(o).delay(1.5).to(.5,{opacity:0}).call(function(){o.destroy(),e.startGameLogic()}).start()}else this.startGameLogic()},t.prototype.startGameLogic=function(){l.default.lastGameScene=cc.director.getScene().name;var e=cc.director.getScene().name;this.timerNode=cc.instantiate(this.timerDisplayPrefab),this.node.addChild(this.timerNode),this.timerLabel=this.timerNode.getChildByName("TimerLabel").getComponent(cc.Label),this.timerLabel.string=""+this.currentTime,this.schedule(this.updateTimer,1),"Rottenacorn_Mainscene"===e?this.timerNode.setPosition(cc.v2(180,1700)):"Rottenacorn_Multiscene"===e&&this.timerNode.setPosition(cc.v2(900,1825)),this.scoreNode=cc.instantiate(this.scoreDisplayPrefab),this.node.addChild(this.scoreNode),this.scoreLabel=this.scoreNode.getChildByName("ScoreLabel").getComponent(cc.Label),this.updateScore(0)},t.prototype.updateTimer=function(){this.currentTime--,this.currentTime<=0&&(this.currentTime=0,this.unschedule(this.updateTimer),this.onGameOver()),this.timerLabel.string=""+this.currentTime},t.prototype.updateScore=function(e){this.score+=e,this.scoreLabel.string=""+this.score},t.prototype.onGameOver=function(){cc.log("\uac8c\uc784 \uc885\ub8cc!"),l.default.lastGameScene=cc.director.getScene().name,l.default.score=this.score,l.default.gameId="RottenAcorn";var e=cc.instantiate(this.gameOverUIPrefab);this.node.addChild(e),e.setPosition(0,0)},t.prototype.loadList=function(){console.log("\uc2f1\uae00 \uac8c\uc784 \ub9ac\uc2a4\ud2b8\ub85c \ub3cc\uc544\uac00\uae30"),cc.director.loadScene("SingleGameList")},i([a(cc.Prefab)],t.prototype,"acornPrefab",void 0),i([a(cc.Node)],t.prototype,"correct_sign",void 0),i([a(cc.Node)],t.prototype,"wrong_sign",void 0),i([a(cc.Button)],t.prototype,"exitButton",void 0),i([a(cc.Prefab)],t.prototype,"timerDisplayPrefab",void 0),i([a(cc.Prefab)],t.prototype,"scoreDisplayPrefab",void 0),i([a(cc.Prefab)],t.prototype,"gameStartOverlayPrefab",void 0),i([a(cc.Prefab)],t.prototype,"gameOverUIPrefab",void 0),i([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Controller/CommonUI/GameState":"GameState"}],Rottenacorn_game_logic:[function(e,t,o){"use strict";cc._RF.push(t,"5d79f0nZ65IBbE0bW75SBoI","Rottenacorn_game_logic");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=e("./Rottenacorn_acorn_manager"),u=e("./Rottenacorn_acorn"),p=e("./Rottenacorn_game_init"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.game_init=null,t.acornManager=null,t.frontbutton=null,t.backbutton=null,t.choicebutton=null,t.timeLimit=60,t.sign=null,t.remainingTime=0,t.isGameOver=!1,t.score=0,t.normalCount=2,t.rottenCount=1,t.correctStreak=0,t.currentAcorns=[],t.selectedIndex=0,t.rottenIndices=[],t.selectedIndices=new Set,t}return n(t,e),t.prototype.onLoad=function(){var e,t,o;null===(e=this.frontbutton)||void 0===e||e.on(cc.Node.EventType.TOUCH_END,this.onNext,this),null===(t=this.backbutton)||void 0===t||t.on(cc.Node.EventType.TOUCH_END,this.onPrev,this),null===(o=this.choicebutton)||void 0===o||o.on(cc.Node.EventType.TOUCH_END,this.onConfirm,this)},t.prototype.start=function(){this.remainingTime=this.timeLimit,this.isGameOver=!1,this.score=0,this.startRound()},t.prototype.update=function(e){this.isGameOver||(this.remainingTime-=e,this.remainingTime<=0&&(this.remainingTime=0,this.endGame()))},t.prototype.startRound=function(){var e=this;this.acornManager.resetAll();var t=this.normalCount+this.rottenCount;this.rottenIndices=this.pickRandomIndices(t,this.rottenCount),this.selectedIndices.clear(),this.currentAcorns=[];for(var o=0;o<t;o++){var r=this.rottenIndices.includes(o),n=this.acornManager.getAcorn(r);if(n){var i=-60*(t-1)+120*o;n.setPosition(i,100);var c=n.getChildByName("selected_pic");c&&(c.active=!1),this.currentAcorns.push(n)}}this.selectedIndex=0,this.frontbutton.pauseSystemEvents(!0),this.backbutton.pauseSystemEvents(!0),this.choicebutton.pauseSystemEvents(!0),this.scheduleOnce(function(){e.updateSelectionVisual(),e.frontbutton.resumeSystemEvents(!1),e.backbutton.resumeSystemEvents(!1),e.choicebutton.resumeSystemEvents(!1)},1)},t.prototype.updateSelectionVisual=function(){for(var e=0;e<this.currentAcorns.length;e++){var t=this.currentAcorns[e].getChildByName("selected_pic");t&&(t.active=e===this.selectedIndex)}},t.prototype.onNext=function(){if(0!==this.currentAcorns.length){var e=this.selectedIndex,t=this.currentAcorns.length;do{e=(e+1)%t}while(this.selectedIndices.has(e)&&e!==this.selectedIndex);this.selectedIndex=e,this.updateSelectionVisual()}},t.prototype.onPrev=function(){if(0!==this.currentAcorns.length){var e=this.selectedIndex,t=this.currentAcorns.length;do{e=(e-1+t)%t}while(this.selectedIndices.has(e)&&e!==this.selectedIndex);this.selectedIndex=e,this.updateSelectionVisual()}},t.prototype.onConfirm=function(){var e=this;if(0!==this.currentAcorns.length&&!this.isGameOver){var t=this.selectedIndex;if(!this.selectedIndices.has(t)){this.selectedIndices.add(t);var o=this.rottenIndices.includes(t),r=this.currentAcorns[t].getComponent(u.default);return o?(this.game_init.updateScore(10),(null==r?void 0:r.bugNode)&&(r.unscheduleAllCallbacks(),r.bugNode.active=!0),this.selectedIndices.size===this.rottenIndices.length?(this.sign.correct_sign.active=!0,this.frontbutton.pauseSystemEvents(!0),this.backbutton.pauseSystemEvents(!0),this.choicebutton.pauseSystemEvents(!0),void this.scheduleOnce(function(){e.sign.correct_sign.active=!1,e.frontbutton.resumeSystemEvents(!0),e.backbutton.resumeSystemEvents(!0),e.choicebutton.resumeSystemEvents(!0),e.handleCorrectAnswer()},1)):void 0):(this.frontbutton.pauseSystemEvents(!0),this.backbutton.pauseSystemEvents(!0),this.choicebutton.pauseSystemEvents(!0),this.sign.wrong_sign.active=!0,void this.scheduleOnce(function(){e.sign.wrong_sign.active=!1,e.frontbutton.resumeSystemEvents(!0),e.backbutton.resumeSystemEvents(!0),e.choicebutton.resumeSystemEvents(!0),e.startRound()},1))}}},t.prototype.handleCorrectAnswer=function(){this.correctStreak++,this.correctStreak>=2&&this.normalCount<4?(this.normalCount++,this.correctStreak=0):this.rottenCount<this.normalCount&&this.rottenCount<4&&this.rottenCount++,this.startRound()},t.prototype.endGame=function(){this.isGameOver||(this.isGameOver=!0,this.frontbutton.active=!1,this.backbutton.active=!1,this.choicebutton.active=!1,this.currentAcorns=[])},t.prototype.pickRandomIndices=function(e,t){for(var o,r=Array.from(Array(e).keys()),n=r.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1));o=[r[i],r[n]],r[n]=o[0],r[i]=o[1]}return r.slice(0,t)},i([a(p.default)],t.prototype,"game_init",void 0),i([a(l.default)],t.prototype,"acornManager",void 0),i([a(cc.Node)],t.prototype,"frontbutton",void 0),i([a(cc.Node)],t.prototype,"backbutton",void 0),i([a(cc.Node)],t.prototype,"choicebutton",void 0),i([a],t.prototype,"timeLimit",void 0),i([a(p.default)],t.prototype,"sign",void 0),i([s],t)}(cc.Component);o.default=h,cc._RF.pop()},{"./Rottenacorn_acorn":"Rottenacorn_acorn","./Rottenacorn_acorn_manager":"Rottenacorn_acorn_manager","./Rottenacorn_game_init":"Rottenacorn_game_init"}],SingleGameList:[function(e,t,o){"use strict";cc._RF.push(t,"c1b30N2FO9KdJh7XP5Dt8Z+","SingleGameList");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameCardContainer=null,t.gameCardPrefab=null,t.selectButton=null,t.leftArrow=null,t.rightArrow=null,t.BackButton=null,t.currentIndex=0,t.cards=[],t.selectedScene=null,t.gameList=[{title:"\ub450\ub354\uc9c0 \uac8c\uc784",thumbnail:"mole_thumb",scene:"Mole_ExplainScene"},{title:"\uacfc\uc77c \ud37c\uc990",thumbnail:"three_thumb",scene:"3m_ExplainScene"},{title:"\ube14\ub85d \uac1c\uc218 \uc138\uae30",thumbnail:"block_thumb",scene:"BlockCount_ExplainScene"},{title:"\uae30\uc5b5\ub825 \uac8c\uc784",thumbnail:"remember_thumb",scene:"RememberGame_ExplainScene"},{title:"\uc22b\uc790 \ub4a4\uc9d1\uc5b4 \ub9de\ucd94\uae30",thumbnail:"reverse_thumb",scene:"Reversecorrect_ExplainScene"},{title:"\uc9d1\uc911\ub825 \uac8c\uc784",thumbnail:"concetration_thumb",scene:"Rottenacorn_Explain_scene"},{title:"\ubbf8\ub85c \uac8c\uc784",thumbnail:"maze_thumb",scene:"Maze_ExplainScene"}],t}return n(t,e),t.prototype.selectScene=function(e,t){this.selectedScene=e,this.gameCardContainer.children.forEach(function(e){e.scale=e===t?1.1:1,e.opacity=e===t?255:180}),this.selectButton.interactable=!0},t.prototype.onLoad=function(){this.selectButton.interactable=!1,this.loadGameCards(),this.registerArrowEvents(this.leftArrow,this.showPrevCard.bind(this)),this.registerArrowEvents(this.rightArrow,this.showNextCard.bind(this)),this.registerButtonEvents(this.selectButton.node,this.onSelectButtonClick.bind(this)),this.registerButtonEvents(this.BackButton.node,this.onClickMain.bind(this))},t.prototype.registerButtonEvents=function(e,t){e.off(cc.Node.EventType.TOUCH_END),e.on(cc.Node.EventType.TOUCH_END,t)},t.prototype.registerArrowEvents=function(e,t){e.off(cc.Node.EventType.TOUCH_END),e.on(cc.Node.EventType.TOUCH_END,t)},t.prototype.loadGameCards=function(){var e=this;this.gameList.forEach(function(t){var o,r=cc.instantiate(e.gameCardPrefab),n=r.getChildByName("GameDesc");n&&(n.active=!1);var i=null===(o=r.getChildByName("GameTitleBox"))||void 0===o?void 0:o.getChildByName("GameTitle");i&&i.getComponent(cc.Label)&&(i.getComponent(cc.Label).string=t.title);var c=r.getChildByName("GameThumbnail");c&&c.getComponent(cc.Sprite)&&cc.resources.load("Images/Common/thumbnails/"+t.thumbnail,cc.SpriteFrame,function(e,t){!e&&t&&(c.getComponent(cc.Sprite).spriteFrame=t)}),r.active=!1,e.cards.push(r),e.gameCardContainer.addChild(r)}),this.showCardAtIndex(0)},t.prototype.showCardAtIndex=function(e){this.cards.forEach(function(t,o){t.active=o===e}),this.currentIndex=e,this.selectScene(this.gameList[e].scene,this.cards[e])},t.prototype.showNextCard=function(){var e=(this.currentIndex+1)%this.cards.length;this.showCardAtIndex(e)},t.prototype.showPrevCard=function(){var e=(this.currentIndex-1+this.cards.length)%this.cards.length;this.showCardAtIndex(e)},t.prototype.onSelectButtonClick=function(){this.selectedScene&&cc.director.loadScene(this.selectedScene)},t.prototype.onClickMain=function(){cc.log("\ub4a4\ub85c\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad\ub428. Main \uc52c\uc73c\ub85c \uc774\ub3d9."),cc.director.loadScene("MainScene")},i([a(cc.Node)],t.prototype,"gameCardContainer",void 0),i([a(cc.Prefab)],t.prototype,"gameCardPrefab",void 0),i([a(cc.Button)],t.prototype,"selectButton",void 0),i([a(cc.Node)],t.prototype,"leftArrow",void 0),i([a(cc.Node)],t.prototype,"rightArrow",void 0),i([a(cc.Button)],t.prototype,"BackButton",void 0),i([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],SingleGameOver:[function(e,t,o){"use strict";cc._RF.push(t,"37c9d71cJ1Cco0xoDnC87r3","SingleGameOver");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function s(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,s)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../CommonUI/GameState"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.exitButton=null,t.retryButton=null,t}return n(t,e),t.prototype.onLoad=function(){this.exitButton&&this.registerButtonEvents(this.exitButton.node,this.onExitClick.bind(this)),this.retryButton&&this.registerButtonEvents(this.retryButton.node,this.onRetryClick.bind(this)),this.submitScoreToServer()},t.prototype.registerButtonEvents=function(e,t){e.on(cc.Node.EventType.TOUCH_END,t),e.on(cc.Node.EventType.MOUSE_DOWN,t)},t.prototype.onExitClick=function(){console.log("\ub098\uac00\uae30 \ubc84\ud2bc \ud074\ub9ad \u2192 SingleGameList \uc52c\uc73c\ub85c \uc774\ub3d9"),cc.director.loadScene("SingleGameList")},t.prototype.onRetryClick=function(){var e=a.default.lastGameScene;e&&e.length>0?(cc.log("\ub2e4\uc2dc\ud558\uae30 \u2192 "+e),cc.director.loadScene(e)):(cc.warn("\uc774\uc804 \uc52c \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uba54\uc778\uc73c\ub85c \uc774\ub3d9"),cc.director.loadScene("MainScene"))},t.prototype.submitScoreToServer=function(){return c(this,void 0,void 0,function(){var e,t,o,r;return s(this,function(n){switch(n.label){case 0:if(!(e=localStorage.getItem("jwtToken")))return console.warn("JWT \ud1a0\ud070\uc774 \uc5c6\uc5b4 \uc810\uc218 \uc800\uc7a5 \ubd88\uac00"),[2];console.log("[\ud074\ub77c\uc774\uc5b8\ud2b8] localStorage jwtToken =",e),console.log("\uc810\uc218 \uc800\uc7a5 \uc694\uccad",{gameId:a.default.gameId,score:a.default.score,mode:"single",nickname:a.default.nickname,character:a.default.character}),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch("https://smartzoo.shop/single/submit",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({gameId:a.default.gameId,score:a.default.score,mode:"single",nickname:a.default.nickname,character:a.default.character})})];case 2:return[4,(t=n.sent()).json()];case 3:return o=n.sent(),t.ok?console.log("\uc810\uc218 \uc800\uc7a5 \uc131\uacf5:",o):console.warn("\uc810\uc218 \uc800\uc7a5 \uc2e4\ud328:",o.message),[3,5];case 4:return r=n.sent(),console.error("\uc810\uc218 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd:",r),[3,5];case 5:return[2]}})})},i([p(cc.Button)],t.prototype,"exitButton",void 0),i([p(cc.Button)],t.prototype,"retryButton",void 0),i([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../CommonUI/GameState":"GameState"}],SplashMain:[function(e,t,o){"use strict";cc._RF.push(t,"82f9bwp23RJlZtPIfyh7n8B","SplashMain");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){localStorage.getItem("jwtToken")?cc.director.loadScene("LoginScene"):(this.scheduleOnce(function(){cc.director.loadScene("StoryScene_1")},1),this.node.on("touchend",function(){cc.director.loadScene("StoryScene_1")}))},i([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],StoryScene_Controller:[function(e,t,o){"use strict";cc._RF.push(t,"47ee1hhyu1HcZUf5y9OTmip","StoryScene_Controller");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){var e=this;cc.director.preloadScene("StoryScene_2"),cc.director.preloadScene("StoryScene_3"),this.node.on("touchend",function(){var t=e.node.name;"Movefir_Arrow"===t&&cc.director.loadScene("StoryScene_1"),"Movesec_Arrow"===t&&cc.director.loadScene("StoryScene_2"),"Movethir_Arrow"===t&&cc.director.loadScene("StoryScene_3"),cc.director.loadScene("LoginScene")})},i([s],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],Tile:[function(e,t,o){"use strict";cc._RF.push(t,"4b9bcgU2iZNSYqYzUz565+a","Tile");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=e("./3MatchBoard"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t.explosionPrefabs=[],t.fruitSprites=[],t.row=0,t.col=0,t.touchStartPos=null,t.fruitIndex=0,t}var o;return n(t,e),o=t,t.prototype.onLoad=function(){this.sprite||(this.sprite=this.node.addComponent(cc.Sprite)),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.setRandomFruit=function(){var e=Math.floor(Math.random()*this.fruitSprites.length);this.fruitIndex=e,this.sprite.spriteFrame=this.fruitSprites[e]},t.prototype.setRandomFruitExcluding=function(e){var t=this.fruitSprites.map(function(e,t){return t}).filter(function(t){return!e.includes(t)});0===t.length&&(t=this.fruitSprites.map(function(e,t){return t}));var o=t[Math.floor(Math.random()*t.length)];this.fruitIndex=o,this.sprite.spriteFrame=this.fruitSprites[o]},t.prototype.addOutline=function(){var e=this.node.getComponent(cc.Graphics);e&&this.node.removeComponent(e);var t=new cc.Node;t.parent=this.node,t.setPosition(0,0);var o=t.addComponent(cc.Graphics);o.lineWidth=5,o.strokeColor=cc.Color.BLACK;var r=this.node.getContentSize();console.log("Tile Size:",r),o.rect(-r.width/2,-r.height/2,r.width,r.height),o.stroke()},t.prototype.onTouchStart=function(e){this.touchStartPos=e.getLocation(),console.log("\ub4dc\ub798\uadf8 \uc2dc\uc791 \uc704\uce58:",this.touchStartPos)},t.prototype.onTouchEnd=function(e){var t=e.getLocation(),o=t.sub(this.touchStartPos);if(console.log("\ub4dc\ub798\uadf8 \ub05d \uc704\uce58:",t),console.log("\ub4dc\ub798\uadf8 \uac70\ub9ac:",o),o.len()<3)console.log("\ub4dc\ub798\uadf8 \ub108\ubb34 \uc9e7\uc544\uc11c \ubb34\uc2dc\ub428");else{var r=Math.abs(o.x),n=Math.abs(o.y);if(r<1&&n<1)console.log("\uc6c0\uc9c1\uc784\uc774 \ub108\ubb34 \uc791\uc544\uc11c \ubb34\uc2dc\ub428");else{var i;i=r>n?o.x>0?"right":"left":o.y>0?"up":"down",console.log("\ub4dc\ub798\uadf8 \ubc29\ud5a5:",i);var c=this.node.parent.getComponent(l.default);if(c&&c.board){var s=null,a=this.row,u=this.col;switch(i){case"up":a>0&&(s=c.board[a-1][u]);break;case"down":a<c.boardSize-1&&(s=c.board[a+1][u]);break;case"left":u>0&&(s=c.board[a][u-1]);break;case"right":u<c.boardSize-1&&(s=c.board[a][u+1])}s&&(console.log("\ud0c0\uc77c \uad50\ud658: ("+a+", "+u+") <-> ("+s.row+", "+s.col+")"),c.swapTiles(this,s))}else console.warn("ThreeMatchBoard\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c")}}},t.prototype.explode=function(){var e=this;console.log("explode() \uc2e4\ud589: ("+this.row+", "+this.col+")");var t=this.explosionPrefabs[this.fruitIndex];if(t){console.log("\ud3ed\ubc1c \uc774\ud399\ud2b8 \uc0dd\uc131 (fruitIndex "+this.fruitIndex+"): ("+this.row+", "+this.col+")");var r=cc.instantiate(t);r.parent=this.node.parent,r.setPosition(this.node.getPosition()),r.setScale(1.2),r.angle=360*Math.random();var n=r.getComponent(cc.ParticleSystem);n&&(n.startSize=160,n.startSizeVar=80,n.life=.25,n.lifeVar=.05,n.resetSystem()),this.scheduleOnce(function(){r.destroy()},1)}this.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,1.8).easing(cc.easeCubicActionOut()),cc.fadeOut(.15)),cc.callFunc(function(){o.selectedTile===e&&(o.selectedTile=null),e.node.destroy()})))},t.selectedTile=null,i([a(cc.Sprite)],t.prototype,"sprite",void 0),i([a([cc.Prefab])],t.prototype,"explosionPrefabs",void 0),i([a([cc.SpriteFrame])],t.prototype,"fruitSprites",void 0),o=i([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./3MatchBoard":"3MatchBoard"}],socket:[function(e,t){"use strict";cc._RF.push(t,"3af23xLkelE/Ls3CilqTMF1","socket"),cc.sys.isNative||(window.io=window.io||e("socket.io-client"),window.socket=io("https://smartzoo.shop")),cc._RF.pop()},{"socket.io-client":26}]},{},["GameStartOverlay","GameState","Loading","LoginManager","MainMenuScene","SplashMain","StoryScene_Controller","MultiFlowController","MultiGameList","MultiGameResult","MultiGameWait","MultiPlayConnect","MyInfoController","SingleGameList","SingleGameOver","MazeGameData","MazeGameOverManager","MazeGenerator","MazeLogic","MazePlayerController","MazeRenderer","MazeSingleGameManager","MazeUIManager","Maze_explainSceneManager","BlockCountExplain","BlockCountGameManager","MultiGuestViewerRemember","MultiPlayerRememberGame","MultiplayerMemoryGameController","RememberGameController","RememberGameExplain","MultiOpponent","MultiReversecorrectGameController","Multiplayer","Reversecorrect_Button","Reversecorrect_Game_init","Reversecorrect_Game_logic","Reversecorrect_Load_Scene","Reversecorrect_Show_QnA","Rottenacorn_Load_Scene","Rottenacorn_acorn","Rottenacorn_acorn_manager","Rottenacorn_game_init","Rottenacorn_game_logic","3MExplain","3MatchBoard","3MatchManager","Tile","MoleExplain","MoleGameScene","MultiGuestViewer","MultiplayerGameScene","MultiplayerMoleGameController","socket"]);