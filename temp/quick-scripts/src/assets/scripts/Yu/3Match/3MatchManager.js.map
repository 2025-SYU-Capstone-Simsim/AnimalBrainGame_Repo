{"version":3,"sources":["assets\\scripts\\Yu\\3Match\\3MatchManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport ThreeMatchBoard from \"./3MatchBoard\";\nimport GameState from \"../../Controller/CommonUI/GameState\";\n\n@ccclass\nexport default class ThreeMatchManager extends cc.Component {\n    @property(cc.Prefab)\n    timerDisplayPrefab: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    scoreDisplayPrefab: cc.Prefab = null;\n\n    @property(cc.Node)\n    boardNode: cc.Node = null;\n\n    @property(cc.ProgressBar)\n    comboGauge: cc.ProgressBar = null;\n\n    @property(cc.Node)\n    feverSprite: cc.Node = null;\n\n    @property(cc.Button)\n    exitButton: cc.Button = null;\n\n    @property(cc.Prefab)\n    gameOverUIPrefab: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    gameStartOverlayPrefab: cc.Prefab = null;\n\n    private totalTime: number = 30;\n    private currentTime: number = 30;\n    private score: number = 0;\n\n    private timerNode: cc.Node = null;\n    private scoreNode: cc.Node = null;\n\n    private timerLabel: cc.Label = null;\n    private scoreLabel: cc.Label = null;\n\n    private comboValue: number = 0;\n    private comboMax: number = 300;\n    private isFeverTime: boolean = false;\n\n    start() {\n        GameState.lastGameScene = cc.director.getScene().name;\n        if (this.feverSprite && this.feverSprite.isValid) {\n            this.feverSprite.active = false;\n        }\n\n\n        if (this.gameStartOverlayPrefab) {\n            const startOverlay = cc.instantiate(this.gameStartOverlayPrefab);\n            this.node.addChild(startOverlay);\n            startOverlay.setPosition(0, 0);\n\n            // 애니메이션 시간 후에 시작 (2초 권장)\n            this.scheduleOnce(() => {\n                this.startGameLogic();\n            }, 2);\n        } else {\n            this.startGameLogic();\n        }\n    }\n\n    startGameLogic() {\n        // 타이머 UI\n        this.timerNode = cc.instantiate(this.timerDisplayPrefab);\n        this.node.addChild(this.timerNode);\n        this.timerLabel = this.timerNode.getChildByName(\"TimerLabel\").getComponent(cc.Label);\n        this.updateTimer();\n\n        // 점수 UI\n        this.scoreNode = cc.instantiate(this.scoreDisplayPrefab);\n        this.node.addChild(this.scoreNode);\n        this.scoreLabel = this.scoreNode.getChildByName(\"ScoreLabel\").getComponent(cc.Label);\n        this.updateScore(0);\n\n        // 피버 관련 초기화\n        this.comboValue = 0;\n        this.comboMax = 300;\n        this.comboGauge.progress = 0;\n        this.isFeverTime = false;\n        if (this.feverSprite) this.feverSprite.active = false;\n\n        // 타이머 시작\n        this.schedule(this.updateTimer, 1);\n    }\n\n    updateTimer() {\n        this.currentTime--;\n        if (this.currentTime <= 0) {\n            this.currentTime = 0;\n            this.unschedule(this.updateTimer);\n            this.onGameOver();\n        }\n        this.timerLabel.string = `${this.currentTime}`;\n    }\n\n    updateScore(amount: number) {\n        this.score += amount;\n        this.scoreLabel.string = `${this.score}`;\n        this.increaseComboGauge(amount);\n    }\n\n    increaseComboGauge(amount: number) {\n        if (this.isFeverTime) return;\n        this.comboValue += amount;\n        if (this.comboValue >= this.comboMax) {\n            this.comboValue = this.comboMax;\n            this.startFeverTime();\n        }\n        this.comboGauge.progress = this.comboValue / this.comboMax;\n    }\n\n    startFeverTime() {\n        this.isFeverTime = true;\n        this.feverSprite.active = true;\n\n        this.scheduleOnce(() => {\n            this.endFeverTime();\n        }, 10);\n    }\n\n    endFeverTime() {\n        this.isFeverTime = false;\n        this.comboValue = 0;\n        this.comboGauge.progress = 0;\n        this.feverSprite.active = false;\n    }\n\n    public addMatchScore(matchCount: number) {\n        const scoreToAdd = matchCount * 10;\n        const finalScore = this.isFeverTime ? scoreToAdd * 2 : scoreToAdd;\n        this.updateScore(finalScore);\n    }\n\n    onGameOver() {\n        cc.log(\"게임 종료!\");\n        GameState.lastGameScene = cc.director.getScene().name;\n        GameState.score = this.score;\n        GameState.gameId = \"FruitPuzzle\";\n\n        const gameOverUI = cc.instantiate(this.gameOverUIPrefab);\n        this.node.addChild(gameOverUI);\n        gameOverUI.setPosition(0, 0);\n    }\n\n    loadList() {\n        console.log(\"싱글 게임 리스트로 돌아가기\");\n        cc.director.loadScene(\"SingleGameList\");\n    }\n}\n"]}